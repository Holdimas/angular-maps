!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("bingmaps"),require("async"),require("rxjs")):"function"==typeof define&&define.amd?define("angular-maps-v9",["exports","@angular/core","@angular/common","bingmaps","async","rxjs"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["angular-maps-v9"]={},t.ng.core,t.ng.common,null,t.async,t.rxjs)}(this,(function(t,e,n,i,o,r){"use strict";var a,s=function(){};(a=t.MarkerTypeId||(t.MarkerTypeId={}))[a.None=0]="None",a[a.FontMarker=1]="FontMarker",a[a.CanvasMarker=2]="CanvasMarker",a[a.DynamicCircleMarker=3]="DynamicCircleMarker",a[a.RotatedImageMarker=4]="RotatedImageMarker",a[a.RoundedImageMarker=5]="RoundedImageMarker",a[a.ScaledImageMarker=6]="ScaledImageMarker",a[a.Custom=7]="Custom";var l=function(){function e(){}return e.CreateMarker=function(n){switch(n.markerType){case t.MarkerTypeId.CanvasMarker:return e.CreateCanvasMarker(n);case t.MarkerTypeId.DynamicCircleMarker:return e.CreateDynamicCircleMarker(n);case t.MarkerTypeId.FontMarker:return e.CreateFontBasedMarker(n);case t.MarkerTypeId.RotatedImageMarker:return e.CreateRotatedImageMarker(n);case t.MarkerTypeId.RoundedImageMarker:return e.CreateRoundedImageMarker(n);case t.MarkerTypeId.ScaledImageMarker:return e.CreateScaledImageMarker(n);case t.MarkerTypeId.Custom:throw Error("Custom Marker Creators are not currently supported.")}throw Error("Unsupported marker type: "+n.markerType)},e.GetImageForMarker=function(t){if(null==t||""===t)return null;var n=null;return null!=(n=e.ImageElementCache.get(t))||"undefined"!=typeof document&&null!=document&&((n=document.createElement("img")).src=t,e.ImageElementCache.set(t,n)),n},e.CreateCanvasMarker=function(t){if(null==document)throw Error("Document context (window.document) is required for canvas markers.");if(null==t||null==t.size||null==t.points)throw Error("IMarkerIconInfo.size, and IMarkerIConInfo.points are required for canvas markers.");if(null!=t.id&&e.MarkerCache.has(t.id)){var n=e.MarkerCache.get(t.id);return t.size=n.markerSize,n.markerIconString}var i=document.createElement("canvas"),o=i.getContext("2d");i.width=t.size.width,i.height=t.size.height,t.rotation&&(o.translate(.5*i.width,.5*i.height),o.rotate(t.rotation*Math.PI/180),o.translate(.5*-i.width,.5*-i.height)),o.fillStyle=t.color||"red",o.beginPath(),t.drawingOffset&&o.moveTo(t.drawingOffset.x,t.drawingOffset.y),t.points.forEach((function(t){o.lineTo(t.x,t.y)})),o.closePath(),o.fill(),o.stroke();var r=i.toDataURL();return null!=t.id&&e.MarkerCache.set(t.id,{markerIconString:r,markerSize:t.size}),r},e.CreateDynamicCircleMarker=function(t){if(null==document)throw Error("Document context (window.document) is required for dynamic circle markers.");if(null==t||null==t.size)throw Error("IMarkerIconInfo.size is required for dynamic circle markers.");if(null!=t.id&&e.MarkerCache.has(t.id)){var n=e.MarkerCache.get(t.id);return t.size=n.markerSize,n.markerIconString}var i=t.strokeWidth||0,o=['<svg xmlns="http://www.w3.org/2000/svg" width="',t.size.width.toString(),'" height="',t.size.width.toString(),'"><circle cx="',(t.size.width/2).toString(),'" cy="',(t.size.width/2).toString(),'" r="',(t.size.width/2-i).toString(),'" stroke="',t.color||"red",'" stroke-width="',i.toString(),'" fill="',t.color||"red",'"/></svg>'].join("");return null!=t.id&&e.MarkerCache.set(t.id,{markerIconString:o,markerSize:t.size}),o},e.CreateFontBasedMarker=function(t){if(null==document)throw Error("Document context (window.document) is required for font based markers");if(null==t||null==t.fontName||null==t.fontSize)throw Error("IMarkerIconInfo.fontName, IMarkerIconInfo.fontSize and IMarkerIConInfo.text are required for font based markers.");if(null!=t.id&&e.MarkerCache.has(t.id)){var n=e.MarkerCache.get(t.id);return t.size=n.markerSize,n.markerIconString}var i=document.createElement("canvas"),o=i.getContext("2d"),r=t.fontSize+"px "+t.fontName;o.font=r;var a=o.measureText(t.text);i.width=a.width,i.height=t.fontSize,t.rotation&&(o.translate(.5*i.width,.5*i.height),o.rotate(t.rotation*Math.PI/180),o.translate(.5*-i.width,.5*-i.height)),o.font=r,o.textBaseline="top",o.fillStyle=t.color||"red",o.fillText(t.text,0,0),t.size={width:i.width,height:i.height};var s=i.toDataURL();return null!=t.id&&e.MarkerCache.set(t.id,{markerIconString:s,markerSize:t.size}),s},e.CreateRotatedImageMarker=function(t){if(null==document)throw Error("Document context (window.document) is required for rotated image markers");if(null==t||null==t.rotation||null==t.url)throw Error("IMarkerIconInfo.rotation, IMarkerIconInfo.url are required for rotated image markers.");if(null!=t.id&&e.MarkerCache.has(t.id)){var n=e.MarkerCache.get(t.id);return t.size=n.markerSize,n.markerIconString}var i=new Image;return new Promise((function(n,o){i.crossOrigin="anonymous",i.src=t.url,t.size&&(i.width=t.size.width,i.height=t.size.height),i.onload=function(){var o=document.createElement("canvas"),r=o.getContext("2d"),a=t.rotation*Math.PI/180;o.width=Math.ceil(Math.abs(i.width*Math.cos(a))+Math.abs(i.height*Math.sin(a))),o.height=Math.ceil(Math.abs(i.width*Math.sin(a))+Math.abs(i.height*Math.cos(a))),r.translate(o.width/2,o.height/2),r.rotate(a),r.drawImage(i,-i.width/2,-i.height/2,i.width,i.height),t.size={width:o.width,height:o.height};var s=o.toDataURL();null!=t.id&&e.MarkerCache.set(t.id,{markerIconString:s,markerSize:t.size}),n({icon:s,iconInfo:t})}}))},e.CreateRoundedImageMarker=function(t){if(null==document)throw Error("Document context (window.document) is required for rounded image markers");if(null==t||null==t.size||null==t.url)throw Error("IMarkerIconInfo.size, IMarkerIconInfo.url are required for rounded image markers.");if(null!=t.id&&e.MarkerCache.has(t.id)){var n=e.MarkerCache.get(t.id);return t.size=n.markerSize,n.markerIconString}return new Promise((function(n,i){var o=t.size.width/2,r=new Image,a=t.drawingOffset||{x:0,y:0};r.crossOrigin="anonymous",r.src=t.url,r.onload=function(){var i=document.createElement("canvas"),s=i.getContext("2d");i.width=t.size.width,i.height=t.size.width,s.beginPath(),s.arc(o,o,o,0,2*Math.PI,!1),s.fill(),s.clip(),s.drawImage(r,a.x,a.y,t.size.width,t.size.width),t.size={width:i.width,height:i.height};var l=i.toDataURL();null!=t.id&&e.MarkerCache.set(t.id,{markerIconString:l,markerSize:t.size}),n({icon:l,iconInfo:t})}}))},e.CreateScaledImageMarker=function(t){if(null==document)throw Error("Document context (window.document) is required for scaled image markers");if(null==t||null==t.scale||null==t.url)throw Error("IMarkerIconInfo.scale, IMarkerIconInfo.url are required for scaled image markers.");if(null!=t.id&&e.MarkerCache.has(t.id)){var n=e.MarkerCache.get(t.id);return t.size=n.markerSize,n.markerIconString}return new Promise((function(n,i){var o=new Image;o.crossOrigin="anonymous",o.src=t.url,o.onload=function(){var i=document.createElement("canvas"),r=i.getContext("2d");i.width=o.width*t.scale,i.height=o.height*t.scale,r.drawImage(o,0,0,i.width,i.height),t.size={width:i.width,height:i.height};var a=i.toDataURL();null!=t.id&&e.MarkerCache.set(t.id,{markerIconString:a,markerSize:t.size}),n({icon:a,iconInfo:t})}}))},e}();l.ImageElementCache=new Map,l.MarkerCache=new Map,function(t){t[t.aerial=0]="aerial",t[t.canvasDark=1]="canvasDark",t[t.canvasLight=2]="canvasLight",t[t.grayscale=3]="grayscale",t[t.hybrid=4]="hybrid",t[t.mercator=5]="mercator",t[t.ordnanceSurvey=6]="ordnanceSurvey",t[t.road=7]="road",t[t.streetside=8]="streetside"}(t.MapTypeId||(t.MapTypeId={}));var u=function(){},c=function(){function t(){}return Object.defineProperty(t.prototype,"Center",{get:function(){return null==this._center&&(this._center=this.GetBoundingCenter()),this._center},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Centroid",{get:function(){return null==this._centroid&&(this._centroid=this.GetPolygonCentroid()),this._centroid},enumerable:!1,configurable:!0}),t.prototype.GetBoundingCenter=function(){var t={latitude:0,longitude:0},e=90,n=-90,i=180,o=-180,r=this.GetPaths();return r?(r.forEach((function(t){return t.forEach((function(t){t.latitude<e&&(e=t.latitude),t.latitude>n&&(n=t.latitude),t.longitude<i&&(i=t.longitude),t.longitude>o&&(o=t.longitude)}))})),t.latitude=e+(n-e)/2,t.longitude=i+(o-i)/2):t=null,t},t.prototype.GetPolygonCentroid=function(){var t={latitude:0,longitude:0},e=this.GetPaths(),n=e[0][0];if(null!=n){for(var i=0,o=0,r=0,a=void 0,s=void 0,l=void 0,u=0;u<e.length;u++)for(var c=0,p=e[u].length-1;c<e[u].length;p=c++)a=e[u][c],s=e[u][p],i+=l=(a.latitude-n.latitude)*(s.longitude-n.longitude)-(s.latitude-n.latitude)*(a.longitude-n.longitude),o+=(a.latitude+s.latitude-2*n.latitude)*l,r+=(a.longitude+s.longitude-2*n.longitude)*l;0!==i?(l=3*i,t.latitude=o/l+n.latitude,t.longitude=r/l+n.longitude):(t.latitude=n.latitude,t.longitude=n.longitude)}else t=null;return t},t}(),p=function(){function t(){}return Object.defineProperty(t.prototype,"Center",{get:function(){return null==this._center&&(this._center=this.GetBoundingCenter()),this._center},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Centroid",{get:function(){return null==this._centroid&&(this._centroid=this.GetPolylineCentroid()),this._centroid},enumerable:!1,configurable:!0}),t.GetPolylineCentroid=function(t){var e={latitude:0,longitude:0},n=t[0];if(null!=n){for(var i=0,o=0,r=0,a=void 0,s=void 0,l=void 0,u=0,c=t.length-1;u<t.length;c=u++)a=t[u],s=t[c],i+=l=(a.latitude-n.latitude)*(s.longitude-n.longitude)-(s.latitude-n.latitude)*(a.longitude-n.longitude),o+=(a.latitude+s.latitude-2*n.latitude)*l,r+=(a.longitude+s.longitude-2*n.longitude)*l;0!==i?(l=3*i,e.latitude=o/l+n.latitude,e.longitude=r/l+n.longitude):(e.latitude=n.latitude,e.longitude=n.longitude)}else e=null;return e},t.prototype.GetBoundingCenter=function(){var t={latitude:0,longitude:0},e=90,n=-90,i=180,o=-180,r=this.GetPath();return r?(r.forEach((function(t){t.latitude<e&&(e=t.latitude),t.latitude>n&&(n=t.latitude),t.longitude<i&&(i=t.longitude),t.longitude>o&&(o=t.longitude)})),t.latitude=e+(n-e)/2,t.longitude=i+(o-i)/2):t=null,t},t.prototype.GetPolylineCentroid=function(){var e=this.GetPath();return t.GetPolylineCentroid(e)},t}(),h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}Object.create;function d(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function m(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(y(arguments[e]));return t}Object.create;var g,v,_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e}(l);(g=t.ClusterPlacementMode||(t.ClusterPlacementMode={}))[g.None=0]="None",g[g.MeanValue=1]="MeanValue",g[g.FirstPin=2]="FirstPin",(v=t.ClusterClickAction||(t.ClusterClickAction={}))[v.None=0]="None",v[v.ZoomIntoCluster=1]="ZoomIntoCluster",v[v.Spider=2]="Spider";var b=0,M=function(){function t(t){var e=this;this._canvasReady=new Promise((function(t,n){e._readyResolver=t})),this._drawCallback=t,b++}return Object.defineProperty(t.prototype,"CanvasReady",{get:function(){return this._canvasReady},enumerable:!1,configurable:!0}),t.prototype.Delete=function(){this.SetMap(null)},t.prototype.OnAdd=function(){this._canvas=document.createElement("canvas"),this._canvas.style.position="absolute",this._canvas.style.left="0px",this._canvas.style.top="0px",this._canvas.id="xMapOverlay"+b,this.SetCanvasElement(this._canvas)},t.prototype.OnRemove=function(){this.SetCanvasElement(null),this.RemoveEventHandlers(),this._canvas=null},t.prototype.Redraw=function(t){null!=this._canvas&&(t&&this.Resize(),this._drawCallback&&this._drawCallback(this._canvas))},t.prototype.UpdatePosition=function(t,e,n,i){this._canvas.style.left=t+"px",this._canvas.style.top=e+"px",this._canvas.style.width=n+"px",this._canvas.style.height=i+"px"},t}(),C=function(){function t(t,e){this._layer=t,this._maps=e,this._pendingEntities=new Array}return Object.defineProperty(t.prototype,"NativePrimitve",{get:function(){return this._layer},enumerable:!1,configurable:!0}),t.prototype.AddListener=function(t,e){Microsoft.Maps.Events.addHandler(this._layer,t,(function(t){e(t)}))},t.prototype.AddEntity=function(t){t&&t.NativePrimitve&&(this.GetVisible()?this._layer.add(t.NativePrimitve):this._pendingEntities.push(t))},t.prototype.AddEntities=function(t){var e=this;null!=t&&Array.isArray(t)&&0!==t.length&&o.eachSeries(m(t),(function(t,n){e.GetVisible()?e._layer.add(t.NativePrimitve):e._pendingEntities.push(t),o.nextTick((function(){return n()}))}))},t.prototype.Delete=function(){this._maps.DeleteLayer(this)},t.prototype.GetOptions=function(){return{id:Number(this._layer.getId())}},t.prototype.GetVisible=function(){return this._layer.getVisible()},t.prototype.RemoveEntity=function(t){t.NativePrimitve&&this._layer.remove(t.NativePrimitve)},t.prototype.SetEntities=function(t){this._layer.setPrimitives([]),this.AddEntities(t)},t.prototype.SetOptions=function(t){this._layer.metadata.id=t.id.toString()},t.prototype.SetVisible=function(t){this._layer.setVisible(t),t&&this._pendingEntities.length>0&&this.AddEntities(this._pendingEntities.splice(0))},t}(),k=function(){function e(){}return e.TranslateAction=function(t){return{eventHandler:t.eventHandler,label:t.label}},e.TranslateActions=function(t){var n=new Array;return t.forEach((function(t){return n.push(e.TranslateAction(t))})),n},e.TranslateBounds=function(t){return Microsoft.Maps.LocationRect.fromEdges(t.maxLatitude,t.minLongitude,t.minLatitude,t.maxLongitude)},e.TranslateClusterOptions=function(n){var i={};return Object.keys(n).filter((function(t){return-1!==e._clusterOptionsAttributes.indexOf(t)})).forEach((function(o){"layerOffset"===o&&(i.layerOffset=e.TranslatePoint(n.layerOffset)),"placementMode"===o?n.placementMode===t.ClusterPlacementMode.FirstPin?i.placementMode=Microsoft.Maps.ClusterPlacementType.FirstLocation:i.placementMode=Microsoft.Maps.ClusterPlacementType.MeanAverage:i[o]=n[o]})),i},e.TranslateInfoBoxOptions=function(t){var n={};return Object.keys(t).filter((function(t){return-1!==e._infoWindowOptionsAttributes.indexOf(t)})).forEach((function(i){"pixelOffset"===i?n.offset=e.TranslatePoint(t.pixelOffset):"position"===i?n.location=e.TranslateLocation(t.position):"actions"===i?n.actions=e.TranslateActions(t.actions):n[i]=t[i]})),n},e.TranslateLoadOptions=function(n){var i={};return Object.keys(n).filter((function(t){return-1!==e._mapOptionsAttributes.indexOf(t)||-1!==e._viewOptionsAttributes.indexOf(t)})).forEach((function(o){"center"===o?i.center=e.TranslateLocation(n.center):"mapTypeId"===o?n.mapTypeId===t.MapTypeId.hybrid?(i.mapTypeId=Microsoft.Maps.MapTypeId.aerial,i.labelOverlay=Microsoft.Maps.LabelOverlay.visible):n.mapTypeId===t.MapTypeId.aerial?(i.mapTypeId=Microsoft.Maps.MapTypeId.aerial,i.labelOverlay=Microsoft.Maps.LabelOverlay.hidden):i.mapTypeId=Microsoft.Maps.MapTypeId[t.MapTypeId[n.mapTypeId]]:"bounds"===o?i.bounds=e.TranslateBounds(n.bounds):i[o]=n[o]})),i},e.TranslateLocation=function(t){return new Microsoft.Maps.Location(t.latitude,t.longitude)},e.TranslateMarkerOptions=function(t){var n={};return Object.keys(t).filter((function(t){return-1!==e._markerOptionsAttributes.indexOf(t)})).forEach((function(i){"anchor"===i?n.anchor=e.TranslatePoint(t.anchor):n[i]=t[i]})),n},e.TranslateOptions=function(n){var i={};return Object.keys(n).filter((function(t){return-1!==e._mapOptionsAttributes.indexOf(t)})).forEach((function(o){"center"===o?i.center=e.TranslateLocation(n.center):"mapTypeId"===o?i.mapTypeId=Microsoft.Maps.MapTypeId[t.MapTypeId[n.mapTypeId]]:i[o]=n[o]})),i},e.TranslatePaths=function(t){var e=new Array;if(null!=t&&Array.isArray(t)&&0!==t.length)if(Array.isArray(t[0]))for(var n=t,i=0;i<n.length;i++){for(var o=new Array,r=0;r<n[i].length;r++)o.push(new Microsoft.Maps.Location(n[i][r].latitude,n[i][r].longitude));e.push(o)}else{var a=new Array;for(n=t,i=0;i<n.length;i++)a.push(new Microsoft.Maps.Location(n[i].latitude,n[i].longitude));e.push(a)}else e.push(new Array);return e},e.TranslatePoint=function(t){return new Microsoft.Maps.Point(t.x,t.y)},e.TranslatePolygonOptions=function(t){var n={},i=function(t,e){var n=/rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*\d+[\.\d+]*)*\)/g.exec(t);if(n&&n.length>3)return e=e>1?e/100:e,"rgba("+[n[1],n[2],n[3],e].join(",")+")";if("#"===t[0]){e>1||Math.floor(255*e);var i=t.substr(1);return"rgba("+[parseInt(i.substr(0,2),16),parseInt(i.substr(2,2),16),parseInt(i.substr(4,2),16),e].join(",")+")"}return t};return Object.keys(t).filter((function(t){return-1!==e._polygonOptionsAttributes.indexOf(t)})).forEach((function(e){"strokeWeight"===e?n.strokeThickness=t.strokeWeight:"strokeColor"===e?t.strokeOpacity?n.strokeColor=i(t.strokeColor,t.strokeOpacity):n.strokeColor=t.strokeColor:"strokeOpacity"===e||("fillColor"===e?t.fillOpacity?n.fillColor=i(t.fillColor,t.fillOpacity):n.fillColor=t.fillColor:"fillOpacity"===e||(n[e]=t[e]))})),n},e.TranslatePolylineOptions=function(t){var n={};return Object.keys(t).filter((function(t){return-1!==e._polylineOptionsAttributes.indexOf(t)})).forEach((function(e){"strokeWeight"===e?n.strokeThickness=t.strokeWeight:"strokeColor"===e?t.strokeOpacity?n.strokeColor=function(t,e){var n=/rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*\d+[\.\d+]*)*\)/g.exec(t);if(n&&n.length>3)return e=e>1?e/100:e,"rgba("+[n[1],n[2],n[3],e].join(",")+")";if("#"===t[0]){e>1||Math.floor(255*e);var i=t.substr(1);return"rgba("+[parseInt(i.substr(0,2),16),parseInt(i.substr(2,2),16),parseInt(i.substr(4,2),16),e].join(",")+")"}return t}(t.strokeColor,t.strokeOpacity):n.strokeColor=t.strokeColor:"strokeOpacity"===e||(n[e]=t[e])})),n},e.TranslateViewOptions=function(n){var i={};return Object.keys(n).filter((function(t){return-1!==e._viewOptionsAttributes.indexOf(t)})).forEach((function(o){"center"===o?i.center=e.TranslateLocation(n.center):"bounds"===o?i.bounds=e.TranslateBounds(n.bounds):"centerOffset"===o?i.centerOffset=e.TranslatePoint(n.centerOffset):"mapTypeId"===o?i.mapTypeId=Microsoft.Maps.MapTypeId[t.MapTypeId[n.mapTypeId]]:i[o]=n[o]})),i},e}();k._mapOptionsAttributes=["backgroundColor","credentials","customizeOverlays","customMapStyle","disableBirdseye","disableKeyboardInput","disableMouseInput","disablePanning","disableTouchInput","disableUserInput","disableZooming","disableStreetside","enableClickableLogo","enableSearchLogo","fixedMapPosition","height","inertiaIntensity","navigationBarMode","showBreadcrumb","showCopyright","showDashboard","showMapTypeSelector","showScalebar","theme","tileBuffer","useInertia","width","center","zoom","mapTypeId","liteMode"],k._viewOptionsAttributes=["animate","bounds","center","centerOffset","heading","labelOverlay","mapTypeId","padding","zoom"],k._infoWindowOptionsAttributes=["actions","description","htmlContent","id","position","pixelOffset","showCloseButton","showPointer","pushpin","title","titleClickHandler","typeName","visible","width","height"],k._markerOptionsAttributes=["anchor","draggable","height","htmlContent","icon","infobox","state","title","textOffset","typeName","visible","width","zIndex"],k._polygonOptionsAttributes=["cursor","fillColor","fillOpacity","strokeColor","strokeOpacity","strokeWeight","visible"],k._polylineOptionsAttributes=["cursor","strokeColor","strokeOpacity","strokeWeight","visible"],k._clusterOptionsAttributes=["callback","clusteredPinCallback","clusteringEnabled","gridSize","layerOffset","placementMode","visible","zIndex"];var S=function(){function t(t,e,n){this._pushpin=t,this._map=e,this._layer=n,this._metadata=new Map,this._isFirst=!1,this._isLast=!0}return Object.defineProperty(t.prototype,"IsFirst",{get:function(){return this._isFirst},set:function(t){this._isFirst=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"IsLast",{get:function(){return this._isLast},set:function(t){this._isLast=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Location",{get:function(){var t=this._pushpin.getLocation();return{latitude:t.latitude,longitude:t.longitude}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Metadata",{get:function(){return this._metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"NativePrimitve",{get:function(){return this._pushpin},enumerable:!1,configurable:!0}),t.prototype.AddListener=function(t,e){Microsoft.Maps.Events.addHandler(this._pushpin,t,(function(t){e(t)}))},t.prototype.DeleteMarker=function(){(this._map||this._layer)&&(this._layer?this._layer.remove(this.NativePrimitve):this._map.entities.remove(this.NativePrimitve))},t.prototype.GetLabel=function(){return this._pushpin.getText()},t.prototype.GetVisible=function(){return this._pushpin.getVisible()},t.prototype.SetAnchor=function(t){var e={};e.anchor=new Microsoft.Maps.Point(t.x,t.y),this._pushpin.setOptions(e)},t.prototype.SetDraggable=function(t){var e={};e.draggable=t,this._pushpin.setOptions(e)},t.prototype.SetIcon=function(t){var e={};e.icon=t,this._pushpin.setOptions(e)},t.prototype.SetLabel=function(t){var e={};e.text=t,this._pushpin.setOptions(e)},t.prototype.SetPosition=function(t){var e=k.TranslateLocation(t);this._pushpin.setLocation(e)},t.prototype.SetTitle=function(t){var e={};e.title=t,this._pushpin.setOptions(e)},t.prototype.SetOptions=function(t){var e=k.TranslateMarkerOptions(t);this._pushpin.setOptions(e)},t.prototype.SetVisible=function(t){var e={};e.visible=t,this._pushpin.setOptions(e)},t}(),O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e}(S),P=function(){function t(t,e){this._layer=t,this._maps=e,this._isClustering=!0,this._markers=new Array,this._markerLookup=new Map,this._pendingMarkers=new Array,this._spiderMarkers=new Array,this._spiderMarkerLookup=new Map,this._useSpiderCluster=!1,this._mapclicks=0,this._events=new Array,this._currentZoom=0,this._spiderOptions={circleSpiralSwitchover:9,collapseClusterOnMapChange:!1,collapseClusterOnNthClick:1,invokeClickOnHover:!0,minCircleLength:60,minSpiralAngleSeperation:25,spiralDistanceFactor:5,stickStyle:{strokeColor:"black",strokeThickness:2},stickHoverStyle:{strokeColor:"red"},markerSelected:null,markerUnSelected:null},this._currentCluster=null}return Object.defineProperty(t.prototype,"NativePrimitve",{get:function(){return this._layer},enumerable:!1,configurable:!0}),t.prototype.AddListener=function(t,e){Microsoft.Maps.Events.addHandler(this._layer,t,(function(t){e(t)}))},t.prototype.AddEntity=function(t){var e=t instanceof l;if((e=t instanceof S||e)&&t.IsFirst&&this.StopClustering(),t.NativePrimitve&&t.Location){if(this._isClustering){var n=this._layer.getPushpins();n.push(t.NativePrimitve),this._layer.setPushpins(n),this._markers.push(t)}else this._pendingMarkers.push(t);this._markerLookup.set(t.NativePrimitve,t)}e&&t.IsLast&&this.StartClustering()},t.prototype.AddEntities=function(t){var e,n,i=this;if(null!=t&&Array.isArray(t)&&0!==t.length){var o=t.map((function(t){return i._markerLookup.set(t.NativePrimitve,t),t.NativePrimitve}));if(this._isClustering){var r=this._layer.getPushpins();r.push.apply(r,m(o)),this._layer.setPushpins(r),(e=this._markers).push.apply(e,m(t))}else(n=this._pendingMarkers).push.apply(n,m(t))}},t.prototype.InitializeSpiderClusterSupport=function(t){var e=this;if(!this._useSpiderCluster){var n=this._maps.MapInstance;this._useSpiderCluster=!0,this._spiderLayer=new Microsoft.Maps.Layer,this._currentZoom=n.getZoom(),this.SetSpiderOptions(t),n.layers.insert(this._spiderLayer),this._events.push(Microsoft.Maps.Events.addHandler(n,"click",(function(t){return e.OnMapClick(t)}))),this._events.push(Microsoft.Maps.Events.addHandler(n,"viewchangestart",(function(t){return e.OnMapViewChangeStart(t)}))),this._events.push(Microsoft.Maps.Events.addHandler(n,"viewchangeend",(function(t){return e.OnMapViewChangeEnd(t)}))),this._events.push(Microsoft.Maps.Events.addHandler(this._layer,"click",(function(t){return e.OnLayerClick(t)}))),this._events.push(Microsoft.Maps.Events.addHandler(this._spiderLayer,"click",(function(t){return e.OnLayerClick(t)}))),this._events.push(Microsoft.Maps.Events.addHandler(this._spiderLayer,"mouseover",(function(t){return e.OnSpiderMouseOver(t)}))),this._events.push(Microsoft.Maps.Events.addHandler(this._spiderLayer,"mouseout",(function(t){return e.OnSpiderMouseOut(t)})))}},t.prototype.Delete=function(){var t=this;this._useSpiderCluster&&(this._spiderLayer.clear(),this._maps.MapPromise.then((function(e){e.layers.remove(t._spiderLayer),t._spiderLayer=null})),this._events.forEach((function(t){return Microsoft.Maps.Events.removeHandler(t)})),this._events.splice(0),this._useSpiderCluster=!1),this._markers.splice(0),this._spiderMarkers.splice(0),this._pendingMarkers.splice(0),this._markerLookup.clear(),this._maps.DeleteLayer(this)},t.prototype.GetMarkerFromBingMarker=function(t){return this._markerLookup.get(t)},t.prototype.GetOptions=function(){var t=this._layer.getOptions();return{id:0,gridSize:t.gridSize,layerOffset:t.layerOffset,clusteringEnabled:t.clusteringEnabled,callback:t.callback,clusteredPinCallback:t.clusteredPinCallback,visible:t.visible,zIndex:t.zIndex}},t.prototype.GetVisible=function(){return this._layer.getOptions().visible},t.prototype.GetSpiderMarkerFromBingMarker=function(t){return this._spiderMarkerLookup.get(t)},t.prototype.RemoveEntity=function(t){if(t.NativePrimitve&&t.Location){var e=this._markers.indexOf(t),n=this._pendingMarkers.indexOf(t);if(e>-1&&this._markers.splice(e,1),n>-1&&this._pendingMarkers.splice(n,1),this._isClustering){var i=this._layer.getPushpins(),o=i.indexOf(t.NativePrimitve);o>-1&&(i.splice(o,1),this._layer.setPushpins(i))}this._markerLookup.delete(t.NativePrimitve)}},t.prototype.SetEntities=function(t){var e=this,n=new Array;this._markers.splice(0),this._markerLookup.clear(),t.forEach((function(t){t.NativePrimitve&&t.Location&&(e._markers.push(t),e._markerLookup.set(t.NativePrimitve,t),n.push(t.NativePrimitve))})),this._layer.setPushpins(n)},t.prototype.SetOptions=function(t){var e=k.TranslateClusterOptions(t);this._layer.setOptions(e),t.spiderClusterOptions&&this.SetSpiderOptions(t.spiderClusterOptions)},t.prototype.SetVisible=function(t){var e=this._layer.getOptions();e.visible=t,this._layer.setOptions(e)},t.prototype.StartClustering=function(){if(!this._isClustering){var t=new Array;this._markers.forEach((function(e){e.NativePrimitve&&e.Location&&t.push(e.NativePrimitve)})),this._pendingMarkers.forEach((function(e){e.NativePrimitve&&e.Location&&t.push(e.NativePrimitve)})),this._layer.setPushpins(t),this._markers=this._markers.concat(this._pendingMarkers.splice(0)),this._isClustering=!0}},t.prototype.StopClustering=function(){this._isClustering&&(this._isClustering=!1)},t.prototype.GetBasicPushpinOptions=function(t){return{anchor:t.getAnchor(),color:t.getColor(),cursor:t.getCursor(),icon:t.getIcon(),roundClickableArea:t.getRoundClickableArea(),subTitle:t.getSubTitle(),text:t.getText(),textOffset:t.getTextOffset(),title:t.getTitle()}},t.prototype.HideSpiderCluster=function(){this._mapclicks=0,this._currentCluster&&(this._spiderLayer.clear(),this._spiderMarkers.splice(0),this._spiderMarkerLookup.clear(),this._currentCluster=null,this._mapclicks=-1,this._spiderOptions.markerUnSelected&&this._spiderOptions.markerUnSelected())},t.prototype.OnLayerClick=function(t){if(t.primitive instanceof Microsoft.Maps.ClusterPushpin){var e=t.primitive!==this._currentCluster;this.HideSpiderCluster(),e&&this.ShowSpiderCluster(t.primitive)}else{var n=t.primitive;if(n.metadata&&n.metadata.isClusterMarker){var i=this.GetSpiderMarkerFromBingMarker(n).ParentMarker,o=i.NativePrimitve;this._spiderOptions.markerSelected&&this._spiderOptions.markerSelected(i,new S(this._currentCluster,null,null)),Microsoft.Maps.Events.hasHandler(o,"click")&&Microsoft.Maps.Events.invoke(o,"click",t),this._mapclicks=0}else this._spiderOptions.markerSelected&&this._spiderOptions.markerSelected(this.GetMarkerFromBingMarker(n),null),Microsoft.Maps.Events.hasHandler(n,"click")&&Microsoft.Maps.Events.invoke(n,"click",t)}},t.prototype.OnMapClick=function(t){-1!==this._mapclicks&&++this._mapclicks>=this._spiderOptions.collapseClusterOnNthClick&&this.HideSpiderCluster()},t.prototype.OnMapViewChangeEnd=function(t){var e=t.target.getZoom(),n=e!==this._currentZoom;this._currentZoom=e,n&&this.HideSpiderCluster()},t.prototype.OnMapViewChangeStart=function(t){this._spiderOptions.collapseClusterOnMapChange&&this.HideSpiderCluster()},t.prototype.OnSpiderMouseOut=function(t){var e=t.primitive;e instanceof Microsoft.Maps.Pushpin&&e.metadata&&e.metadata.isClusterMarker&&this.GetSpiderMarkerFromBingMarker(e).Stick.setOptions(this._spiderOptions.stickStyle)},t.prototype.OnSpiderMouseOver=function(t){var e=t.primitive;if(e instanceof Microsoft.Maps.Pushpin&&e.metadata&&e.metadata.isClusterMarker){var n=this.GetSpiderMarkerFromBingMarker(e);if(n.Stick.setOptions(this._spiderOptions.stickHoverStyle),this._spiderOptions.invokeClickOnHover){var i=n.ParentMarker.NativePrimitve;Microsoft.Maps.Events.hasHandler(i,"click")&&Microsoft.Maps.Events.invoke(i,"click",t)}}},t.prototype.SetSpiderOptions=function(t){t&&("number"==typeof t.circleSpiralSwitchover&&(this._spiderOptions.circleSpiralSwitchover=t.circleSpiralSwitchover),"boolean"==typeof t.collapseClusterOnMapChange&&(this._spiderOptions.collapseClusterOnMapChange=t.collapseClusterOnMapChange),"number"==typeof t.collapseClusterOnNthClick&&(this._spiderOptions.collapseClusterOnNthClick=t.collapseClusterOnNthClick),"boolean"==typeof t.invokeClickOnHover&&(this._spiderOptions.invokeClickOnHover=t.invokeClickOnHover),"number"==typeof t.minSpiralAngleSeperation&&(this._spiderOptions.minSpiralAngleSeperation=t.minSpiralAngleSeperation),"number"==typeof t.spiralDistanceFactor&&(this._spiderOptions.spiralDistanceFactor=t.spiralDistanceFactor),"number"==typeof t.minCircleLength&&(this._spiderOptions.minCircleLength=t.minCircleLength),t.stickHoverStyle&&(this._spiderOptions.stickHoverStyle=t.stickHoverStyle),t.stickStyle&&(this._spiderOptions.stickStyle=t.stickStyle),t.markerSelected&&(this._spiderOptions.markerSelected=t.markerSelected),t.markerUnSelected&&(this._spiderOptions.markerUnSelected=t.markerUnSelected),"boolean"==typeof t.visible&&(this._spiderOptions.visible=t.visible),this.SetOptions(t))},t.prototype.ShowSpiderCluster=function(t){if(this.HideSpiderCluster(),this._currentCluster=t,t&&t.containedPushpins){var e=this._maps.MapInstance,n=t.containedPushpins,i=t.getLocation(),o=e.tryLocationToPixel(i,Microsoft.Maps.PixelReference.control),r=void 0,a=0,s=n.length>this._spiderOptions.circleSpiralSwitchover,l=void 0,u=void 0,c=void 0;s?(l=this._spiderOptions.minCircleLength/Math.PI,c=2*Math.PI*this._spiderOptions.spiralDistanceFactor):(u=2*Math.PI/n.length,(l=this._spiderOptions.spiralDistanceFactor/u/Math.PI/2*n.length)<this._spiderOptions.minCircleLength&&(l=this._spiderOptions.minCircleLength));for(var p=0,h=n.length;p<h;p++){s?l+=c/(a+=this._spiderOptions.minSpiralAngleSeperation/l+5e-4*p):a=u*p;var f=new Microsoft.Maps.Point(o.x+l*Math.cos(a),o.y+l*Math.sin(a)),d=e.tryPixelToLocation(f,Microsoft.Maps.PixelReference.control);r=new Microsoft.Maps.Polyline([i,d],this._spiderOptions.stickStyle),this._spiderLayer.add(r);var y=new Microsoft.Maps.Pushpin(d);y.metadata=n[p].metadata||{},y.metadata.isClusterMarker=!0,y.setOptions(this.GetBasicPushpinOptions(n[p])),this._spiderLayer.add(y);var m=new O(y,null,this._spiderLayer);m.Stick=r,m.ParentMarker=this.GetMarkerFromBingMarker(n[p]),this._spiderMarkers.push(m),this._spiderMarkerLookup.set(y,m)}this._mapclicks=0}},t}(),w=function(){function t(t){this._infoBox=t,this._isOpen=!1}return Object.defineProperty(t.prototype,"IsOpen",{get:function(){return!(!this._infoBox||!0!==this._infoBox.getOptions().visible)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"NativePrimitve",{get:function(){return this._infoBox},enumerable:!1,configurable:!0}),t.prototype.AddListener=function(t,e){var n=this;Microsoft.Maps.Events.addHandler(this._infoBox,t,(function(t){"infoboxChanged"===t.eventName?!0===n._infoBox.getOptions().visible?n._isOpen=!0:!1===n._infoBox.getOptions().visible&&!0===n._isOpen&&(n._isOpen=!1,e(t)):e(t)}))},t.prototype.Close=function(){var t={visible:!1};this._infoBox.setOptions(t)},t.prototype.GetPosition=function(){return{latitude:this._infoBox.getLocation().latitude,longitude:this._infoBox.getLocation().longitude}},t.prototype.Open=function(){var t={visible:!0};this._infoBox.setOptions(t)},t.prototype.SetOptions=function(t){var e=k.TranslateInfoBoxOptions(t);this._infoBox.setOptions(e)},t.prototype.SetPosition=function(t){var e=k.TranslateLocation(t);this._infoBox.setLocation(e)},t}(),L=function(){function t(t){this.Set("fontFamily","sans-serif"),this.Set("fontSize",12),this.Set("fontColor","#ffffff"),this.Set("strokeWeight",4),this.Set("strokeColor","#000000"),this.Set("align","center"),this.SetValues(t)}return t.prototype.Delete=function(){this.SetMap(null)},t.prototype.Changed=function(t){var e=!1,n=!1;Array.isArray(t)||(t=[t]),t.forEach((function(t){switch(t){case"fontFamily":case"fontSize":case"fontColor":case"strokeWeight":case"strokeColor":case"align":case"text":e=!0;break;case"maxZoom":case"minZoom":case"offset":case"hidden":case"position":n=!0}})),e&&this.DrawCanvas(),n&&this.Draw()},t.prototype.GetVisible=function(){var t=this.Get("minZoom"),e=this.Get("maxZoom");if(this.Get("hidden"))return"hidden";if(void 0===t&&void 0===e)return"";if(!this.GetMap())return"";var n=this.GetMap().getZoom();return n<t||n>e?"hidden":""},t.prototype.DrawCanvas=function(){if(this._canvas){var t=this._canvas.style;t.zIndex=this.Get("zIndex");var e=this._canvas.getContext("2d");e.clearRect(0,0,this._canvas.width,this._canvas.height),e.strokeStyle=this.Get("strokeColor"),e.font=this.Get("fontSize")+"px "+this.Get("fontFamily");var n=this.Get("backgroundColor"),i=Number(this.Get("strokeWeight")),o=this.Get("text"),r=e.measureText(o).width;o&&i&&i>0&&(e.lineWidth=i,e.strokeText(o,4,4)),n&&""!==n&&(e.fillStyle=n,e.fillRect(0,0,r+8,2*parseInt(e.font,10)-2)),e.fillStyle=this.Get("fontColor"),e.fillText(o,4,4),t.marginLeft=this.GetMarginLeft(r)+"px",t.marginTop="-0.4em",t.pointerEvents="none"}},t.prototype.GetMarginLeft=function(t){switch(this.Get("align")){case"left":return 0;case"right":return-t}return t/-2},t.prototype.OnRemove=function(){this._canvas&&this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas)},t}(),I=function(){function t(t){this._obj=t,this._proto=t.prototype}return t.prototype.Extend=function(t){for(var e in this.Set("prototype",t,this._obj),this._proto)null!=this._proto[e]&&this.Set(e,this._proto[e],this._obj.prototype[e]);return this},t.prototype.Set=function(t,e,n){if(void 0===e)return this;void 0===n&&(n=this._proto),Object.defineProperty(n,t,e)},t.prototype.Map=function(t,e){return this.Set(t,this._proto[e],this._obj.prototype),this},t}(),E=0,T=function(t){function e(e){var n=this;return e.fontSize=e.fontSize||12,e.fontColor=e.fontColor||"#ffffff",e.strokeWeight=e.strokeWeight||2,e.strokeColor=e.strokeColor||"#000000",(n=t.call(this,e)||this)._options.beneathLabels=!1,n}return f(e,t),Object.defineProperty(e.prototype,"DefaultLabelStyle",{get:function(){return{fontSize:12,fontFamily:"sans-serif",fontColor:"#ffffff",strokeWeight:2,strokeColor:"#000000"}},enumerable:!1,configurable:!0}),e.prototype.Get=function(t){return this[t]},e.prototype.GetMap=function(){return this.getMap()},e.prototype.Set=function(t,e){"position"===t&&!e.hasOwnProperty("altitude")&&e.hasOwnProperty("latitude")&&e.hasOwnProperty("longitude")&&(e=new Microsoft.Maps.Location(e.latitude,e.longitude)),this.Get(t)!==e&&(this[t]=e,this.Changed(t))},e.prototype.SetMap=function(t){var e=this.GetMap();t!==e&&(e&&e.layers.remove(this),null!=t&&t.layers.insert(this))},e.prototype.SetValues=function(t){var e=new Array;for(var n in t)""!==n&&("position"===n&&!t[n].hasOwnProperty("altitude")&&t[n].hasOwnProperty("latitude")&&t[n].hasOwnProperty("longitude")&&(t[n]=new Microsoft.Maps.Location(t[n].latitude,t[n].longitude)),this.Get(n)!==t[n]&&(this[n]=t[n],e.push(n)));e.length>0&&this.Changed(e)},e.prototype.Draw=function(){var t=this.GetVisible(),e=this.GetMap();if(this._canvas&&e){var n=this._canvas.style;if(""===t){var i=this.Get("offset"),o=this.Get("position");if(o){i||(i=new Microsoft.Maps.Point(0,0));var r=e.tryLocationToPixel(o,Microsoft.Maps.PixelReference.control);n.top=r.y+i.y+"px",n.left=r.x+i.x+"px",n.visibility=t}}else n.visibility=t}},e.prototype.OnAdd=function(){this._canvas=document.createElement("canvas"),this._canvas.id="xMapLabel"+E++,this._canvas.style.position="absolute";var t=this._canvas.getContext("2d");t.lineJoin="round",t.textBaseline="top",this.setHtmlElement(this._canvas)},e.prototype.OnLoad=function(){var t=this;Microsoft.Maps.Events.addHandler(this.GetMap(),"viewchange",(function(){t.Changed("position")})),this.DrawCanvas(),this.Draw()},e}(L);var x,A,z,D,G,N=function(t){function e(e,n,i){var o=t.call(this)||this;return o._polygon=e,o._mapService=n,o._layer=i,o._map=null,o._isEditable=!1,o._title="",o._maxZoom=-1,o._minZoom=-1,o._showLabel=!1,o._showTooltip=!1,o._label=null,o._tooltip=null,o._hasToolTipReceiver=!1,o._tooltipVisible=!1,o._metadata=new Map,o._map=o._mapService.MapInstance,o._originalPath=o.GetPaths(),o}return f(e,t),Object.defineProperty(e.prototype,"LabelMaxZoom",{get:function(){return this._maxZoom},set:function(t){this._maxZoom=t,this.ManageLabel()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"LabelMinZoom",{get:function(){return this._minZoom},set:function(t){this._minZoom=t,this.ManageLabel()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Metadata",{get:function(){return this._metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"NativePrimitve",{get:function(){return this._polygon},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ShowLabel",{get:function(){return this._showLabel},set:function(t){this._showLabel=t,this.ManageLabel()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ShowTooltip",{get:function(){return this._showTooltip},set:function(t){this._showTooltip=t,this.ManageTooltip()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Title",{get:function(){return this._title},set:function(t){this._title=t,this.ManageLabel(),this.ManageTooltip()},enumerable:!1,configurable:!0}),e.prototype.AddListener=function(t,e){var n,i=this;(-1!==["click","dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"].indexOf(t)&&Microsoft.Maps.Events.addHandler(this._polygon,t,(function(t){e(t)})),"mousemove"===t)&&(Microsoft.Maps.Events.addHandler(this._polygon,"mouseover",(function(t){n=Microsoft.Maps.Events.addHandler(i._map,"mousemove",(function(t){return e(t)}))})),Microsoft.Maps.Events.addHandler(this._polygon,"mouseout",(function(t){n&&Microsoft.Maps.Events.removeHandler(n)})));"pathchanged"===t&&(this._editingCompleteEmitter=e)},e.prototype.Delete=function(){this._layer?this._layer.remove(this.NativePrimitve):this._map.entities.remove(this.NativePrimitve),this._label&&this._label.Delete(),this._tooltip&&this._tooltip.Delete()},e.prototype.GetDraggable=function(){return!1},e.prototype.GetEditable=function(){return this._isEditable},e.prototype.GetPath=function(){var t=this._polygon.getLocations(),e=new Array;return t.forEach((function(t){return e.push({latitude:t.latitude,longitude:t.longitude})})),e},e.prototype.GetPaths=function(){var t=this._polygon.getRings(),e=new Array;return t.forEach((function(t){var n=new Array;t.forEach((function(t){return n.push({latitude:t.latitude,longitude:t.longitude})})),e.push(n)})),e},e.prototype.GetVisible=function(){return this._polygon.getVisible()},e.prototype.SetDraggable=function(t){throw new Error("The bing maps implementation currently does not support draggable polygons.")},e.prototype.SetEditable=function(t){var e=this,n=this._isEditable!==t;this._isEditable=t,n&&(this._isEditable?(this._originalPath=this.GetPaths(),this._mapService.GetDrawingTools().then((function(t){t.edit(e._polygon)}))):this._mapService.GetDrawingTools().then((function(t){t.finish((function(t){if(t===e._polygon&&e._editingCompleteEmitter){var n=e.GetPaths(),i=e._originalPath;e.SetPaths(n),e._editingCompleteEmitter({Click:null,Polygon:e,OriginalPath:i,NewPath:n})}}))})))},e.prototype.SetOptions=function(t){var e=k.TranslatePolygonOptions(t);this._polygon.setOptions(e),null!=t.visible&&this._showLabel&&this._label&&this._label.Set("hidden",!t.visible),void 0!==t.editable&&this.SetEditable(t.editable)},e.prototype.SetPath=function(t){var e=new Array;t.forEach((function(t){return e.push(new Microsoft.Maps.Location(t.latitude,t.longitude))})),this._originalPath=[t],this._polygon.setLocations(e),this._label&&(this._centroid=null,this.ManageLabel())},e.prototype.SetPaths=function(t){if(null!=t&&Array.isArray(t)){if(0===t.length)return this._polygon.setRings(new Array),void(this._label&&(this._label.Delete(),this._label=null));if(Array.isArray(t[0])){var e=new Array;t.forEach((function(t){var n=new Array;t.forEach((function(t){return n.push(new Microsoft.Maps.Location(t.latitude,t.longitude))})),e.push(n)})),this._originalPath=t,this._polygon.setRings(e),this._label&&(this._centroid=null,this.ManageLabel())}else this.SetPath(t)}},e.prototype.SetVisible=function(t){this._polygon.setOptions({visible:t}),this._showLabel&&this._label&&this._label.Set("hidden",!t)},e.prototype.ManageLabel=function(){if(null!=this.GetPath&&0!==this.GetPath().length)if(this._showLabel&&null!=this._title&&""!==this._title){var t={text:this._title,position:k.TranslateLocation(this.Centroid)};if(null==t.position)return;-1!==this._minZoom&&(t.minZoom=this._minZoom),-1!==this._maxZoom&&(t.maxZoom=this._maxZoom),null==this._label?(this._label=new T(t),this._label.SetMap(this._map)):this._label.SetValues(t),this._label.Set("hidden",!this.GetVisible())}else this._label&&(this._label.SetMap(null),this._label=null)},e.prototype.ManageTooltip=function(){var t=this;if(this._showTooltip&&null!=this._title&&""!==this._title){var e={text:this._title,align:"left",offset:new Microsoft.Maps.Point(0,25),backgroundColor:"bisque",hidden:!0,fontSize:12,fontColor:"#000000",strokeWeight:0};null==this._tooltip?(this._tooltip=new T(e),this._tooltip.SetMap(this._map)):this._tooltip.SetValues(e),this._hasToolTipReceiver||(this._mouseOverListener=Microsoft.Maps.Events.addHandler(this._polygon,"mouseover",(function(e){t._tooltip.Set("position",e.location),t._tooltipVisible||(t._tooltip.Set("hidden",!1),t._tooltipVisible=!0),t._mouseMoveListener=Microsoft.Maps.Events.addHandler(t._map,"mousemove",(function(e){t._tooltipVisible&&e.location&&e.primitive===t._polygon&&t._tooltip.Set("position",e.location)}))})),this._mouseOutListener=Microsoft.Maps.Events.addHandler(this._polygon,"mouseout",(function(e){t._tooltipVisible&&(t._tooltip.Set("hidden",!0),t._tooltipVisible=!1),t._mouseMoveListener&&Microsoft.Maps.Events.removeHandler(t._mouseMoveListener)})),this._hasToolTipReceiver=!0)}this._showTooltip&&""!==this._title&&null!=this._title||(this._hasToolTipReceiver&&(this._mouseOutListener&&Microsoft.Maps.Events.removeHandler(this._mouseOutListener),this._mouseOverListener&&Microsoft.Maps.Events.removeHandler(this._mouseOverListener),this._mouseMoveListener&&Microsoft.Maps.Events.removeHandler(this._mouseMoveListener),this._hasToolTipReceiver=!1),this._tooltip&&(this._tooltip.SetMap(null),this._tooltip=null))},e}(c),R=function(t){function e(e,n,i){var o=t.call(this)||this;return o._polyline=e,o._map=n,o._layer=i,o._isEditable=!0,o._title="",o._showTooltip=!1,o._tooltip=null,o._hasToolTipReceiver=!1,o._tooltipVisible=!1,o._metadata=new Map,o}return f(e,t),Object.defineProperty(e.prototype,"Metadata",{get:function(){return this._metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"NativePrimitve",{get:function(){return this._polyline},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ShowTooltip",{get:function(){return this._showTooltip},set:function(t){this._showTooltip=t,this.ManageTooltip()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Title",{get:function(){return this._title},set:function(t){this._title=t,this.ManageTooltip()},enumerable:!1,configurable:!0}),e.prototype.AddListener=function(t,e){var n,i=this;(-1!==["click","dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"].indexOf(t)&&Microsoft.Maps.Events.addHandler(this._polyline,t,(function(t){e(t)})),"mousemove"===t)&&(Microsoft.Maps.Events.addHandler(this._polyline,"mouseover",(function(t){n=Microsoft.Maps.Events.addHandler(i._map,"mousemove",(function(t){return e(t)}))})),Microsoft.Maps.Events.addHandler(this._polyline,"mouseout",(function(t){n&&Microsoft.Maps.Events.removeHandler(n)})))},e.prototype.Delete=function(){this._layer?this._layer.remove(this.NativePrimitve):this._map.entities.remove(this.NativePrimitve),this._tooltip&&this._tooltip.Delete()},e.prototype.GetDraggable=function(){return!1},e.prototype.GetEditable=function(){return this._isEditable},e.prototype.GetPath=function(){var t=this._polyline.getLocations(),e=new Array;return t.forEach((function(t){return e.push({latitude:t.latitude,longitude:t.longitude})})),e},e.prototype.GetVisible=function(){return this._polyline.getVisible()},e.prototype.SetDraggable=function(t){throw new Error("The bing maps implementation currently does not support draggable polylines.")},e.prototype.SetEditable=function(t){this._isEditable=t},e.prototype.SetOptions=function(t){var e=k.TranslatePolylineOptions(t);this._polyline.setOptions(e),t.path&&this.SetPath(t.path)},e.prototype.SetPath=function(t){var e=new Array;t.forEach((function(t){return e.push(new Microsoft.Maps.Location(t.latitude,t.longitude))})),this._polyline.setLocations(e)},e.prototype.SetVisible=function(t){this._polyline.setOptions({visible:t})},e.prototype.ManageTooltip=function(){var t=this;if(this._showTooltip&&null!=this._title&&""!==this._title){var e={text:this._title,align:"left",offset:new Microsoft.Maps.Point(0,25),backgroundColor:"bisque",hidden:!0,fontSize:12,fontColor:"#000000",strokeWeight:0};null==this._tooltip?(this._tooltip=new T(e),this._tooltip.SetMap(this._map)):this._tooltip.SetValues(e),this._hasToolTipReceiver||(this._mouseOverListener=Microsoft.Maps.Events.addHandler(this._polyline,"mouseover",(function(e){t._tooltip.Set("position",e.location),t._tooltipVisible||(t._tooltip.Set("hidden",!1),t._tooltipVisible=!0)})),this._mouseMoveListener=Microsoft.Maps.Events.addHandler(this._map,"mousemove",(function(e){t._tooltipVisible&&e.location&&e.primitive===t._polyline&&t._tooltip.Set("position",e.location)})),this._mouseOutListener=Microsoft.Maps.Events.addHandler(this._polyline,"mouseout",(function(e){t._tooltipVisible&&(t._tooltip.Set("hidden",!0),t._tooltipVisible=!1)})),this._hasToolTipReceiver=!0)}this._showTooltip&&""!==this._title&&null!=this._title||(this._hasToolTipReceiver&&(this._mouseOutListener&&Microsoft.Maps.Events.removeHandler(this._mouseOutListener),this._mouseOverListener&&Microsoft.Maps.Events.removeHandler(this._mouseOverListener),this._mouseMoveListener&&Microsoft.Maps.Events.removeHandler(this._mouseMoveListener),this._hasToolTipReceiver=!1),this._tooltip&&(this._tooltip.SetMap(null),this._tooltip=null))},e}(p),j={click:"click",dblclick:"dblclick",rightclick:"rightclick",resize:"resize",boundschanged:"viewchangeend",centerchanged:"viewchangeend",zoomchanged:"viewchangeend",mouseover:"mouseover",mouseout:"mouseout",mousemove:"mousemove",infowindowclose:"infoboxChanged"},Z=function(t){function e(e){return t.call(this,e)||this}return f(e,t),e.prototype.GetCoordinatesFromClick=function(t){return{latitude:t.location.latitude,longitude:t.location.longitude}},e.prototype.GetMap=function(){return this.getMap()},e.prototype.GetToolTipOverlay=function(){var t={align:"left",offset:new Microsoft.Maps.Point(0,25),backgroundColor:"bisque",hidden:!0,fontSize:12,fontColor:"#000000",strokeWeight:0},e=new T(t);return e.SetMap(this.GetMap()),e},e.prototype.OnLoad=function(){var t=this,e=this.getMap();this._zoomStart=e.getZoom(),this._centerStart=e.getCenter(),this.Redraw(!0),this._viewChangeEvent=Microsoft.Maps.Events.addHandler(e,"viewchange",(function(n){if(e.getMapTypeId()===Microsoft.Maps.MapTypeId.streetside)t._canvas.style.display="none";else{var i=e.getZoom(),o=e.getCenter(),r=Math.pow(2,i-t._zoomStart),a=e.getWidth()*r,s=e.getHeight()*r,l=e.tryLocationToPixel([k.TranslateLocation(t._centerStart),o],Microsoft.Maps.PixelReference.control),u=l[1].x-l[0].x,c=l[1].y-l[0].y,p=-(a-e.getWidth())/2-u,h=-(s-e.getHeight())/2-c;t.UpdatePosition(p,h,a,s)}})),this._viewChangeEndEvent=Microsoft.Maps.Events.addHandler(e,"viewchangeend",(function(e){t.UpdateCanvas()})),this._mapResizeEvent=Microsoft.Maps.Events.addHandler(e,"mapresize",(function(e){t.UpdateCanvas()})),this._readyResolver(!0)},e.prototype.SetMap=function(t){var e=this.GetMap();t!==e&&(e&&e.layers.remove(this),null!=t&&t.layers.insert(this))},e.prototype.SetCanvasElement=function(t){this.setHtmlElement(t)},e.prototype.RemoveEventHandlers=function(){Microsoft.Maps.Events.removeHandler(this._viewChangeEvent),Microsoft.Maps.Events.removeHandler(this._viewChangeEndEvent),Microsoft.Maps.Events.removeHandler(this._mapResizeEvent)},e.prototype.Resize=function(){var t=this.getMap();this._canvas.width=t.getWidth(),this._canvas.height=t.getHeight()},e.prototype.UpdateCanvas=function(){var t=this.getMap();t.getMapTypeId()!==Microsoft.Maps.MapTypeId.streetside&&(this._canvas.style.display="",this.UpdatePosition(0,0,t.getWidth(),t.getHeight()),this.Redraw(!0),this._zoomStart=t.getZoom(),this._centerStart=t.getCenter())},e}(M);!function(t){t[t.BOTTOM_CENTER=0]="BOTTOM_CENTER",t[t.BOTTOM_LEFT=1]="BOTTOM_LEFT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.LEFT_BOTTOM=3]="LEFT_BOTTOM",t[t.LEFT_CENTER=4]="LEFT_CENTER",t[t.LEFT_TOP=5]="LEFT_TOP",t[t.RIGHT_BOTTOM=6]="RIGHT_BOTTOM",t[t.RIGHT_CENTER=7]="RIGHT_CENTER",t[t.RIGHT_TOP=8]="RIGHT_TOP",t[t.TOP_CENTER=9]="TOP_CENTER",t[t.TOP_LEFT=10]="TOP_LEFT",t[t.TOP_RIGHT=11]="TOP_RIGHT"}(x||(x={})),function(t){t[t.hybrid=0]="hybrid",t[t.roadmap=1]="roadmap",t[t.satellite=2]="satellite",t[t.terrain=3]="terrain"}(A||(A={})),function(t){t[t.DEFAULT=0]="DEFAULT",t[t.DROPDOWN_MENU=1]="DROPDOWN_MENU",t[t.HORIZONTAL_BAR=2]="HORIZONTAL_BAR"}(z||(z={})),function(t){t[t.DEFAULT=0]="DEFAULT"}(D||(D={})),function(t){t[t.DEFAULT=0]="DEFAULT",t[t.LARGE=1]="LARGE",t[t.SMALL=2]="SMALL"}(G||(G={}));var V=function(){function e(){}return e.TranslateBounds=function(t){return{east:t.maxLongitude,north:t.maxLatitude,south:t.minLatitude,west:t.minLongitude}},e.TranslateInfoWindowOptions=function(t){var n={};return Object.keys(t).filter((function(t){return-1!==e._infoWindowOptionsAttributes.indexOf(t)})).forEach((function(e){"htmlContent"===e?n.content=t[e]:n[e]=t[e]})),null!=n.content&&""!==n.content||(""!==t.title&&""!==t.description?n.content=t.title+": "+t.description:""!==t.description?n.content=t.description:n.content=t.title),n},e.TranslateLocation=function(t){return{lat:t.latitude,lng:t.longitude}},e.TranslateLatLng=function(t){return{latitude:t.lat,longitude:t.lng}},e.TranslateLocationObject=function(t){return new google.maps.LatLng(t.latitude,t.longitude)},e.TranslateLatLngObject=function(t){return{latitude:t.lat(),longitude:t.lng()}},e.TranslateLocationObjectArray=function(t){for(var n=new Array,i=0;i<t.length;i++)n.push(e.TranslateLocationObject(t[i]));return n},e.TranslateMapTypeId=function(e){switch(e){case t.MapTypeId.road:return A[A.roadmap];case t.MapTypeId.grayscale:return A[A.terrain];case t.MapTypeId.hybrid:return A[A.hybrid];case t.MapTypeId.ordnanceSurvey:return A[A.terrain];default:return A[A.satellite]}},e.TranslateMarkerOptions=function(t){var n={};return Object.keys(t).filter((function(t){return-1!==e._markerOptionsAttributes.indexOf(t)})).forEach((function(i){if("position"===i){var o=e.TranslateLocationObject(t[i]);n.position=o}else n[i]=t[i]})),n},e.TranslateOptions=function(t){var n={};return Object.keys(t).filter((function(t){return-1!==e._mapOptionsAttributes.indexOf(t)})).forEach((function(i){"center"===i?n.center=e.TranslateLocation(t.center):"mapTypeId"===i?n.mapTypeId=e.TranslateMapTypeId(t.mapTypeId):"disableZooming"===i?(n.gestureHandling="none",n.zoomControl=!1):"showMapTypeSelector"===i?n.mapTypeControl=!1:"customMapStyleGoogle"===i?n.styles=t.customMapStyleGoogle:n[i]=t[i]})),n},e.TranslatePaths=function(t){var n=new Array;if(null!=t&&Array.isArray(t)&&0!==t.length)if(Array.isArray(t[0]))for(var i=t,o=0;o<i.length;o++)n.push(e.TranslateLocationObjectArray(i[o]));else n.push(e.TranslateLocationObjectArray(t));else n.push(new Array);return n},e.TranslatePolygonOptions=function(t){var n={};return Object.keys(t).filter((function(t){return-1!==e._polygonOptionsAttributes.indexOf(t)})).forEach((function(e){if("paths"===e){if(!Array.isArray(t.paths))return;if(0===t.paths.length)n.paths=new Array;else if(Array.isArray(t.paths[0])){n.paths=new Array;for(var i=t.paths,o=0;o<i.length;o++){n.paths[o]=new Array;for(var r=0;r<i[o].length;r++)n.paths[o][r]={lat:i[o][r].latitude,lng:i[o][r].longitude}}}else{n.paths=new Array;for(i=t.paths,o=0;o<i.length;o++)n.paths[o]={lat:i[o].latitude,lng:i[o].longitude}}}else n[e]=t[e]})),n},e.TranslatePolylineOptions=function(t){var n={};return Object.keys(t).filter((function(t){return-1!==e._polylineOptionsAttributes.indexOf(t)})).forEach((function(e){n[e]=t[e]})),n},e}();V._mapOptionsAttributes=["backgroundColor","center","clickableIcons","customMapStyleGoogle","disableDefaultUI","disableDoubleClickZoom","draggable","draggableCursor","draggingCursor","disableZooming","fullscreenControl","fullscreenControlOptions","gestureHandling","heading","keyboardShortcuts","mapTypeControl","mapTypeControlOptions","mapTypeId","maxZoom","minZoom","noClear","panControl","panControlOptions","rotateControl","rotateControlOptions","scaleControl","scaleControlOptions","scrollwheel","showMapTypeSelector","streetView","streetViewControl","streetViewControlOptions","styles","tilt","zoom","zoomControl","zoomControlOptions"],V._infoWindowOptionsAttributes=["actions","description","htmlContent","id","position","pixelOffset","showCloseButton","showPointer","pushpin","title","titleClickHandler","typeName","visible","width","height"],V._markerOptionsAttributes=["anchor","position","title","text","label","draggable","icon","width","height","iconInfo","metadata","visible"],V._clusterOptionsAttributes=["callback","clusteredPinCallback","clusteringEnabled","gridSize","layerOffset","placementMode","visible","zIndex"],V._polygonOptionsAttributes=["clickable","draggable","editable","fillColor","fillOpacity","geodesic","paths","strokeColor","strokeOpacity","strokeWeight","visible","zIndex"],V._polylineOptionsAttributes=["clickable","draggable","editable","geodesic","strokeColor","strokeOpacity","strokeWeight","visible","zIndex"];var B=function(){function t(t,e){this._infoWindow=t,this._mapService=e}return Object.defineProperty(t.prototype,"IsOpen",{get:function(){return!0===this._isOpen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"NativePrimitve",{get:function(){return this._infoWindow},enumerable:!1,configurable:!0}),t.prototype.AddListener=function(t,e){var n=this;this._infoWindow.addListener(t,(function(i){"closeclick"===t&&(n._isOpen=!1),e(i)}))},t.prototype.Close=function(){this._isOpen=!1,this._infoWindow.close()},t.prototype.GetPosition=function(){return V.TranslateLatLngObject(this._infoWindow.getPosition())},t.prototype.Open=function(t){var e=this;this._mapService.MapPromise.then((function(n){e._isOpen=!0,e._infoWindow.open(n,t)}))},t.prototype.SetOptions=function(t){var e=V.TranslateInfoWindowOptions(t);this._infoWindow.setOptions(e)},t.prototype.SetPosition=function(t){var e=V.TranslateLocation(t);this._infoWindow.setPosition(e)},t}(),H=function(){function t(t){this._marker=t,this._metadata=new Map,this._isFirst=!1,this._isLast=!0}return Object.defineProperty(t.prototype,"IsFirst",{get:function(){return this._isFirst},set:function(t){this._isFirst=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"IsLast",{get:function(){return this._isLast},set:function(t){this._isLast=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Metadata",{get:function(){return this._metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"NativePrimitve",{get:function(){return this._marker},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Location",{get:function(){var t=this._marker.getPosition();return{latitude:t.lat(),longitude:t.lng()}},enumerable:!1,configurable:!0}),t.prototype.AddListener=function(t,e){this._marker.addListener(t,e)},t.prototype.DeleteMarker=function(){this._marker.setMap(null)},t.prototype.GetLabel=function(){return this._marker.getLabel().text},t.prototype.GetVisible=function(){return this._marker.getVisible()},t.prototype.SetAnchor=function(t){},t.prototype.SetDraggable=function(t){this._marker.setDraggable(t)},t.prototype.SetIcon=function(t){this._marker.setIcon(t)},t.prototype.SetLabel=function(t){this._marker.setLabel(t)},t.prototype.SetPosition=function(t){var e=V.TranslateLocationObject(t);this._marker.setPosition(e)},t.prototype.SetTitle=function(t){this._marker.setTitle(t)},t.prototype.SetOptions=function(t){var e=V.TranslateMarkerOptions(t);this._marker.setOptions(e)},t.prototype.SetVisible=function(t){this._marker.setVisible(t)},t}(),F=function(t){function e(e){return e.fontSize=e.fontSize||12,e.fontColor=e.fontColor||"#ffffff",e.strokeWeight=e.strokeWeight||3,e.strokeColor=e.strokeColor||"#000000",t.call(this,e)||this}return f(e,t),Object.defineProperty(e.prototype,"DefaultLabelStyle",{get:function(){return{fontSize:12,fontFamily:"sans-serif",fontColor:"#ffffff",strokeWeight:3,strokeColor:"#000000"}},enumerable:!1,configurable:!0}),e.prototype.Get=function(t){return this.get(t)},e.prototype.GetMap=function(){return this.getMap()},e.prototype.Set=function(t,e){"position"===t&&e.hasOwnProperty("latitude")&&e.hasOwnProperty("longitude")&&(e=new google.maps.LatLng(e.latitude,e.longitude)),this.Get(t)!==e&&this.set(t,e)},e.prototype.SetMap=function(t){this.setMap(t)},e.prototype.SetValues=function(t){for(var e in t)""!==e&&("position"===e&&t[e].hasOwnProperty("latitude")&&t[e].hasOwnProperty("longitude")&&(t[e]=new google.maps.LatLng(t[e].latitude,t[e].longitude)),this.Get(e)===t[e]&&delete t[e]);this.setValues(t)},e.prototype.Draw=function(){var t=this.getProjection(),e=this.GetVisible();if(t&&this._canvas){var n=this._canvas.style;if(""===e){var i=this.Get("offset"),o=this.Get("position");if(o){o instanceof google.maps.LatLng||(o=new google.maps.LatLng(o.lat,o.lng)),i||(i=new google.maps.Point(0,0));var r=t.fromLatLngToDivPixel(o);n.top=r.y+i.y+"px",n.left=r.x+i.x+"px",n.visibility=e}}else n.visibility=e}},e.prototype.OnAdd=function(){this._canvas=document.createElement("canvas"),this._canvas.style.position="absolute";var t=this._canvas.getContext("2d");t.lineJoin="round",t.textBaseline="top",this.DrawCanvas();var e=this.getPanes();e&&e.overlayLayer.appendChild(this._canvas)},e}(L);var W=function(t){function e(e){var n=t.call(this)||this;return n._polygon=e,n._title="",n._showLabel=!1,n._showTooltip=!1,n._maxZoom=-1,n._minZoom=-1,n._label=null,n._tooltip=null,n._tooltipVisible=!1,n._hasToolTipReceiver=!1,n._mouseOverListener=null,n._mouseOutListener=null,n._mouseMoveListener=null,n._metadata=new Map,n._editingCompleteEmitter=null,n._originalPath=n.GetPaths(),n}return f(e,t),Object.defineProperty(e.prototype,"LabelMaxZoom",{get:function(){return this._maxZoom},set:function(t){this._maxZoom=t,this.ManageLabel()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"LabelMinZoom",{get:function(){return this._minZoom},set:function(t){this._minZoom=t,this.ManageLabel()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Metadata",{get:function(){return this._metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"NativePrimitve",{get:function(){return this._polygon},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ShowLabel",{get:function(){return this._showLabel},set:function(t){this._showLabel=t,this.ManageLabel()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ShowTooltip",{get:function(){return this._showTooltip},set:function(t){this._showTooltip=t,this.ManageTooltip()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Title",{get:function(){return this._title},set:function(t){this._title=t,this.ManageLabel(),this.ManageTooltip()},enumerable:!1,configurable:!0}),e.prototype.AddListener=function(t,e){-1!==["click","dblclick","drag","dragend","dragstart","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"].indexOf(t)&&this._polygon.addListener(t,e),"pathchanged"===t&&(this._editingCompleteEmitter=e)},e.prototype.Delete=function(){this._polygon.setMap(null),this._label&&this._label.Delete(),this._tooltip&&this._tooltip.Delete()},e.prototype.GetDraggable=function(){return this._polygon.getDraggable()},e.prototype.GetEditable=function(){return this._polygon.getEditable()},e.prototype.GetPath=function(){var t=this._polygon.getPath(),e=new Array;return t.forEach((function(t){return e.push({latitude:t.lat(),longitude:t.lng()})})),e},e.prototype.GetPaths=function(){var t=this._polygon.getPaths(),e=new Array;return t.forEach((function(t){var n=new Array;t.forEach((function(t){return n.push({latitude:t.lat(),longitude:t.lng()})})),e.push(n)})),e},e.prototype.GetVisible=function(){return this._polygon.getVisible()},e.prototype.SetDraggable=function(t){this._polygon.setDraggable(t)},e.prototype.SetEditable=function(t){var e=this._polygon.getEditable();this._polygon.setEditable(t),e&&!t&&this._editingCompleteEmitter&&(this._editingCompleteEmitter({Click:null,Polygon:this,OriginalPath:this._originalPath,NewPath:this.GetPaths()}),this._originalPath=this.GetPaths())},e.prototype.SetOptions=function(t){var e=V.TranslatePolygonOptions(t);void 0!==e.editable&&(this.SetEditable(e.editable),delete e.editable),this._polygon.setOptions(e),null!=t.visible&&this._showLabel&&this._label&&this._label.Set("hidden",!t.visible)},e.prototype.SetPath=function(t){var e=new Array;t.forEach((function(t){return e.push(new google.maps.LatLng(t.latitude,t.longitude))})),this._polygon.setPath(e),this._originalPath=[t],this._label&&(this._centroid=null,this.ManageLabel())},e.prototype.SetPaths=function(t){if(null!=t&&Array.isArray(t)){if(0===t.length)return this._polygon.setPaths(new Array),void(this._label&&(this._label.Delete(),this._label=null));if(Array.isArray(t[0])){var e=new Array;t.forEach((function(t){var n=new Array;t.forEach((function(t){return n.push(new google.maps.LatLng(t.latitude,t.longitude))})),e.push(n)})),this._polygon.setPaths(e),this._originalPath=t,this._label&&(this._centroid=null,this.ManageLabel())}else this.SetPath(t)}},e.prototype.SetVisible=function(t){this._polygon.setVisible(t),this._showLabel&&this._label&&this._label.Set("hidden",!t)},e.prototype.ManageLabel=function(){if(null!=this.GetPath&&0!==this.GetPath().length)if(this._showLabel&&null!=this._title&&""!==this._title){var t={text:this._title,position:V.TranslateLocationObject(this.Centroid)};if(null==t.position)return;-1!==this._minZoom&&(t.minZoom=this._minZoom),-1!==this._maxZoom&&(t.maxZoom=this._maxZoom),null==this._label?(t.map=this.NativePrimitve.getMap(),t.zIndex=this.NativePrimitve.zIndex?this.NativePrimitve.zIndex+1:100,this._label=new F(t)):this._label.SetValues(t),this._label.Set("hidden",!this.GetVisible())}else this._label&&(this._label.SetMap(null),this._label=null)},e.prototype.ManageTooltip=function(){var t=this;if(this._showTooltip&&null!=this._title&&""!==this._title){var e={text:this._title,align:"left",offset:new google.maps.Point(0,25),backgroundColor:"bisque",hidden:!0,fontSize:12,fontColor:"#000000",strokeWeight:0};null==this._tooltip?(e.map=this.NativePrimitve.getMap(),e.zIndex=1e5,this._tooltip=new F(e)):this._tooltip.SetValues(e),this._hasToolTipReceiver||(this._mouseOverListener=this.NativePrimitve.addListener("mouseover",(function(e){t._tooltip.Set("position",e.latLng),t._tooltipVisible||(t._tooltip.Set("hidden",!1),t._tooltipVisible=!0)})),this._mouseMoveListener=this.NativePrimitve.addListener("mousemove",(function(e){t._tooltipVisible&&t._tooltip.Set("position",e.latLng)})),this._mouseOutListener=this.NativePrimitve.addListener("mouseout",(function(e){t._tooltipVisible&&(t._tooltip.Set("hidden",!0),t._tooltipVisible=!1)})),this._hasToolTipReceiver=!0)}this._showTooltip&&""!==this._title&&null!=this._title||(this._hasToolTipReceiver&&(this._mouseOutListener&&google.maps.event.removeListener(this._mouseOutListener),this._mouseOverListener&&google.maps.event.removeListener(this._mouseOverListener),this._mouseMoveListener&&google.maps.event.removeListener(this._mouseMoveListener),this._hasToolTipReceiver=!1),this._tooltip&&(this._tooltip.SetMap(null),this._tooltip=null))},e}(c),U=function(t){function e(e){var n=t.call(this)||this;return n._polyline=e,n._title="",n._showTooltip=!1,n._tooltip=null,n._tooltipVisible=!1,n._hasToolTipReceiver=!1,n._mouseOverListener=null,n._mouseOutListener=null,n._mouseMoveListener=null,n._metadata=new Map,n}return f(e,t),Object.defineProperty(e.prototype,"Metadata",{get:function(){return this._metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"NativePrimitve",{get:function(){return this._polyline},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ShowTooltip",{get:function(){return this._showTooltip},set:function(t){this._showTooltip=t,this.ManageTooltip()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Title",{get:function(){return this._title},set:function(t){this._title=t,this.ManageTooltip()},enumerable:!1,configurable:!0}),e.prototype.AddListener=function(t,e){-1!==["click","dblclick","drag","dragend","dragstart","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"].indexOf(t)&&this._polyline.addListener(t,e)},e.prototype.Delete=function(){this._polyline.setMap(null),this._tooltip&&this._tooltip.Delete()},e.prototype.GetDraggable=function(){return this._polyline.getDraggable()},e.prototype.GetEditable=function(){return this._polyline.getEditable()},e.prototype.GetPath=function(){var t=this._polyline.getPath(),e=new Array;return t.forEach((function(t){return e.push({latitude:t.lat(),longitude:t.lng()})})),e},e.prototype.GetVisible=function(){return this._polyline.getVisible()},e.prototype.SetDraggable=function(t){this._polyline.setDraggable(t)},e.prototype.SetEditable=function(t){this._polyline.setEditable(t)},e.prototype.SetOptions=function(t){var e=V.TranslatePolylineOptions(t);this._polyline.setOptions(e),t.path&&this.SetPath(t.path)},e.prototype.SetPath=function(t){var e=new Array;t.forEach((function(t){return e.push(new google.maps.LatLng(t.latitude,t.longitude))})),this._polyline.setPath(e)},e.prototype.SetVisible=function(t){this._polyline.setVisible(t)},e.prototype.ManageTooltip=function(){var t=this;if(this._showTooltip&&null!=this._title&&""!==this._title){var e={text:this._title,align:"left",offset:new google.maps.Point(0,25),backgroundColor:"bisque",hidden:!0,fontSize:12,fontColor:"#000000",strokeWeight:0};null==this._tooltip?(e.map=this.NativePrimitve.getMap(),e.zIndex=1e5,this._tooltip=new F(e)):this._tooltip.SetValues(e),this._hasToolTipReceiver||(this._mouseOverListener=this.NativePrimitve.addListener("mouseover",(function(e){t._tooltip.Set("position",e.latLng),t._tooltipVisible||(t._tooltip.Set("hidden",!1),t._tooltipVisible=!0)})),this._mouseMoveListener=this.NativePrimitve.addListener("mousemove",(function(e){t._tooltipVisible&&t._tooltip.Set("position",e.latLng)})),this._mouseOutListener=this.NativePrimitve.addListener("mouseout",(function(e){t._tooltipVisible&&(t._tooltip.Set("hidden",!0),t._tooltipVisible=!1)})),this._hasToolTipReceiver=!0)}this._showTooltip&&""!==this._title&&null!=this._title||(this._hasToolTipReceiver&&(this._mouseOutListener&&google.maps.event.removeListener(this._mouseOutListener),this._mouseOverListener&&google.maps.event.removeListener(this._mouseOverListener),this._mouseMoveListener&&google.maps.event.removeListener(this._mouseMoveListener),this._hasToolTipReceiver=!1),this._tooltip&&(this._tooltip.SetMap(null),this._tooltip=null))},e}(p),q={click:"click",dblclick:"dblclick",rightclick:"rightclick",resize:"resize",boundschanged:"bounds_changed",centerchanged:"center_changed",zoomchanged:"zoom_changed",mouseover:"mouseover",mouseout:"mouseout",mousemove:"mousemove",infowindowclose:"closeclick"},Y=function(t){function e(e){return t.call(this,e)||this}return f(e,t),e.prototype.GetCoordinatesFromClick=function(t){return t&&t.latLng&&t.latLng.lat&&t.latLng.lng?{latitude:t.latLng.lat(),longitude:t.latLng.lng()}:null},e.prototype.GetMap=function(){return this.getMap()},e.prototype.GetToolTipOverlay=function(){var t={align:"left",offset:new google.maps.Point(0,25),backgroundColor:"bisque",hidden:!0,fontSize:12,fontColor:"#000000",strokeWeight:0,zIndex:1e5},e=new F(t);return e.SetMap(this.GetMap()),e},e.prototype.OnAdd=function(){t.prototype.OnAdd.call(this),this.OnLoad(),this._canvas.style.zIndex="100",this._readyResolver(!0)},e.prototype.OnDraw=function(){var t=this.GetMap(),e=t.getZoom(),n=t.getCenter(),i=Math.pow(2,e-this._zoomStart),o=t.getDiv(),r=o.offsetWidth*i,a=o.offsetHeight*i,s=this.getProjection().fromLatLngToDivPixel(n);this.UpdatePosition(s.x-r/2,s.y-a/2,r,a)},e.prototype.OnLoad=function(){var t=this,e=this.getMap();this._zoomStart=e.getZoom();var n=e.getCenter();this._centerStart={latitude:n.lat(),longitude:n.lng()},this._viewChangeEndEvent=google.maps.event.addListener(e,"idle",(function(e){t.UpdateCanvas()})),this._mapResizeEvent=google.maps.event.addListener(e,"resize",(function(e){t.UpdateCanvas()}))},e.prototype.SetMap=function(t){this.setMap(t)},e.prototype.SetCanvasElement=function(t){var e=this.getPanes();e&&(null!=t?e.overlayLayer.appendChild(t):e.overlayLayer.removeChild(this._canvas))},e.prototype.RemoveEventHandlers=function(){this._viewChangeEndEvent&&google.maps.event.removeListener(this._viewChangeEndEvent),this._mapResizeEvent&&google.maps.event.removeListener(this._mapResizeEvent)},e.prototype.Resize=function(){var t=this.getMap().getDiv();this._canvas.width=t.offsetWidth,this._canvas.height=t.offsetHeight},e.prototype.UpdateCanvas=function(){var t=this.getMap();this._canvas.style.display="";var e=t.getDiv(),n=e.offsetWidth,i=e.offsetHeight,o=this.getProjection().fromLatLngToDivPixel(t.getCenter());this.UpdatePosition(o.x-n/2,o.y-i/2,n,i),this.Redraw(!0),this._zoomStart=t.getZoom();var r=t.getCenter();this._centerStart={latitude:r.lat(),longitude:r.lng()}},e}(M);var K=function(){};K.decorators=[{type:e.Injectable}];var X=function(){function t(){}return t.GetRandonLocations=function(t,e){var n=[],i=function(t){var e=Math.random()*(t.maxLatitude-t.minLatitude)+t.minLatitude,n=0;return o?(n=Math.random()*(t.minLongitude+360-t.maxLongitude)+t.maxLongitude)>180&&(n-=360):n=Math.random()*(t.maxLongitude-t.minLongitude)+t.minLongitude,{latitude:e,longitude:n}},o=!1;if(null==e&&(e={maxLatitude:360,minLatitude:0,maxLongitude:170,minLongitude:0}),(e.center.longitude<e.minLongitude||e.center.longitude>e.maxLongitude)&&(o=!0),!t||t<=0)return[i(e)];for(var r=0;r<t;r++)n.push(i(e));return n},t}();X.decorators=[{type:e.Injectable}];var J=function(){};J.decorators=[{type:e.Injectable}];var Q=function(){};Q.decorators=[{type:e.Injectable}];var $=function(){};$.decorators=[{type:e.Injectable}];var tt=function(){};tt.decorators=[{type:e.Injectable}];var et=function(){};et.decorators=[{type:e.Injectable}];var nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e}($);nt.decorators=[{type:e.Injectable}];var it=function(){this.ActionClicked=new e.EventEmitter};it.decorators=[{type:e.Directive,args:[{selector:"x-info-box-action"}]}],it.propDecorators={Label:[{type:e.Input}],ActionClicked:[{type:e.Output}]};var ot=0,rt=function(){function t(t){this._infoBoxService=t,this._infoBoxAddedToManager=!1,this._id=(ot++).toString(),this.Modal=!0,this.Visible=!1,this.CloseInfoBoxesOnOpen=!0,this.InfoBoxClose=new e.EventEmitter}return Object.defineProperty(t.prototype,"HtmlContent",{get:function(){return this._content.nativeElement&&this._content.nativeElement.innerText&&""!==this._content.nativeElement.innerText.trim()?this._content.nativeElement.outerHTML:""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Id",{get:function(){return this._id},enumerable:!1,configurable:!0}),t.prototype.Close=function(){var t=this;return this._infoBoxService.Close(this).then((function(){t.InfoBoxClose.emit(t._id)}))},t.prototype.ngAfterViewInit=function(){this._infoBoxService.AddInfoWindow(this),this._infoBoxAddedToManager=!0,this.HandleEvents()},t.prototype.ngOnChanges=function(t){this._infoBoxAddedToManager&&((t.latitude||t.longitude)&&"number"==typeof this.Latitude&&"number"==typeof this.Longitude&&this._infoBoxService.SetPosition(this,{latitude:t.latitude.currentValue,longitude:t.longitude.currentValue}),this.SetInfoWindowOptions(t))},t.prototype.ngOnDestroy=function(){this._infoBoxService.DeleteInfoWindow(this)},t.prototype.Open=function(t){return this._infoBoxService.Open(this,t)},t.prototype.ToString=function(){return"InfoBoxComponent-"+this._id},t.prototype.HandleEvents=function(){var t=this;this._infoBoxService.CreateEventObservable("infowindowclose",this).subscribe((function(e){t.InfoBoxClose.emit(t._id)}))},t.prototype.SetInfoWindowOptions=function(t){var e={};t.title&&(e.title=this.Title),t.description&&(e.description=this.Description),t.disableAutoPan&&(e.disableAutoPan=this.DisableAutoPan),t.visible&&(e.visible=this.Visible),(t.xOffset||t.yOffset)&&(null==e.pixelOffset&&(e.pixelOffset={x:0,y:0}),e.pixelOffset.x=this.xOffset,e.pixelOffset.y=this.yOffset),this._infoBoxService.SetOptions(this,e)},t}();rt.decorators=[{type:e.Component,args:[{selector:"x-info-box",template:"\n        <div #infoBoxContent class='info-box-content'>\n            <ng-content></ng-content>\n        </div>",encapsulation:e.ViewEncapsulation.None,styles:["\n        x-map .MicrosoftMap .Infobox .infobox-title { padding: 10px 10px 5px 10px }\n        x-map .MicrosoftMap .Infobox .infobox-info { padding: 3px 10px 10px 10px }\n        x-map .MicrosoftMap .Infobox .infobox-actions { height: auto }\n    "]}]}],rt.ctorParameters=function(){return[{type:Q}]},rt.propDecorators={_content:[{type:e.ViewChild,args:["infoBoxContent"]}],InfoWindowActions:[{type:e.ContentChildren,args:[it]}],Latitude:[{type:e.Input}],Longitude:[{type:e.Input}],Title:[{type:e.Input}],Description:[{type:e.Input}],DisableAutoPan:[{type:e.Input}],MaxWidth:[{type:e.Input}],Modal:[{type:e.Input}],HostMarker:[{type:e.Input}],Visible:[{type:e.Input}],xOffset:[{type:e.Input}],yOffset:[{type:e.Input}],CloseInfoBoxesOnOpen:[{type:e.Input}],InfoBoxClose:[{type:e.Output}]};var at=0,st=function(){function t(t,n){this._markerService=t,this._containerRef=n,this._clickTimeout=null,this._events=[],this._inClusterLayer=!1,this._inCustomLayer=!1,this._markerAddedToManger=!1,this.DblClick=new e.EventEmitter,this.Drag=new e.EventEmitter,this.DragEnd=new e.EventEmitter,this.Draggable=!1,this.DragStart=new e.EventEmitter,this.DynamicMarkerCreated=new e.EventEmitter,this.IsFirstInSet=!1,this.IsLastInSet=!0,this.MarkerClick=new e.EventEmitter,this.Metadata=new Map,this.MouseDown=new e.EventEmitter,this.MouseMove=new e.EventEmitter,this.MouseOut=new e.EventEmitter,this.MouseOver=new e.EventEmitter,this.MouseUp=new e.EventEmitter,this.RightClick=new e.EventEmitter,this._id=(at++).toString()}return Object.defineProperty(t.prototype,"AddedToManager",{get:function(){return this._markerAddedToManger},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"InClusterLayer",{get:function(){return this._inClusterLayer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"InCustomLayer",{get:function(){return this._inCustomLayer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"LayerId",{get:function(){return this._layerId},enumerable:!1,configurable:!0}),t.prototype.LocationToPixel=function(t){return this._markerService.LocationToPoint(t||this)},t.prototype.ngAfterContentInit=function(){if(null!=this._infoBox&&(this._infoBox.HostMarker=this),this._containerRef.element.nativeElement.parentElement){var t=this._containerRef.element.nativeElement.parentElement.tagName;"x-cluster-layer"===t.toLowerCase()?this._inClusterLayer=!0:"x-map-layer"===t.toLowerCase()&&(this._inCustomLayer=!0),this._layerId=Number(this._containerRef.element.nativeElement.parentElement.attributes.layerId)}this._markerAddedToManger||(this._markerService.AddMarker(this),this._markerAddedToManger=!0,this.AddEventListeners())},t.prototype.ngOnChanges=function(t){"number"==typeof this.Latitude&&"number"==typeof this.Longitude&&this._markerAddedToManger&&((t.Latitude||t.Longitude)&&this._markerService.UpdateMarkerPosition(this),t.Title&&this._markerService.UpdateTitle(this),t.Label&&this._markerService.UpdateLabel(this),t.Draggable&&this._markerService.UpdateDraggable(this),(t.IconUrl||t.IconInfo)&&this._markerService.UpdateIcon(this),t.Anchor&&this._markerService.UpdateAnchor(this),t.Visible&&this._markerService.UpdateVisible(this))},t.prototype.ngOnDestroy=function(){this._markerService.DeleteMarker(this),this._events.forEach((function(t){return t.unsubscribe()}))},t.prototype.toString=function(){return"MapMarker-"+this._id.toString()},t.prototype.AddEventListeners=function(){var t=this,e=function(e){return{Marker:t,Click:e,Location:t._markerService.GetCoordinatesFromClick(e),Pixels:t._markerService.GetPixelsFromClick(e)}};this._events.push(this._markerService.CreateEventObservable("click",this).subscribe((function(n){t._clickTimeout=r.timer(300).subscribe((function(i){null!=t._infoBox&&t._infoBox.Open(t._markerService.GetCoordinatesFromClick(n)),t.MarkerClick.emit(e(n))}))}))),this._events.push(this._markerService.CreateEventObservable("dblclick",this).subscribe((function(n){t._clickTimeout&&(t._clickTimeout.unsubscribe(),t._clickTimeout=null),t.DblClick.emit(e(n))}))),[{name:"drag",handler:function(n){return t.Drag.emit(e(n))}},{name:"dragend",handler:function(n){return t.DragEnd.emit(e(n))}},{name:"dragstart",handler:function(n){return t.DragStart.emit(e(n))}},{name:"mousedown",handler:function(n){return t.MouseDown.emit(e(n))}},{name:"mousemove",handler:function(n){return t.MouseMove.emit(e(n))}},{name:"mouseout",handler:function(n){return t.MouseOut.emit(e(n))}},{name:"mouseover",handler:function(n){return t.MouseOver.emit(e(n))}},{name:"mouseup",handler:function(n){return t.MouseUp.emit(e(n))}},{name:"rightclick",handler:function(n){return t.RightClick.emit(e(n))}}].forEach((function(e){var n=t._markerService.CreateEventObservable(e.name,t).subscribe(e.handler);t._events.push(n)}))},t}();st.decorators=[{type:e.Directive,args:[{selector:"x-map-marker"}]}],st.ctorParameters=function(){return[{type:J},{type:e.ViewContainerRef}]},st.propDecorators={_infoBox:[{type:e.ContentChild,args:[rt]}],Anchor:[{type:e.Input}],DblClick:[{type:e.Output}],Drag:[{type:e.Output}],DragEnd:[{type:e.Output}],Draggable:[{type:e.Input}],DragStart:[{type:e.Output}],DynamicMarkerCreated:[{type:e.Output}],Height:[{type:e.Input}],IconInfo:[{type:e.Input}],IconUrl:[{type:e.Input}],IsFirstInSet:[{type:e.Input}],IsLastInSet:[{type:e.Input}],Label:[{type:e.Input}],Latitude:[{type:e.Input}],Longitude:[{type:e.Input}],MarkerClick:[{type:e.Output}],Metadata:[{type:e.Input}],MouseDown:[{type:e.Output}],MouseMove:[{type:e.Output}],MouseOut:[{type:e.Output}],MouseOver:[{type:e.Output}],MouseUp:[{type:e.Output}],RightClick:[{type:e.Output}],Title:[{type:e.Input}],Visible:[{type:e.Input}],Width:[{type:e.Input}]};var lt=function(){function n(t,n){this._mapService=t,this._zone=n,this._longitude=0,this._latitude=0,this._zoom=0,this._options={},this._box=null,this._containerClass=!0,this.BoundsChange=new e.EventEmitter,this.CenterChange=new e.EventEmitter,this.MapClick=new e.EventEmitter,this.MapDblClick=new e.EventEmitter,this.MapRightClick=new e.EventEmitter,this.MapMouseOver=new e.EventEmitter,this.MapMouseOut=new e.EventEmitter,this.MapMouseMove=new e.EventEmitter,this.MapPromise=new e.EventEmitter,this.ZoomChange=new e.EventEmitter,this.MapService=new e.EventEmitter}return Object.defineProperty(n.prototype,"Box",{get:function(){return this._box},set:function(t){this._box=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Latitude",{get:function(){return this._longitude},set:function(t){this._latitude=this.ConvertToDecimal(t),this.UpdateCenter()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Longitude",{get:function(){return this._longitude},set:function(t){this._longitude=this.ConvertToDecimal(t),this.UpdateCenter()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Options",{get:function(){return this._options},set:function(t){this._options=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Zoom",{get:function(){return this._zoom},set:function(t){this._zoom=this.ConvertToDecimal(t,8),"number"==typeof this._zoom&&this._mapService.SetZoom(this._zoom)},enumerable:!1,configurable:!0}),n.prototype.ngOnInit=function(){this.MapPromise.emit(this._mapService.MapPromise),this.MapService.emit(this._mapService)},n.prototype.ngAfterViewInit=function(){this.InitMapInstance(this._container.nativeElement)},n.prototype.ngOnChanges=function(t){this._mapPromise&&(t.Box&&null!=this._box&&this._mapService.SetViewOptions({bounds:this._box}),t.Options&&this._mapService.SetMapOptions(this._options))},n.prototype.ngOnDestroy=function(){this._mapService.DisposeMap()},n.prototype.TriggerResize=function(){var t=this;return new Promise((function(e){setTimeout((function(){return t._mapService.TriggerMapEvent("resize").then((function(){return e()}))}))}))},n.prototype.ConvertToDecimal=function(t,e){return void 0===e&&(e=null),"string"==typeof t?parseFloat(t):"number"==typeof t?t:e},n.prototype.HandleMapClickEvents=function(){var t=this;this._mapService.SubscribeToMapEvent("click").subscribe((function(e){t._clickTimeout=setTimeout((function(){t.MapClick.emit(e)}),300)})),this._mapService.SubscribeToMapEvent("dblclick").subscribe((function(e){t._clickTimeout&&clearTimeout(t._clickTimeout),t.MapDblClick.emit(e)})),this._mapService.SubscribeToMapEvent("rightclick").subscribe((function(e){t.MapRightClick.emit(e)})),this._mapService.SubscribeToMapEvent("mouseover").subscribe((function(e){t.MapMouseOver.emit(e)})),this._mapService.SubscribeToMapEvent("mouseout").subscribe((function(e){t.MapMouseOut.emit(e)})),this._mapService.SubscribeToMapEvent("mousemove").subscribe((function(e){t.MapMouseMove.emit(e)}))},n.prototype.HandleMapBoundsChange=function(){var t=this;this._mapService.SubscribeToMapEvent("boundschanged").subscribe((function(){t._mapService.GetBounds().then((function(e){t.BoundsChange.emit(e)}))}))},n.prototype.HandleMapCenterChange=function(){var t=this;this._mapService.SubscribeToMapEvent("centerchanged").subscribe((function(){t._mapService.GetCenter().then((function(e){t._latitude===e.latitude&&t._longitude===e.longitude||(t._latitude=e.latitude,t._longitude=e.longitude,t.CenterChange.emit({latitude:t._latitude,longitude:t._longitude}))}))}))},n.prototype.HandleMapZoomChange=function(){var t=this;this._mapService.SubscribeToMapEvent("zoomchanged").subscribe((function(){t._mapService.GetZoom().then((function(e){t._zoom!==e&&(t._zoom=e,t.ZoomChange.emit(e))}))}))},n.prototype.InitMapInstance=function(e){var n=this;this._zone.runOutsideAngular((function(){null==n._options.center&&(n._options.center={latitude:n._latitude,longitude:n._longitude}),null==n._options.zoom&&(n._options.zoom=n._zoom),null==n._options.mapTypeId&&(n._options.mapTypeId=t.MapTypeId.hybrid),null!=n._box&&(n._options.bounds=n._box),n._mapPromise=n._mapService.CreateMap(e,n._options),n.HandleMapCenterChange(),n.HandleMapBoundsChange(),n.HandleMapZoomChange(),n.HandleMapClickEvents()}))},n.prototype.UpdateCenter=function(){"number"==typeof this._latitude&&"number"==typeof this._longitude&&this._mapService.SetCenter({latitude:this._latitude,longitude:this._longitude})},n}();function ut(t,e){return t.CreateClusterService(e)}function ct(t,e,n){return t.CreateInfoBoxService(e,n)}function pt(t,e){return t.CreateLayerService(e)}function ht(t){return t.Create()}function ft(t,e,n,i){return t.CreateMarkerService(e,n,i)}function dt(t,e,n){return t.CreatePolygonService(e,n)}function yt(t,e,n){return t.CreatePolylineService(e,n)}lt.decorators=[{type:e.Component,args:[{selector:"x-map",providers:[{provide:X,deps:[K],useFactory:ht},{provide:J,deps:[K,X,$,nt],useFactory:ft},{provide:Q,deps:[K,X,J],useFactory:ct},{provide:$,deps:[K,X],useFactory:pt},{provide:nt,deps:[K,X],useFactory:ut},{provide:tt,deps:[K,X,$],useFactory:dt},{provide:et,deps:[K,X,$],useFactory:yt}],template:"\n        <div #container class='map-container-inner'></div>\n        <div class='map-content'>\n            <ng-content></ng-content>\n        </div>\n    ",encapsulation:e.ViewEncapsulation.None,changeDetection:e.ChangeDetectionStrategy.OnPush,styles:["\n        .map-container-inner { width: inherit; height: inherit; }\n        .map-container-inner div { background-repeat: no-repeat; }\n        .map-content { display:none; }\n    "]}]}],lt.ctorParameters=function(){return[{type:X},{type:e.NgZone}]},lt.propDecorators={_containerClass:[{type:e.HostBinding,args:["class.map-container"]}],_container:[{type:e.ViewChild,args:["container"]}],_markers:[{type:e.ContentChildren,args:[st]}],Box:[{type:e.Input}],Latitude:[{type:e.Input}],Longitude:[{type:e.Input}],Options:[{type:e.Input}],Zoom:[{type:e.Input}],BoundsChange:[{type:e.Output}],CenterChange:[{type:e.Output}],MapClick:[{type:e.Output}],MapDblClick:[{type:e.Output}],MapRightClick:[{type:e.Output}],MapMouseOver:[{type:e.Output}],MapMouseOut:[{type:e.Output}],MapMouseMove:[{type:e.Output}],MapPromise:[{type:e.Output}],ZoomChange:[{type:e.Output}],MapService:[{type:e.Output}]};var mt=0,gt=function(){function t(t,e){this._layerService=t,this._containerRef=e,this._visible=!0,this._addedToManager=!1,this._id=mt++}return Object.defineProperty(t.prototype,"Visible",{get:function(){return this._visible},set:function(t){this._visible=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Id",{get:function(){return this._id},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){this._containerRef.element.nativeElement.attributes.layerId=this._id.toString(),this._layerService.AddLayer(this),this._addedToManager=!0},t.prototype.ngOnChanges=function(t){this._addedToManager&&t.Visible&&this._layerService.GetNativeLayer(this).then((function(t){t.SetVisible(!t.GetVisible())}))},t.prototype.ngOnDestroy=function(){this._layerService.DeleteLayer(this)},t}();gt.decorators=[{type:e.Directive,args:[{selector:"x-map-layer"}]}],gt.ctorParameters=function(){return[{type:$},{type:e.ViewContainerRef}]},gt.propDecorators={_markers:[{type:e.ContentChildren,args:[st]}],Visible:[{type:e.Input}]};var vt=function(e){function n(n,i){var o=e.call(this,n,i)||this;return o._clusteringEnabled=!0,o._clusterPlacementMode=t.ClusterPlacementMode.MeanValue,o._clusterClickAction=t.ClusterClickAction.ZoomIntoCluster,o._useDynamicSizeMarker=!1,o._dynamicMarkerBaseSize=18,o._dynamicMarkerRanges=new Map([[10,"rgba(20, 180, 20, 0.5)"],[100,"rgba(255, 210, 40, 0.5)"],[Number.MAX_SAFE_INTEGER,"rgba(255, 40, 40, 0.5)"]]),o._zoomOnClick=!0,o}return f(n,e),Object.defineProperty(n.prototype,"ClusterClickAction",{get:function(){return this._clusterClickAction},set:function(t){this._clusterClickAction=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ClusteringEnabled",{get:function(){return this._clusteringEnabled},set:function(t){this._clusteringEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ClusterPlacementMode",{get:function(){return this._clusterPlacementMode},set:function(t){this._clusterPlacementMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"CustomMarkerCallback",{get:function(){return this._iconCreationCallback},set:function(t){if(this._useDynamicSizeMarker)throw new Error("You cannot set a custom marker callback when UseDynamicSizeMarkers is set to true.\n                    Set UseDynamicSizeMakers to false.");this._iconCreationCallback=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"DynamicMarkerBaseSize",{get:function(){return this._dynamicMarkerBaseSize},set:function(t){this._dynamicMarkerBaseSize=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"DynamicMarkerRanges",{get:function(){return this._dynamicMarkerRanges},set:function(t){this._dynamicMarkerRanges=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"GridSize",{get:function(){return this._gridSize},set:function(t){this._gridSize=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"IconInfo",{get:function(){return this._iconInfo},set:function(t){this._iconInfo=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"LayerOffset",{get:function(){return this._layerOffset},set:function(t){this._layerOffset=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"MinimumClusterSize",{get:function(){return this._minimumClusterSize},set:function(t){this._minimumClusterSize=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"SpiderClusterOptions",{get:function(){return this._spiderClusterOptions},set:function(t){this._spiderClusterOptions=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Styles",{get:function(){return this._styles},set:function(t){this._styles=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"UseDynamicSizeMarkers",{get:function(){return this._useDynamicSizeMarker},set:function(t){var e=this;this._useDynamicSizeMarker=t,t&&(this._iconCreationCallback=function(t,i){return n.CreateDynamicSizeMarker(t.length,i,e._dynamicMarkerBaseSize,e._dynamicMarkerRanges)})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ZIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ZoomOnClick",{get:function(){return this._zoomOnClick},set:function(t){this._zoomOnClick=t},enumerable:!1,configurable:!0}),n.CreateDynamicSizeMarker=function(t,e,n,i){var o,r=n,a=.35*r,s=t,l=Math.log(s)/Math.log(10)*5+r,u=2*l;i.forEach((function(t,e){s<=e&&!o&&(o=t)})),o||(o="rgba(20, 180, 20, 0.5)");var c=["<svg xmlns='http://www.w3.org/2000/svg' width='"+u+"' height='"+u+"'>","<circle cx='"+l+"' cy='"+l+"' r='"+l+"' fill='"+o+"'/>","<circle cx='"+l+"' cy='"+l+"' r='"+(l-a)+"' fill='"+o+"'/>","</svg>"];return e.size={width:u,height:u},e.markerOffsetRatio={x:.5,y:.5},e.textOffset={x:0,y:l-8},c.join("")},n.prototype.ngOnChanges=function(t){if(this._addedToManager){if(t.ClusterClickAction)throw new Error("You cannot change the ClusterClickAction after the layer has been added to the layerservice.");var e={id:this._id};t.ClusteringEnabled&&(e.clusteringEnabled=this._clusteringEnabled),t.GridSize&&(e.gridSize=this._gridSize),t.LayerOffset&&(e.layerOffset=this._layerOffset),t.SpiderClusterOptions&&(e.spiderClusterOptions=this._spiderClusterOptions),t.ZIndex&&(e.zIndex=this._zIndex),t.Visible&&(e.visible=this._visible),this._layerService.GetNativeLayer(this).then((function(t){t.SetOptions(e)}))}},n}(gt);vt.decorators=[{type:e.Directive,args:[{selector:"x-cluster-layer"}]}],vt.ctorParameters=function(){return[{type:nt},{type:e.ViewContainerRef}]},vt.propDecorators={ClusterClickAction:[{type:e.Input}],ClusteringEnabled:[{type:e.Input}],ClusterPlacementMode:[{type:e.Input}],CustomMarkerCallback:[{type:e.Input}],DynamicMarkerBaseSize:[{type:e.Input}],DynamicMarkerRanges:[{type:e.Input}],GridSize:[{type:e.Input}],IconInfo:[{type:e.Input}],LayerOffset:[{type:e.Input}],MinimumClusterSize:[{type:e.Input}],SpiderClusterOptions:[{type:e.Input}],Styles:[{type:e.Input}],UseDynamicSizeMarkers:[{type:e.Input}],ZIndex:[{type:e.Input}],ZoomOnClick:[{type:e.Input}]};var _t=0,bt=function(){function t(t,n){this._polygonService=t,this._containerRef=n,this._inCustomLayer=!1,this._addedToService=!1,this._events=[],this.Clickable=!0,this.Draggable=!1,this.Editable=!1,this.Geodesic=!1,this.Metadata=new Map,this.Paths=[],this.ShowTooltip=!0,this.Click=new e.EventEmitter,this.DblClick=new e.EventEmitter,this.Drag=new e.EventEmitter,this.DragEnd=new e.EventEmitter,this.DragStart=new e.EventEmitter,this.MouseDown=new e.EventEmitter,this.MouseMove=new e.EventEmitter,this.MouseOut=new e.EventEmitter,this.MouseOver=new e.EventEmitter,this.MouseUp=new e.EventEmitter,this.RightClick=new e.EventEmitter,this.PathChanged=new e.EventEmitter,this._id=_t++}return Object.defineProperty(t.prototype,"AddedToService",{get:function(){return this._addedToService},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"IdAsString",{get:function(){return this._id.toString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"InCustomLayer",{get:function(){return this._inCustomLayer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"LayerId",{get:function(){return this._layerId},enumerable:!1,configurable:!0}),t.prototype.ngAfterContentInit=function(){this._containerRef.element.nativeElement.parentElement&&("x-map-layer"===this._containerRef.element.nativeElement.parentElement.tagName.toLowerCase()&&(this._inCustomLayer=!0,this._layerId=Number(this._containerRef.element.nativeElement.parentElement.attributes.layerId)));this._addedToService||(this._polygonService.AddPolygon(this),this._addedToService=!0,this.AddEventListeners())},t.prototype.ngOnChanges=function(t){if(this._addedToService){var e=this.GeneratePolygonChangeSet(t);null!=e&&this._polygonService.SetOptions(this,e),t.Paths&&!t.Paths.isFirstChange()&&this._polygonService.UpdatePolygon(this)}},t.prototype.ngOnDestroy=function(){this._polygonService.DeletePolygon(this),this._events.forEach((function(t){return t.unsubscribe()}))},t.prototype.AddEventListeners=function(){var t=this,e=function(e){return{Polygon:t,Click:e}};this._events.push(this._polygonService.CreateEventObservable("click",this).subscribe((function(n){null!=t._infoBox&&t._infoBox.Open(t._polygonService.GetCoordinatesFromClick(n)),t.Click.emit(e(n))}))),[{name:"dblclick",handler:function(n){return t.DblClick.emit(e(n))}},{name:"drag",handler:function(n){return t.Drag.emit(e(n))}},{name:"dragend",handler:function(n){return t.DragEnd.emit(e(n))}},{name:"dragstart",handler:function(n){return t.DragStart.emit(e(n))}},{name:"mousedown",handler:function(n){return t.MouseDown.emit(e(n))}},{name:"mousemove",handler:function(n){return t.MouseMove.emit(e(n))}},{name:"mouseout",handler:function(n){return t.MouseOut.emit(e(n))}},{name:"mouseover",handler:function(n){return t.MouseOver.emit(e(n))}},{name:"mouseup",handler:function(n){return t.MouseUp.emit(e(n))}},{name:"rightclick",handler:function(n){return t.RightClick.emit(e(n))}},{name:"pathchanged",handler:function(e){return t.PathChanged.emit(e)}}].forEach((function(e){var n=t._polygonService.CreateEventObservable(e.name,t).subscribe(e.handler);t._events.push(n)}))},t.prototype.GeneratePolygonChangeSet=function(t){var e={id:this._id},n=!1;return t.Clickable&&(e.clickable=this.Clickable,n=!0),t.Draggable&&(e.draggable=this.Draggable,n=!0),t.Editable&&(e.editable=this.Editable,n=!0),(t.FillColor||t.FillOpacity)&&(e.fillColor=this.FillColor,e.fillOpacity=this.FillOpacity,n=!0),t.Geodesic&&(e.geodesic=this.Geodesic,n=!0),t.LabelMaxZoom&&(e.labelMaxZoom=this.LabelMaxZoom,n=!0),t.LabelMinZoom&&(e.labelMinZoom=this.LabelMinZoom,n=!0),t.ShowTooltip&&(e.showTooltip=this.ShowTooltip,n=!0),t.ShowLabel&&(e.showLabel=this.ShowLabel,n=!0),(t.StrokeColor||t.StrokeOpacity)&&(e.strokeColor=this.StrokeColor,e.strokeOpacity=this.StrokeOpacity,n=!0),t.StrokeWeight&&(e.strokeWeight=this.StrokeWeight,n=!0),t.Title&&(e.title=this.Title,n=!0),t.Visible&&(e.visible=this.Visible,n=!0),t.zIndex&&(e.zIndex=this.zIndex,n=!0),n?e:null},t}();bt.decorators=[{type:e.Directive,args:[{selector:"x-map-polygon"}]}],bt.ctorParameters=function(){return[{type:tt},{type:e.ViewContainerRef}]},bt.propDecorators={_infoBox:[{type:e.ContentChild,args:[rt]}],Clickable:[{type:e.Input}],Draggable:[{type:e.Input}],Editable:[{type:e.Input}],FillColor:[{type:e.Input}],FillOpacity:[{type:e.Input}],Geodesic:[{type:e.Input}],LabelMaxZoom:[{type:e.Input}],LabelMinZoom:[{type:e.Input}],Metadata:[{type:e.Input}],Paths:[{type:e.Input}],ShowLabel:[{type:e.Input}],ShowTooltip:[{type:e.Input}],StrokeColor:[{type:e.Input}],StrokeOpacity:[{type:e.Input}],StrokeWeight:[{type:e.Input}],Title:[{type:e.Input}],Visible:[{type:e.Input}],zIndex:[{type:e.Input}],Click:[{type:e.Output}],DblClick:[{type:e.Output}],Drag:[{type:e.Output}],DragEnd:[{type:e.Output}],DragStart:[{type:e.Output}],MouseDown:[{type:e.Output}],MouseMove:[{type:e.Output}],MouseOut:[{type:e.Output}],MouseOver:[{type:e.Output}],MouseUp:[{type:e.Output}],RightClick:[{type:e.Output}],PathChanged:[{type:e.Output}]};var Mt=0,Ct=function(){function t(t,n){this._polylineService=t,this._containerRef=n,this._inCustomLayer=!1,this._addedToService=!1,this._events=[],this.Clickable=!0,this.Draggable=!1,this.Editable=!1,this.Geodesic=!1,this.Metadata=new Map,this.Path=[],this.ShowTooltip=!0,this.Click=new e.EventEmitter,this.DblClick=new e.EventEmitter,this.Drag=new e.EventEmitter,this.DragEnd=new e.EventEmitter,this.DragStart=new e.EventEmitter,this.MouseDown=new e.EventEmitter,this.MouseMove=new e.EventEmitter,this.MouseOut=new e.EventEmitter,this.MouseOver=new e.EventEmitter,this.MouseUp=new e.EventEmitter,this.RightClick=new e.EventEmitter,this._id=Mt++}return Object.defineProperty(t.prototype,"AddedToService",{get:function(){return this._addedToService},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"IdAsString",{get:function(){return this._id.toString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"InCustomLayer",{get:function(){return this._inCustomLayer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"LayerId",{get:function(){return this._layerId},enumerable:!1,configurable:!0}),t.prototype.ngAfterContentInit=function(){this._containerRef.element.nativeElement.parentElement&&("x-map-layer"===this._containerRef.element.nativeElement.parentElement.tagName.toLowerCase()&&(this._inCustomLayer=!0,this._layerId=Number(this._containerRef.element.nativeElement.parentElement.attributes.layerId)));this._addedToService||(this._polylineService.AddPolyline(this),this._addedToService=!0,this.AddEventListeners())},t.prototype.ngOnChanges=function(t){if(this._addedToService){var e=this.GeneratePolylineChangeSet(t);null!=e&&this._polylineService.SetOptions(this,e),t.Path&&!t.Path.isFirstChange()&&this._polylineService.UpdatePolyline(this)}},t.prototype.ngOnDestroy=function(){this._polylineService.DeletePolyline(this),this._events.forEach((function(t){return t.unsubscribe()}))},t.prototype.AddEventListeners=function(){var t=this,e=function(e){return{Polyline:t,Click:e}};this._polylineService.CreateEventObservable("click",this).subscribe((function(n){null!=t._infoBox&&t._infoBox.Open(t._polylineService.GetCoordinatesFromClick(n)),t.Click.emit(e(n))})),[{name:"dblclick",handler:function(n){return t.DblClick.emit(e(n))}},{name:"drag",handler:function(n){return t.Drag.emit(e(n))}},{name:"dragend",handler:function(n){return t.DragEnd.emit(e(n))}},{name:"dragstart",handler:function(n){return t.DragStart.emit(e(n))}},{name:"mousedown",handler:function(n){return t.MouseDown.emit(e(n))}},{name:"mousemove",handler:function(n){return t.MouseMove.emit(e(n))}},{name:"mouseout",handler:function(n){return t.MouseOut.emit(e(n))}},{name:"mouseover",handler:function(n){return t.MouseOver.emit(e(n))}},{name:"mouseup",handler:function(n){return t.MouseUp.emit(e(n))}},{name:"rightclick",handler:function(n){return t.RightClick.emit(e(n))}}].forEach((function(e){var n=t._polylineService.CreateEventObservable(e.name,t).subscribe(e.handler);t._events.push(n)}))},t.prototype.GeneratePolylineChangeSet=function(t){var e={id:this._id},n=!1;return t.Clickable&&(e.clickable=this.Clickable,n=!0),t.Draggable&&(e.draggable=this.Draggable,n=!0),t.Editable&&(e.editable=this.Editable,n=!0),t.Geodesic&&(e.geodesic=this.Geodesic,n=!0),t.ShowTooltip&&(e.showTooltip=this.ShowTooltip,n=!0),t.StrokeColor&&(e.strokeColor=this.StrokeColor,n=!0),t.StrokeOpacity&&(e.strokeOpacity=this.StrokeOpacity,n=!0),t.StrokeWeight&&(e.strokeWeight=this.StrokeWeight,n=!0),t.Title&&(e.title=this.Title,n=!0),t.Visible&&(e.visible=this.Visible,n=!0),t.zIndex&&(e.zIndex=this.zIndex,n=!0),n?e:null},t}();Ct.decorators=[{type:e.Directive,args:[{selector:"x-map-polyline"}]}],Ct.ctorParameters=function(){return[{type:et},{type:e.ViewContainerRef}]},Ct.propDecorators={_infoBox:[{type:e.ContentChild,args:[rt]}],Clickable:[{type:e.Input}],Draggable:[{type:e.Input}],Editable:[{type:e.Input}],Geodesic:[{type:e.Input}],Metadata:[{type:e.Input}],Path:[{type:e.Input}],ShowTooltip:[{type:e.Input}],StrokeColor:[{type:e.Input}],StrokeOpacity:[{type:e.Input}],StrokeWeight:[{type:e.Input}],Title:[{type:e.Input}],Visible:[{type:e.Input}],zIndex:[{type:e.Input}],Click:[{type:e.Output}],DblClick:[{type:e.Output}],Drag:[{type:e.Output}],DragEnd:[{type:e.Output}],DragStart:[{type:e.Output}],MouseDown:[{type:e.Output}],MouseMove:[{type:e.Output}],MouseOut:[{type:e.Output}],MouseOver:[{type:e.Output}],MouseUp:[{type:e.Output}],RightClick:[{type:e.Output}]};var kt=1e6,St=function(){function n(n,i,o,r,a){this._markerService=n,this._layerService=i,this._clusterService=o,this._mapService=r,this._zone=a,this._useDynamicSizeMarker=!1,this._dynamicMarkerBaseSize=18,this._dynamicMarkerRanges=new Map([[10,"rgba(20, 180, 20, 0.5)"],[100,"rgba(255, 210, 40, 0.5)"],[Number.MAX_SAFE_INTEGER,"rgba(255, 40, 40, 0.5)"]]),this._streaming=!1,this._markers=new Array,this._markersLast=new Array,this.ClusterClickAction=t.ClusterClickAction.ZoomIntoCluster,this.ClusterPlacementMode=t.ClusterPlacementMode.MeanValue,this.EnableClustering=!1,this.GridSize=150,this.LayerOffset=null,this.ZIndex=0,this.ZoomOnClick=!0,this.DynamicMarkerCreated=new e.EventEmitter,this.MarkerClick=new e.EventEmitter,this.DragEnd=new e.EventEmitter,this._id=kt++}return Object.defineProperty(n.prototype,"CustomMarkerCallback",{get:function(){return this._iconCreationCallback},set:function(t){if(this._useDynamicSizeMarker)throw new Error("You cannot set a custom marker callback when UseDynamicSizeMarkers is set to true.\n                    Set UseDynamicSizeMakers to false.");this._iconCreationCallback=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"DynamicMarkerBaseSize",{get:function(){return this._dynamicMarkerBaseSize},set:function(t){this._dynamicMarkerBaseSize=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"DynamicMarkerRanges",{get:function(){return this._dynamicMarkerRanges},set:function(t){this._dynamicMarkerRanges=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"MarkerOptions",{get:function(){return this._markers},set:function(t){var e,n;this._streaming?((e=this._markersLast).push.apply(e,m(t.slice(0))),(n=this._markers).push.apply(n,m(t))):this._markers=t.slice(0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Styles",{get:function(){return this._styles},set:function(t){this._styles=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"TreatNewMarkerOptionsAsStream",{get:function(){return this._streaming},set:function(t){this._streaming=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"UseDynamicSizeMarkers",{get:function(){return this._useDynamicSizeMarker},set:function(t){var e=this;this._useDynamicSizeMarker=t,t&&(this._iconCreationCallback=function(t,n){return vt.CreateDynamicSizeMarker(t.length,n,e._dynamicMarkerBaseSize,e._dynamicMarkerRanges)})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Id",{get:function(){return this._id},enumerable:!1,configurable:!0}),n.prototype.LocationToPixel=function(t){return this._markerService.LocationToPoint(t)},n.prototype.ngAfterContentInit=function(){var t=this;this._id;this._zone.runOutsideAngular((function(){var e={Id:t._id,Visible:t.Visible};t.EnableClustering?(e.LayerOffset=t.LayerOffset,e.ZIndex=t.ZIndex,e.ClusteringEnabled=t.EnableClustering,e.ClusterPlacementMode=t.ClusterPlacementMode,e.GridSize=t.GridSize,e.ClusterClickAction=t.ClusterClickAction,e.IconInfo=t.ClusterIconInfo,e.CustomMarkerCallback=t.CustomMarkerCallback,e.UseDynamicSizeMarkers=t.UseDynamicSizeMarkers,t._clusterService.AddLayer(e),t._layerPromise=t._clusterService.GetNativeLayer(e),t._service=t._clusterService):(t._layerService.AddLayer(e),t._layerPromise=t._layerService.GetNativeLayer(e),t._service=t._layerService),t._layerPromise.then((function(e){e.SetVisible(t.Visible),t.MarkerOptions&&t._zone.runOutsideAngular((function(){return t.UpdateMarkers()}))}))}))},n.prototype.ngOnDestroy=function(){this._layerPromise.then((function(t){t.Delete()}))},n.prototype.ngOnChanges=function(e){var n=this,i=!1,o={id:this._id};if(e.MarkerOptions&&this._zone.runOutsideAngular((function(){n.UpdateMarkers()})),e.Visible&&!e.Visible.firstChange&&this._zone.runOutsideAngular((function(){n._layerPromise.then((function(t){return t.SetVisible(n.Visible)}))})),e.EnableClustering&&!e.EnableClustering.firstChange){if(!("StopClustering"in this._service))throw new Error("You cannot change EnableClustering after the layer has been created.");o.clusteringEnabled=this.EnableClustering,i=!0}if(e.ClusterPlacementMode&&!e.ClusterPlacementMode.firstChange&&"StopClustering"in this._service&&(o.placementMode=this.ClusterPlacementMode,i=!0),e.GridSize&&!e.GridSize.firstChange&&"StopClustering"in this._service&&(o.gridSize=this.GridSize,i=!0),e.ClusterClickAction&&!e.ClusterClickAction.firstChange&&"StopClustering"in this._service&&(o.zoomOnClick=this.ClusterClickAction===t.ClusterClickAction.ZoomIntoCluster,i=!0),e.ZIndex&&!e.ZIndex.firstChange||e.LayerOffset&&!e.LayerOffset.firstChange||e.IconInfo&&!e.IconInfo.firstChange)throw new Error("You cannot change ZIndex or LayerOffset after the layer has been created.");i&&this._zone.runOutsideAngular((function(){n._id;n._layerPromise.then((function(t){return t.SetOptions(o)}))}))},n.prototype.toString=function(){return"MapMarkerLayer-"+this._id.toString()},n.prototype.AddEventListeners=function(t){var e=this;t.AddListener("click",(function(n){return e.MarkerClick.emit({Marker:t,Click:n,Location:e._markerService.GetCoordinatesFromClick(n),Pixels:e._markerService.GetPixelsFromClick(n)})})),t.AddListener("dragend",(function(n){return e.DragEnd.emit({Marker:t,Click:n,Location:e._markerService.GetCoordinatesFromClick(n),Pixels:e._markerService.GetPixelsFromClick(n)})}))},n.prototype.UpdateMarkers=function(){var t=this;null!=this._layerPromise&&this._layerPromise.then((function(e){var n=t._streaming?t._markersLast.splice(0):t._markers;t._service.CreateMarkers(n,t.IconInfo).then((function(n){n.forEach((function(e){t.AddEventListeners(e)})),t._streaming?e.AddEntities(n):e.SetEntities(n)}))}))},n}();St.decorators=[{type:e.Directive,args:[{selector:"x-map-marker-layer"}]}],St.ctorParameters=function(){return[{type:J},{type:$},{type:nt},{type:X},{type:e.NgZone}]},St.propDecorators={ClusterClickAction:[{type:e.Input}],ClusterIconInfo:[{type:e.Input}],ClusterPlacementMode:[{type:e.Input}],CustomMarkerCallback:[{type:e.Input}],DynamicMarkerBaseSize:[{type:e.Input}],DynamicMarkerRanges:[{type:e.Input}],EnableClustering:[{type:e.Input}],GridSize:[{type:e.Input}],IconInfo:[{type:e.Input}],LayerOffset:[{type:e.Input}],MarkerOptions:[{type:e.Input}],Styles:[{type:e.Input}],TreatNewMarkerOptionsAsStream:[{type:e.Input}],UseDynamicSizeMarkers:[{type:e.Input}],Visible:[{type:e.Input}],ZIndex:[{type:e.Input}],ZoomOnClick:[{type:e.Input}],DynamicMarkerCreated:[{type:e.Output}],MarkerClick:[{type:e.Output}],DragEnd:[{type:e.Output}]};var Ot=1e6,Pt=function(){function t(t,n,i){this._layerService=t,this._mapService=n,this._zone=i,this._labels=new Array,this._tooltipSubscriptions=new Array,this._tooltipVisible=!1,this._defaultOptions={fontSize:11,fontFamily:"sans-serif",strokeWeight:2,strokeColor:"#000000",fontColor:"#ffffff"},this._streaming=!1,this._polygons=new Array,this._polygonsLast=new Array,this.LabelMaxZoom=Number.MAX_SAFE_INTEGER,this.LabelMinZoom=-1,this.LayerOffset=null,this.ShowLabels=!1,this.ShowTooltips=!0,this.ZIndex=0,this.PolygonClick=new e.EventEmitter,this.PolygonDblClick=new e.EventEmitter,this.PolygonMouseMove=new e.EventEmitter,this.PolygonMouseOut=new e.EventEmitter,this.PolygonMouseOver=new e.EventEmitter,this._id=Ot++}return Object.defineProperty(t.prototype,"PolygonOptions",{get:function(){return this._polygons},set:function(t){var e,n;this._streaming?((e=this._polygonsLast).push.apply(e,m(t.slice(0))),(n=this._polygons).push.apply(n,m(t))):this._polygons=t.slice(0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"TreatNewPolygonOptionsAsStream",{get:function(){return this._streaming},set:function(t){this._streaming=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Id",{get:function(){return this._id},enumerable:!1,configurable:!0}),t.prototype.ngAfterContentInit=function(){var t=this;this._id;this._zone.runOutsideAngular((function(){var e={Id:t._id,Visible:t.Visible,LayerOffset:t.LayerOffset,ZIndex:t.ZIndex};t._layerService.AddLayer(e),t._layerPromise=t._layerService.GetNativeLayer(e),Promise.all([t._layerPromise,t._mapService.CreateCanvasOverlay((function(e){return t.DrawLabels(e)}))]).then((function(e){e[0].SetVisible(t.Visible),t._canvas=e[1],t._canvas._canvasReady.then((function(e){t._tooltip=t._canvas.GetToolTipOverlay(),t.ManageTooltip(t.ShowTooltips)})),t.PolygonOptions&&t._zone.runOutsideAngular((function(){return t.UpdatePolygons()}))})),t._service=t._layerService}))},t.prototype.ngOnDestroy=function(){this._tooltipSubscriptions.forEach((function(t){return t.unsubscribe()})),this._layerPromise.then((function(t){t.Delete()})),this._canvas&&this._canvas.Delete()},t.prototype.ngOnChanges=function(t){var e=this;if(t.PolygonOptions&&this._zone.runOutsideAngular((function(){e.UpdatePolygons()})),t.Visible&&!t.Visible.firstChange&&this._layerPromise.then((function(t){return t.SetVisible(e.Visible)})),t.ZIndex&&!t.ZIndex.firstChange||t.LayerOffset&&!t.LayerOffset.firstChange)throw new Error("You cannot change ZIndex or LayerOffset after the layer has been created.");(t.ShowLabels&&!t.ShowLabels.firstChange||t.LabelMinZoom&&!t.LabelMinZoom.firstChange||t.LabelMaxZoom&&!t.LabelMaxZoom.firstChange)&&this._canvas&&this._canvas.Redraw(!0),t.ShowTooltips&&this._tooltip&&this.ManageTooltip(t.ShowTooltips.currentValue)},t.prototype.toString=function(){return"MapPolygonLayer-"+this._id.toString()},t.prototype.AddEventListeners=function(t){var e=this;[{name:"click",handler:function(n){return e.PolygonClick.emit({Polygon:t,Click:n})}},{name:"dblclick",handler:function(n){return e.PolygonDblClick.emit({Polygon:t,Click:n})}},{name:"mousemove",handler:function(n){return e.PolygonMouseMove.emit({Polygon:t,Click:n})}},{name:"mouseout",handler:function(n){return e.PolygonMouseOut.emit({Polygon:t,Click:n})}},{name:"mouseover",handler:function(n){return e.PolygonMouseOver.emit({Polygon:t,Click:n})}}].forEach((function(e){return t.AddListener(e.name,e.handler)}))},t.prototype.DrawLabels=function(t){var e=this;this.ShowLabels&&this._mapService.GetZoom().then((function(n){if(e.LabelMinZoom<=n&&e.LabelMaxZoom>=n){var i=t.getContext("2d"),o=e._labels.map((function(t){return t.title}));e._mapService.LocationsToPoints(e._labels.map((function(t){return t.loc}))).then((function(t){for(var n=e._mapService.MapSize,r=0,a=t.length;r<a;r++)t[r].x>=0&&t[r].y>=0&&t[r].x<=n.width&&t[r].y<=n.height&&e.DrawText(i,t[r],o[r])}))}}))},t.prototype.DrawText=function(t,e,n){var i=this.LabelOptions;null==i&&this._tooltip&&(i=this._tooltip.DefaultLabelStyle),null==i&&(i=this._defaultOptions),t.strokeStyle=i.strokeColor,t.font=i.fontSize+"px "+i.fontFamily,t.textAlign="center";var o=i.strokeWeight;n&&o&&o>0&&(t.lineWidth=o,t.strokeText(n,e.x,e.y)),t.fillStyle=i.fontColor,t.fillText(n,e.x,e.y)},t.prototype.ManageTooltip=function(t){var e=this;t&&this._canvas?(this._tooltip.Set("hidden",!0),this._tooltipVisible=!1,this._tooltipSubscriptions.push(this.PolygonMouseMove.asObservable().subscribe((function(t){if(e._tooltipVisible){var n=e._canvas.GetCoordinatesFromClick(t.Click);e._tooltip.Set("position",n)}}))),this._tooltipSubscriptions.push(this.PolygonMouseOver.asObservable().subscribe((function(t){if(t.Polygon.Title&&t.Polygon.Title.length>0){var n=e._canvas.GetCoordinatesFromClick(t.Click);e._tooltip.Set("text",t.Polygon.Title),e._tooltip.Set("position",n),e._tooltipVisible||(e._tooltip.Set("hidden",!1),e._tooltipVisible=!0)}}))),this._tooltipSubscriptions.push(this.PolygonMouseOut.asObservable().subscribe((function(t){e._tooltipVisible&&(e._tooltip.Set("hidden",!0),e._tooltipVisible=!1)})))):(this._tooltipSubscriptions.forEach((function(t){return t.unsubscribe()})),this._tooltipSubscriptions.splice(0),this._tooltip.Set("hidden",!0),this._tooltipVisible=!1)},t.prototype.UpdatePolygons=function(){var t=this;null!=this._layerPromise&&this._layerPromise.then((function(e){var n=t._streaming?t._polygonsLast.splice(0):t._polygons;t._streaming||t._labels.splice(0),t._service.CreatePolygons(e.GetOptions().id,n).then((function(n){n.forEach((function(e){null!=e.Title&&e.Title.length>0&&t._labels.push({loc:e.Centroid,title:e.Title}),t.AddEventListeners(e)})),t._streaming?e.AddEntities(n):e.SetEntities(n),t._canvas&&t._canvas.Redraw(!t._streaming)}))}))},t}();Pt.decorators=[{type:e.Directive,args:[{selector:"x-map-polygon-layer"}]}],Pt.ctorParameters=function(){return[{type:$},{type:X},{type:e.NgZone}]},Pt.propDecorators={LabelMaxZoom:[{type:e.Input}],LabelMinZoom:[{type:e.Input}],LabelOptions:[{type:e.Input}],LayerOffset:[{type:e.Input}],PolygonOptions:[{type:e.Input}],ShowLabels:[{type:e.Input}],ShowTooltips:[{type:e.Input}],TreatNewPolygonOptionsAsStream:[{type:e.Input}],Visible:[{type:e.Input}],ZIndex:[{type:e.Input}],PolygonClick:[{type:e.Output}],PolygonDblClick:[{type:e.Output}],PolygonMouseMove:[{type:e.Output}],PolygonMouseOut:[{type:e.Output}],PolygonMouseOver:[{type:e.Output}]};var wt=1e6,Lt=function(){function t(t,n,i){this._layerService=t,this._mapService=n,this._zone=i,this._labels=new Array,this._tooltipSubscriptions=new Array,this._tooltipVisible=!1,this._defaultOptions={fontSize:11,fontFamily:"sans-serif",strokeWeight:2,strokeColor:"#000000",fontColor:"#ffffff"},this._streaming=!1,this._polylines=new Array,this._polylinesLast=new Array,this.LabelMaxZoom=Number.MAX_SAFE_INTEGER,this.LabelMinZoom=-1,this.LayerOffset=null,this.ShowLabels=!1,this.ShowTooltips=!0,this.ZIndex=0,this.PolylineClick=new e.EventEmitter,this.PolylineDblClick=new e.EventEmitter,this.PolylineMouseMove=new e.EventEmitter,this.PolylineMouseOut=new e.EventEmitter,this.PolylineMouseOver=new e.EventEmitter,this._id=wt++}return Object.defineProperty(t.prototype,"PolylineOptions",{get:function(){return this._polylines},set:function(t){var e,n;this._streaming?((e=this._polylinesLast).push.apply(e,m(t.slice(0))),(n=this._polylines).push.apply(n,m(t))):this._polylines=t.slice(0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"TreatNewPolylineOptionsAsStream",{get:function(){return this._streaming},set:function(t){this._streaming=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Id",{get:function(){return this._id},enumerable:!1,configurable:!0}),t.prototype.ngAfterContentInit=function(){var t=this;this._id;this._zone.runOutsideAngular((function(){var e={Id:t._id,Visible:t.Visible,LayerOffset:t.LayerOffset,ZIndex:t.ZIndex};t._layerService.AddLayer(e),t._layerPromise=t._layerService.GetNativeLayer(e),Promise.all([t._layerPromise,t._mapService.CreateCanvasOverlay((function(e){return t.DrawLabels(e)}))]).then((function(e){e[0].SetVisible(t.Visible),t._canvas=e[1],t._canvas._canvasReady.then((function(e){t._tooltip=t._canvas.GetToolTipOverlay(),t.ManageTooltip(t.ShowTooltips)})),t.PolylineOptions&&t._zone.runOutsideAngular((function(){return t.UpdatePolylines()}))})),t._service=t._layerService}))},t.prototype.ngOnDestroy=function(){this._tooltipSubscriptions.forEach((function(t){return t.unsubscribe()})),this._layerPromise.then((function(t){t.Delete()})),this._canvas&&this._canvas.Delete()},t.prototype.ngOnChanges=function(t){var e=this;if(t.PolylineOptions&&this._zone.runOutsideAngular((function(){e.UpdatePolylines()})),t.Visible&&!t.Visible.firstChange&&this._layerPromise.then((function(t){return t.SetVisible(e.Visible)})),t.ZIndex&&!t.ZIndex.firstChange||t.LayerOffset&&!t.LayerOffset.firstChange)throw new Error("You cannot change ZIndex or LayerOffset after the layer has been created.");(t.ShowLabels&&!t.ShowLabels.firstChange||t.LabelMinZoom&&!t.LabelMinZoom.firstChange||t.LabelMaxZoom&&!t.LabelMaxZoom.firstChange)&&this._canvas&&this._canvas.Redraw(!0),t.ShowTooltips&&this._tooltip&&this.ManageTooltip(t.ShowTooltips.currentValue)},t.prototype.toString=function(){return"MapPolylineLayer-"+this._id.toString()},t.prototype.AddEventListeners=function(t){var e=this;[{name:"click",handler:function(n){return e.PolylineClick.emit({Polyline:t,Click:n})}},{name:"dblclick",handler:function(n){return e.PolylineDblClick.emit({Polyline:t,Click:n})}},{name:"mousemove",handler:function(n){return e.PolylineMouseMove.emit({Polyline:t,Click:n})}},{name:"mouseout",handler:function(n){return e.PolylineMouseOut.emit({Polyline:t,Click:n})}},{name:"mouseover",handler:function(n){return e.PolylineMouseOver.emit({Polyline:t,Click:n})}}].forEach((function(e){return t.AddListener(e.name,e.handler)}))},t.prototype.DrawLabels=function(t){var e=this;this.ShowLabels&&this._mapService.GetZoom().then((function(n){if(e.LabelMinZoom<=n&&e.LabelMaxZoom>=n){var i=t.getContext("2d"),o=e._labels.map((function(t){return t.title}));e._mapService.LocationsToPoints(e._labels.map((function(t){return t.loc}))).then((function(t){for(var n=e._mapService.MapSize,r=0,a=t.length;r<a;r++)t[r].x>=0&&t[r].y>=0&&t[r].x<=n.width&&t[r].y<=n.height&&e.DrawText(i,t[r],o[r])}))}}))},t.prototype.DrawText=function(t,e,n){var i=this.LabelOptions;null==i&&this._tooltip&&(i=this._tooltip.DefaultLabelStyle),null==i&&(i=this._defaultOptions),t.strokeStyle=i.strokeColor,t.font=i.fontSize+"px "+i.fontFamily,t.textAlign="center";var o=i.strokeWeight;n&&o&&o>0&&(t.lineWidth=o,t.strokeText(n,e.x,e.y)),t.fillStyle=i.fontColor,t.fillText(n,e.x,e.y)},t.prototype.ManageTooltip=function(t){var e=this;t&&this._canvas?(this._tooltip.Set("hidden",!0),this._tooltipVisible=!1,this._tooltipSubscriptions.push(this.PolylineMouseMove.asObservable().subscribe((function(t){if(e._tooltipVisible){var n=e._canvas.GetCoordinatesFromClick(t.Click);e._tooltip.Set("position",n)}}))),this._tooltipSubscriptions.push(this.PolylineMouseOver.asObservable().subscribe((function(t){if(t.Polyline.Title&&t.Polyline.Title.length>0){var n=e._canvas.GetCoordinatesFromClick(t.Click);e._tooltip.Set("text",t.Polyline.Title),e._tooltip.Set("position",n),e._tooltipVisible||(e._tooltip.Set("hidden",!1),e._tooltipVisible=!0)}}))),this._tooltipSubscriptions.push(this.PolylineMouseOut.asObservable().subscribe((function(t){e._tooltipVisible&&(e._tooltip.Set("hidden",!0),e._tooltipVisible=!1)})))):(this._tooltipSubscriptions.forEach((function(t){return t.unsubscribe()})),this._tooltipSubscriptions.splice(0),this._tooltip.Set("hidden",!0),this._tooltipVisible=!1)},t.prototype.UpdatePolylines=function(){var t=this;null!=this._layerPromise&&this._layerPromise.then((function(e){var n=t._streaming?t._polylinesLast.splice(0):t._polylines;t._streaming||t._labels.splice(0),t._service.CreatePolylines(e.GetOptions().id,n).then((function(n){var i=new Array;n.forEach((function(e){if(Array.isArray(e)){var n="",o=new Array;e.forEach((function(e){i.push(e),t.AddEventListeners(e),o.push(e.Centroid),null!=e.Title&&e.Title.length>0&&0===n.length&&(n=e.Title)})),t._labels.push({loc:p.GetPolylineCentroid(o),title:n})}else i.push(e),null!=e.Title&&e.Title.length>0&&t._labels.push({loc:e.Centroid,title:e.Title}),t.AddEventListeners(e)})),t._streaming?e.AddEntities(i):e.SetEntities(i),t._canvas&&t._canvas.Redraw(!t._streaming)}))}))},t}();Lt.decorators=[{type:e.Directive,args:[{selector:"x-map-polyline-layer"}]}],Lt.ctorParameters=function(){return[{type:$},{type:X},{type:e.NgZone}]},Lt.propDecorators={LabelMaxZoom:[{type:e.Input}],LabelMinZoom:[{type:e.Input}],LabelOptions:[{type:e.Input}],LayerOffset:[{type:e.Input}],PolylineOptions:[{type:e.Input}],ShowLabels:[{type:e.Input}],ShowTooltips:[{type:e.Input}],TreatNewPolylineOptionsAsStream:[{type:e.Input}],Visible:[{type:e.Input}],ZIndex:[{type:e.Input}],PolylineClick:[{type:e.Output}],PolylineDblClick:[{type:e.Output}],PolylineMouseMove:[{type:e.Output}],PolylineMouseOut:[{type:e.Output}],PolylineMouseOver:[{type:e.Output}]};var It=function(){};It.decorators=[{type:e.Injectable}];var Et=function(){function t(){}return Object.defineProperty(t.prototype,"IsAvailable",{get:function(){return!("undefined"==typeof document)},enumerable:!1,configurable:!0}),t.prototype.GetNativeDocument=function(){return"undefined"==typeof document?null:document},t}();Et.decorators=[{type:e.Injectable}];var Tt,xt=function(){function t(){}return Object.defineProperty(t.prototype,"IsAvailable",{get:function(){return!("undefined"==typeof window)},enumerable:!1,configurable:!0}),t.prototype.GetNativeWindow=function(){return"undefined"==typeof window?null:window},t}();xt.decorators=[{type:e.Injectable}],function(t){t[t.HTTP=0]="HTTP",t[t.HTTPS=1]="HTTPS",t[t.AUTO=2]="AUTO"}(Tt||(Tt={}));var At=function(){this.apiKey="",this.hostAndPath="www.bing.com/api/maps/mapcontrol",this.protocol=Tt.HTTPS,this.branch=""};At.decorators=[{type:e.Injectable}];var zt=new At,Dt=function(t){function e(e,n,i){var o=t.call(this)||this;return o._config=e,o._windowRef=n,o._documentRef=i,null!==o._config&&void 0!==o._config||(o._config=zt),o}return f(e,t),Object.defineProperty(e.prototype,"Config",{get:function(){return this._config},enumerable:!1,configurable:!0}),e.prototype.Load=function(){var t=this;if(this._scriptLoadingPromise)return this._scriptLoadingPromise;var e=this._documentRef.GetNativeDocument().createElement("script");e.type="text/javascript",e.async=!0,e.defer=!0;var n="angular2bingmaps"+(new Date).getMilliseconds();return e.src=this.GetScriptSrc(n),this._scriptLoadingPromise=new Promise((function(i,o){t._windowRef.GetNativeWindow()[n]=function(){i()},e.onerror=function(t){o(t)}})),this._documentRef.GetNativeDocument().head.appendChild(e),this._scriptLoadingPromise},e.prototype.GetScriptSrc=function(t){var e;switch(this._config&&this._config.protocol||zt.protocol){case Tt.AUTO:e="";break;case Tt.HTTP:e="http:";break;case Tt.HTTPS:e="https:"}var n=this._config.hostAndPath||zt.hostAndPath,i={callback:t};return""!==this._config.branch&&(i.branch=this._config.branch),e+"//"+n+Object.keys(i).map((function(t,e){return(0===e?"?":"&")+(t+"=")+i[t]})).join("")},e}(It);Dt.decorators=[{type:e.Injectable}],Dt.ctorParameters=function(){return[{type:At,decorators:[{type:e.Optional}]},{type:xt},{type:Et}]};var Gt=function(){function t(t,e){this._mapService=t,this._zone=e,this._boxes=new Map}return t.prototype.AddInfoWindow=function(t){var e={};"number"==typeof t.Latitude&&"number"==typeof t.Longitude&&(e.position={latitude:t.Latitude,longitude:t.Longitude}),void 0!==t.InfoWindowActions&&t.InfoWindowActions.length>0&&(e.actions=[],t.InfoWindowActions.forEach((function(t){e.actions.push({label:t.Label,eventHandler:function(){t.ActionClicked.emit(null)}})}))),""!==t.HtmlContent?e.htmlContent=t.HtmlContent:(e.title=t.Title,e.description=t.Description),(t.xOffset||t.yOffset)&&(null==e.pixelOffset&&(e.pixelOffset={x:0,y:0}),t.xOffset&&(e.pixelOffset.x=t.xOffset),t.yOffset&&(e.pixelOffset.y=t.yOffset)),e.visible=t.Visible;var n=this._mapService.CreateInfoWindow(e);this._boxes.set(t,n)},t.prototype.Close=function(t){return this._boxes.get(t).then((function(t){return t.Close()}))},t.prototype.CreateEventObservable=function(t,e){var n=this,i=j[t];return r.Observable.create((function(t){n._boxes.get(e).then((function(e){e.AddListener(i,(function(e){return n._zone.run((function(){return t.next(e)}))}))}))}))},t.prototype.DeleteInfoWindow=function(t){var e=this,n=this._boxes.get(t);return null==n?Promise.resolve():n.then((function(n){return e._zone.run((function(){n.Close(),e._boxes.delete(t)}))}))},t.prototype.Open=function(t,e){return(t.CloseInfoBoxesOnOpen||t.Modal)&&this._boxes.forEach((function(e,n){t.Id!==n.Id&&e.then((function(t){t.IsOpen&&(t.Close(),n.Close())}))})),this._boxes.get(t).then((function(n){var i={};""!==t.HtmlContent?i.htmlContent=t.HtmlContent:(i.title=t.Title,i.description=t.Description),n.SetOptions(i),t.Latitude&&t.Longitude?n.SetPosition({latitude:t.Latitude,longitude:t.Longitude}):e?n.SetPosition(e):t.HostMarker&&n.SetPosition({latitude:t.HostMarker.Latitude,longitude:t.HostMarker.Longitude}),n.Open()}))},t.prototype.SetOptions=function(t,e){return this._boxes.get(t).then((function(t){return t.SetOptions(e)}))},t.prototype.SetPosition=function(t){return this._boxes.get(t).then((function(e){return e.SetPosition({latitude:t.Latitude,longitude:t.Longitude})}))},t}();Gt.decorators=[{type:e.Injectable}],Gt.ctorParameters=function(){return[{type:X},{type:e.NgZone}]};var Nt=function(){function t(t,e,n,i){this._mapService=t,this._layerService=e,this._clusterService=n,this._zone=i,this._markers=new Map}return t.prototype.AddMarker=function(t){var e={position:{latitude:t.Latitude,longitude:t.Longitude},title:t.Title,label:t.Label,draggable:t.Draggable,icon:t.IconUrl,iconInfo:t.IconInfo,isFirst:t.IsFirstInSet,isLast:t.IsLastInSet};t.Width&&(e.width=t.Width),t.Height&&(e.height=t.Height),t.Anchor&&(e.anchor=t.Anchor),t.Metadata&&(e.metadata=t.Metadata);var n=null;n=t.InClusterLayer?this._clusterService.CreateMarker(t.LayerId,e):t.InCustomLayer?this._layerService.CreateMarker(t.LayerId,e):this._mapService.CreateMarker(e),this._markers.set(t,n),t.IconInfo&&n.then((function(n){t.DynamicMarkerCreated.emit(e.iconInfo);var i={x:e.iconInfo.size&&e.iconInfo.markerOffsetRatio?e.iconInfo.size.width*e.iconInfo.markerOffsetRatio.x:0,y:e.iconInfo.size&&e.iconInfo.markerOffsetRatio?e.iconInfo.size.height*e.iconInfo.markerOffsetRatio.y:0};n.SetAnchor(i)}))},t.prototype.CreateEventObservable=function(t,e){var n=this,i=new r.Subject;return"mousemove"===t||"rightclick"===t?i.asObservable():r.Observable.create((function(i){n._markers.get(e).then((function(e){e.AddListener(t,(function(t){return n._zone.run((function(){return i.next(t)}))}))}))}))},t.prototype.DeleteMarker=function(t){var e=this,n=this._markers.get(t),i=Promise.resolve();return null!=n&&(i=n.then((function(n){return t.InClusterLayer&&e._clusterService.GetNativeLayer(t.LayerId).then((function(t){t.RemoveEntity(n)})),t.InCustomLayer&&e._layerService.GetNativeLayer(t.LayerId).then((function(t){t.RemoveEntity(n)})),e._zone.run((function(){n.DeleteMarker(),e._markers.delete(t)}))}))),i},t.prototype.GetCoordinatesFromClick=function(t){if(!t)return null;if(!t.primitive)return null;if(!(t.primitive instanceof Microsoft.Maps.Pushpin))return null;var e=t.primitive.getLocation();return{latitude:e.latitude,longitude:e.longitude}},t.prototype.GetNativeMarker=function(t){return this._markers.get(t)},t.prototype.GetPixelsFromClick=function(t){var e=this.GetCoordinatesFromClick(t);if(null==e)return null;var n=k.TranslateLocation(e),i=this._mapService.MapInstance.tryLocationToPixel(n,Microsoft.Maps.PixelReference.control);return null==i?null:{x:i.x,y:i.y}},t.prototype.LocationToPoint=function(t){var e=this;return null==t?Promise.resolve(null):t instanceof st?this._markers.get(t).then((function(t){var n=t.Location;return e._mapService.LocationToPoint(n)})):this._mapService.LocationToPoint(t)},t.prototype.UpdateAnchor=function(t){return this._markers.get(t).then((function(e){e.SetAnchor(t.Anchor)}))},t.prototype.UpdateDraggable=function(t){return this._markers.get(t).then((function(e){return e.SetDraggable(t.Draggable)}))},t.prototype.UpdateIcon=function(t){var e=function(e,n,i){n&&""!==n&&(e.SetIcon(n),t.DynamicMarkerCreated.emit(i))};return this._markers.get(t).then((function(n){if(t.IconInfo){var i=l.CreateMarker(t.IconInfo);return"string"==typeof i?e(n,i,t.IconInfo):i.then((function(t){return e(n,t.icon,t.iconInfo)}))}return n.SetIcon(t.IconUrl)}))},t.prototype.UpdateLabel=function(t){return this._markers.get(t).then((function(e){e.SetLabel(t.Label)}))},t.prototype.UpdateMarkerPosition=function(t){return this._markers.get(t).then((function(e){return e.SetPosition({latitude:t.Latitude,longitude:t.Longitude})}))},t.prototype.UpdateTitle=function(t){return this._markers.get(t).then((function(e){return e.SetTitle(t.Title)}))},t.prototype.UpdateVisible=function(t){return this._markers.get(t).then((function(e){return e.SetVisible(t.Visible)}))},t}();Nt.decorators=[{type:e.Injectable}],Nt.ctorParameters=function(){return[{type:X},{type:$},{type:nt},{type:e.NgZone}]};var Rt=function(){function t(t,e){var n=this;this._loader=t,this._zone=e,this._modules=new Map,this._map=new Promise((function(t){n._mapResolver=t})),this._config=this._loader.Config}return Object.defineProperty(t.prototype,"LoadedModules",{get:function(){return this._modules},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"MapInstance",{get:function(){return this._mapInstance},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"MapPromise",{get:function(){return this._map},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"MapSize",{get:function(){return this.MapInstance?{width:this.MapInstance.getWidth(),height:this.MapInstance.getHeight()}:null},enumerable:!1,configurable:!0}),t.prototype.CreateCanvasOverlay=function(t){return this._map.then((function(e){var n=new Z(t);return e.layers.insert(n),n}))},t.prototype.CreateClusterLayer=function(t){var e=this;return this._map.then((function(n){return new Promise((function(i){e.LoadModule("Microsoft.Maps.Clustering",(function(){var o,r=k.TranslateClusterOptions(t),a=new Microsoft.Maps.ClusterLayer(new Array,r);n.layers.insert(a),(o=new P(a,e)).SetOptions(t),i(o)}))}))}))},t.prototype.CreateInfoWindow=function(t){return this._map.then((function(e){var n;n=null==t.position?e.getCenter():new Microsoft.Maps.Location(t.position.latitude,t.position.longitude);var i=new Microsoft.Maps.Infobox(n,k.TranslateInfoBoxOptions(t));return i.setMap(e),new w(i)}))},t.prototype.CreateLayer=function(t){var e=this;return this._map.then((function(n){var i=new Microsoft.Maps.Layer(t.id.toString());return n.layers.insert(i),new C(i,e)}))},t.prototype.CreateMap=function(t,e){var n=this;return this._loader.Load().then((function(){new I(T).Extend(new Microsoft.Maps.CustomOverlay).Map("onAdd","OnAdd").Map("onLoad","OnLoad").Map("onRemove","OnRemove"),new I(Z).Extend(new Microsoft.Maps.CustomOverlay).Map("onAdd","OnAdd").Map("onLoad","OnLoad").Map("onRemove","OnRemove"),null!=n._mapInstance&&n.DisposeMap();var i=k.TranslateLoadOptions(e);i.credentials||(i.credentials=n._config.apiKey);var o=new Microsoft.Maps.Map(t,i);n._mapInstance=o,n._mapResolver(o)}))},t.prototype.CreateMarker=function(t){void 0===t&&(t={});var e=function(e,n){var i=k.TranslateLocation(t.position),o=k.TranslateMarkerOptions(t);e&&""!==e&&(o.icon=e);var r=new Microsoft.Maps.Pushpin(i,o),a=new S(r,n,null);return t.metadata&&t.metadata.forEach((function(t,e){return a.Metadata.set(e,t)})),n.entities.push(r),a};return this._map.then((function(n){if(t.iconInfo&&t.iconInfo.markerType){var i=l.CreateMarker(t.iconInfo);return"string"==typeof i?e(i,n):i.then((function(t){return e(t.icon,n)}))}return e(null,n)}))},t.prototype.CreatePolygon=function(t){var e=this;return this._map.then((function(n){var i=k.TranslatePaths(t.paths),o=k.TranslatePolygonOptions(t),r=new Microsoft.Maps.Polygon(i,o);n.entities.push(r);var a=new N(r,e,null);return t.metadata&&t.metadata.forEach((function(t,e){return a.Metadata.set(e,t)})),t.title&&""!==t.title&&(a.Title=t.title),null!=t.showLabel&&(a.ShowLabel=t.showLabel),null!=t.showTooltip&&(a.ShowTooltip=t.showTooltip),null!=t.labelMaxZoom&&(a.LabelMaxZoom=t.labelMaxZoom),null!=t.labelMinZoom&&(a.LabelMinZoom=t.labelMinZoom),t.editable&&a.SetEditable(t.editable),a}))},t.prototype.CreatePolyline=function(t){var e;return this._map.then((function(n){var i=k.TranslatePolylineOptions(t),o=k.TranslatePaths(t.path);if(t.path&&t.path.length>0&&!Array.isArray(t.path[0])){e=new Microsoft.Maps.Polyline(o[0],i),n.entities.push(e);var r=new R(e,n,null);return t.metadata&&t.metadata.forEach((function(t,e){return r.Metadata.set(e,t)})),t.title&&""!==t.title&&(r.Title=t.title),null!=t.showTooltip&&(r.ShowTooltip=t.showTooltip),r}var a=new Array;return o.forEach((function(o){e=new Microsoft.Maps.Polyline(o,i),n.entities.push(e);var r=new R(e,n,null);t.metadata&&t.metadata.forEach((function(t,e){return r.Metadata.set(e,t)})),t.title&&""!==t.title&&(r.Title=t.title),null!=t.showTooltip&&(r.ShowTooltip=t.showTooltip),a.push(r)})),a}))},t.prototype.DeleteLayer=function(t){return this._map.then((function(e){e.layers.remove(t.NativePrimitve)}))},t.prototype.DisposeMap=function(){var t=this;null==this._map&&null==this._mapInstance||null!=this._mapInstance&&(this._mapInstance.dispose(),this._mapInstance=null,this._map=new Promise((function(e){t._mapResolver=e})))},t.prototype.GetCenter=function(){return this._map.then((function(t){var e=t.getCenter();return{latitude:e.latitude,longitude:e.longitude}}))},t.prototype.GetBounds=function(){return this._map.then((function(t){var e=t.getBounds();return{maxLatitude:e.getNorth(),maxLongitude:e.crossesInternationalDateLine()?e.getWest():e.getEast(),minLatitude:e.getSouth(),minLongitude:e.crossesInternationalDateLine()?e.getEast():e.getWest(),center:{latitude:e.center.latitude,longitude:e.center.longitude},padding:0}}))},t.prototype.GetDrawingTools=function(t){var e=this;return void 0===t&&(t=!0),new Promise((function(n,i){e.LoadModuleInstance("Microsoft.Maps.DrawingTools",t).then((function(t){n(t)}))}))},t.prototype.GetZoom=function(){return this._map.then((function(t){return t.getZoom()}))},t.prototype.LoadModule=function(t,e){var n=this;this._modules.has(t)?e():Microsoft.Maps.loadModule(t,(function(){n._modules.set(t,null),e()}))},t.prototype.LoadModuleInstance=function(t,e){var n=this;void 0===e&&(e=!0);var i=t.substr(t.lastIndexOf(".")+1);if(this._modules.has(t)){var o=null;return e?null!=this._modules.get(t)?o=this._modules.get(t):(o=new Microsoft.Maps[i](this._mapInstance),this._modules.set(t,o)):o=new Microsoft.Maps[i](this._mapInstance),Promise.resolve(o)}return new Promise((function(o,r){try{Microsoft.Maps.loadModule(t,(function(){var r=new Microsoft.Maps[i](n._mapInstance);e?n._modules.set(t,r):n._modules.set(t,null),o(r)}))}catch(t){r("Could not load module or create instance.")}}))},t.prototype.LocationToPoint=function(t){return this._map.then((function(e){var n=k.TranslateLocation(t),i=e.tryLocationToPixel(n,Microsoft.Maps.PixelReference.control);return null!=i?{x:i.x,y:i.y}:null}))},t.prototype.LocationsToPoints=function(t){return this._map.then((function(e){var n=t.map((function(t){return k.TranslateLocation(t)})),i=e.tryLocationToPixel(n,Microsoft.Maps.PixelReference.control);return i||new Array}))},t.prototype.SetCenter=function(t){return this._map.then((function(e){return e.setView({center:k.TranslateLocation(t)})}))},t.prototype.SetMapOptions=function(t){this._map.then((function(e){var n=k.TranslateOptions(t);e.setOptions(n)}))},t.prototype.SetViewOptions=function(t){this._map.then((function(e){var n=k.TranslateViewOptions(t);e.setView(n)}))},t.prototype.SetZoom=function(t){return this._map.then((function(e){return e.setView({zoom:t})}))},t.prototype.SubscribeToMapEvent=function(t){var e=this,n=j[t];return r.Observable.create((function(t){e._map.then((function(i){Microsoft.Maps.Events.addHandler(i,n,(function(n){e._zone.run((function(){return t.next(n)}))}))}))}))},t.prototype.TriggerMapEvent=function(t){return this._map.then((function(e){return Microsoft.Maps.Events.invoke(e,t,null)}))},t}();Rt.decorators=[{type:e.Injectable}],Rt.ctorParameters=function(){return[{type:It},{type:e.NgZone}]};var jt=function(){function t(t,e){this._mapService=t,this._zone=e,this._layers=new Map}return t.prototype.CreateMarker=function(t,e){var n=function(t,n){var i=k.TranslateLocation(e.position),o=k.TranslateMarkerOptions(e);t&&""!==t&&(o.icon=t);var r=new Microsoft.Maps.Pushpin(i,o),a=new S(r,null,n.NativePrimitve);return a.IsFirst=e.isFirst,a.IsLast=e.isLast,e.metadata&&e.metadata.forEach((function(t,e){return a.Metadata.set(e,t)})),n.AddEntity(a),a},i=this.GetLayerById(t);if(null==i)throw new Error("Layer with id "+t+" not found in Layer Map");return i.then((function(t){if(e.iconInfo&&e.iconInfo.markerType){var i=l.CreateMarker(e.iconInfo);return"string"==typeof i?n(i,t):i.then((function(e){return n(e.icon,t)}))}return n(null,t)}))},t.prototype.CreateMarkers=function(t,e){var n=function(t,e){return e.map((function(e){var n,i=k.TranslateMarkerOptions(e);t&&""!==t?n=t:i.icon&&(n=i.icon),i.icon&&delete i.icon;var o=k.TranslateLocation(e.position),r=new Microsoft.Maps.Pushpin(o,i),a=l.GetImageForMarker(n);null!=a&&(r.image=a);var s=new S(r,null,null);return s.IsFirst=e.isFirst,s.IsLast=e.isLast,e.metadata&&e.metadata.forEach((function(t,e){return s.Metadata.set(e,t)})),s}))};return new Promise((function(i,o){if(e&&e.markerType){var r=l.CreateMarker(e);if("string"!=typeof r)return r.then((function(e){i(n(e.icon,t))}));i(n(r,t))}else i(n(null,t))}))},t.prototype.DeleteLayer=function(t){var e=this,n=this._layers.get(t.Id);return null==n?Promise.resolve():n.then((function(n){return e._zone.run((function(){n.Delete(),e._layers.delete(t.Id)}))}))},t.prototype.GetNativeLayer=function(t){return"number"==typeof t?this._layers.get(t):this._layers.get(t.Id)},t.prototype.GetLayerById=function(t){var e;return this._layers.forEach((function(n,i){i===t&&(e=n)})),e},t}(),Zt=function(t){function e(e,n){return t.call(this,e,n)||this}return f(e,t),e.prototype.AddLayer=function(t){var e=this._mapService.CreateLayer({id:t.Id});this._layers.set(t.Id,e),e.then((function(e){return e.SetVisible(t.Visible)}))},e.prototype.CreatePolygon=function(t,e){var n=this,i=this.GetLayerById(t);if(null==i)throw new Error("Layer with id "+t+" not found in Layer Map");return i.then((function(t){var i=k.TranslatePaths(e.paths),o=k.TranslatePolygonOptions(e),r=new Microsoft.Maps.Polygon(i,o),a=new N(r,n._mapService,t.NativePrimitve);return e.metadata&&e.metadata.forEach((function(t,e){return a.Metadata.set(e,t)})),e.title&&""!==e.title&&(a.Title=e.title),null!=e.showLabel&&(a.ShowLabel=e.showLabel),null!=e.showTooltip&&(a.ShowTooltip=e.showTooltip),null!=e.labelMaxZoom&&(a.LabelMaxZoom=e.labelMaxZoom),null!=e.labelMinZoom&&(a.LabelMinZoom=e.labelMinZoom),t.AddEntity(a),a}))},e.prototype.CreatePolygons=function(t,e){var n=this,i=this.GetLayerById(t);if(null==i)throw new Error("Layer with id "+t+" not found in Layer Map");return i.then((function(t){return new Promise((function(i,o){i(e.map((function(e){var i=k.TranslatePaths(e.paths),o=k.TranslatePolygonOptions(e),r=new Microsoft.Maps.Polygon(i,o),a=new N(r,n._mapService,t.NativePrimitve);return e.title&&""!==e.title&&(a.Title=e.title),e.metadata&&e.metadata.forEach((function(t,e){return a.Metadata.set(e,t)})),a})))}))}))},e.prototype.CreatePolyline=function(t,e){var n,i,o=this,r=this.GetLayerById(t);if(null==r)throw new Error("Layer with id "+t+" not found in Layer Map");return r.then((function(t){var r=k.TranslatePaths(e.path),a=k.TranslatePolylineOptions(e);if(e.path&&e.path.length>0&&!Array.isArray(e.path[0]))return n=new Microsoft.Maps.Polyline(r[0],a),i=new R(n,o._mapService.MapInstance,t.NativePrimitve),t.AddEntity(i),e.metadata&&e.metadata.forEach((function(t,e){return i.Metadata.set(e,t)})),e.title&&""!==e.title&&(i.Title=e.title),null!=e.showTooltip&&(i.ShowTooltip=e.showTooltip),i;var s=new Array;return r.forEach((function(r){n=new Microsoft.Maps.Polyline(r,a),i=new R(n,o._mapService.MapInstance,t.NativePrimitve),t.AddEntity(i),e.metadata&&e.metadata.forEach((function(t,e){return i.Metadata.set(e,t)})),e.title&&""!==e.title&&(i.Title=e.title),null!=e.showTooltip&&(i.ShowTooltip=e.showTooltip),s.push(i)})),s}))},e.prototype.CreatePolylines=function(t,e){var n=this,i=this.GetLayerById(t);if(null==i)throw new Error("Layer with id "+t+" not found in Layer Map");return i.then((function(t){return new Promise((function(i,o){i(e.map((function(e){var i=k.TranslatePaths(e.path),o=k.TranslatePolylineOptions(e);if(i&&i.length>0&&!Array.isArray(i[0])){var r=new Microsoft.Maps.Polyline(i[0],o),a=new R(r,n._mapService.MapInstance,t.NativePrimitve);return e.title&&""!==e.title&&(a.Title=e.title),e.metadata&&e.metadata.forEach((function(t,e){return a.Metadata.set(e,t)})),a}var s=new Array;return i.forEach((function(i){var r=new Microsoft.Maps.Polyline(i,o),a=new R(r,n._mapService.MapInstance,t.NativePrimitve);e.metadata&&e.metadata.forEach((function(t,e){return a.Metadata.set(e,t)})),e.title&&""!==e.title&&(a.Title=e.title),s.push(a)})),s})))}))}))},e}(jt);Zt.decorators=[{type:e.Injectable}],Zt.ctorParameters=function(){return[{type:X},{type:e.NgZone}]};var Vt=function(e){function n(t,n){return e.call(this,t,n)||this}return f(n,e),n.prototype.AddLayer=function(t){var e=this,n={id:t.Id,visible:t.Visible,clusteringEnabled:t.ClusteringEnabled,placementMode:t.ClusterPlacementMode};t.GridSize&&(n.gridSize=t.GridSize),t.LayerOffset&&(n.layerOffset=t.LayerOffset),t.ZIndex&&(n.zIndex=t.ZIndex),t.IconInfo&&(n.clusteredPinCallback=function(n){e.CreateClusterPushPin(n,t)}),t.CustomMarkerCallback&&(n.clusteredPinCallback=function(n){e.CreateCustomClusterPushPin(n,t)}),t.SpiderClusterOptions&&(n.spiderClusterOptions=t.SpiderClusterOptions);var i=this._mapService.CreateClusterLayer(n);this._mapService.MapPromise.then((function(e){Microsoft.Maps.Events.addHandler(e,"viewchangeend",(function(n){t.ClusteringEnabled&&19===e.getZoom()&&i.then((function(e){e.SetOptions({id:t.Id,clusteringEnabled:!1})})),t.ClusteringEnabled&&e.getZoom()<19&&i.then((function(e){e.GetOptions().clusteringEnabled||e.SetOptions({id:t.Id,clusteringEnabled:!0})}))}))})),this._layers.set(t.Id,i)},n.prototype.CreatePolygon=function(t,e){throw new Error("Polygons are not supported in clustering layers. You can only use markers.")},n.prototype.CreatePolygons=function(t,e){throw new Error("Polygons are not supported in clustering layers. You can only use markers.")},n.prototype.CreatePolyline=function(t,e){throw new Error("Polylines are not supported in clustering layers. You can only use markers.")},n.prototype.CreatePolylines=function(t,e){throw new Error("Polylines are not supported in clustering layers. You can only use markers.")},n.prototype.StartClustering=function(t){var e=this,n=this._layers.get(t.Id);return null==n?Promise.resolve():n.then((function(t){return e._zone.run((function(){t.StartClustering()}))}))},n.prototype.StopClustering=function(t){var e=this,n=this._layers.get(t.Id);return null==n?Promise.resolve():n.then((function(t){return e._zone.run((function(){t.StopClustering()}))}))},n.prototype.CreateClusterPushPin=function(e,n){var i=this;this._layers.get(n.Id).then((function(o){if(n.IconInfo){var r={},a=function(t,n){r.icon=t,r.anchor=new Microsoft.Maps.Point(n.size&&n.markerOffsetRatio?n.size.width*n.markerOffsetRatio.x:0,n.size&&n.markerOffsetRatio?n.size.height*n.markerOffsetRatio.y:0),e.setOptions(r)},s=l.CreateMarker(n.IconInfo);"string"==typeof s?a(s,n.IconInfo):s.then((function(t){a(t.icon,t.iconInfo)}))}n.ClusterClickAction===t.ClusterClickAction.ZoomIntoCluster&&Microsoft.Maps.Events.addHandler(e,"click",(function(t){return i.ZoomIntoCluster(t)})),n.ClusterClickAction===t.ClusterClickAction.Spider&&(Microsoft.Maps.Events.addHandler(e,"dblclick",(function(t){return i.ZoomIntoCluster(t)})),o.InitializeSpiderClusterSupport())}))},n.prototype.CreateCustomClusterPushPin=function(e,n){var i=this;this._layers.get(n.Id).then((function(o){var r=new Array;e.containedPushpins.forEach((function(t){var e=o.GetMarkerFromBingMarker(t);e&&r.push(e)}));var a={markerType:t.MarkerTypeId.None},s={};s.icon=n.CustomMarkerCallback(r,a),""!==s.icon&&(s.anchor=new Microsoft.Maps.Point(a.size&&a.markerOffsetRatio?a.size.width*a.markerOffsetRatio.x:0,a.size&&a.markerOffsetRatio?a.size.height*a.markerOffsetRatio.y:0),a.textOffset&&(s.textOffset=new Microsoft.Maps.Point(a.textOffset.x,a.textOffset.y)),e.setOptions(s)),n.ClusterClickAction===t.ClusterClickAction.ZoomIntoCluster&&Microsoft.Maps.Events.addHandler(e,"click",(function(t){return i.ZoomIntoCluster(t)})),n.ClusterClickAction===t.ClusterClickAction.Spider&&(Microsoft.Maps.Events.addHandler(e,"dblclick",(function(t){return i.ZoomIntoCluster(t)})),o.InitializeSpiderClusterSupport())}))},n.prototype.ZoomIntoCluster=function(t){var e=t.target;if(e&&e.containedPushpins){var n,i=new Array;e.containedPushpins.forEach((function(t){return i.push(t.getLocation())})),n=Microsoft.Maps.LocationRect.fromLocations(i),this._mapService.MapPromise.then((function(t){t.setView({bounds:n,padding:75})}))}},n}(jt);Vt.decorators=[{type:e.Injectable}],Vt.ctorParameters=function(){return[{type:X},{type:e.NgZone}]};var Bt=function(){function t(t,e,n){this._mapService=t,this._layerService=e,this._zone=n,this._polygons=new Map}return t.prototype.AddPolygon=function(t){var e,n={id:t.Id,clickable:t.Clickable,draggable:t.Draggable,editable:t.Editable,fillColor:t.FillColor,fillOpacity:t.FillOpacity,geodesic:t.Geodesic,labelMaxZoom:t.LabelMaxZoom,labelMinZoom:t.LabelMinZoom,paths:t.Paths,showLabel:t.ShowLabel,showTooltip:t.ShowTooltip,strokeColor:t.StrokeColor,strokeOpacity:t.StrokeOpacity,strokeWeight:t.StrokeWeight,title:t.Title,visible:t.Visible,zIndex:t.zIndex};e=t.InCustomLayer?this._layerService.CreatePolygon(t.LayerId,n):this._mapService.CreatePolygon(n),this._polygons.set(t,e)},t.prototype.CreateEventObservable=function(t,e){var n=this,i=new r.Subject;return"mousemove"===t||"rightclick"===t?i.asObservable():r.Observable.create((function(i){n._polygons.get(e).then((function(e){e.AddListener(t,(function(t){return n._zone.run((function(){return i.next(t)}))}))}))}))},t.prototype.DeletePolygon=function(t){var e=this,n=this._polygons.get(t);return null==n?Promise.resolve():n.then((function(n){return e._zone.run((function(){n.Delete(),e._polygons.delete(t)}))}))},t.prototype.GetCoordinatesFromClick=function(t){var e=t;return{latitude:e.location.latitude,longitude:e.location.longitude}},t.prototype.GetNativePolygon=function(t){return this._polygons.get(t)},t.prototype.SetOptions=function(t,e){return this._polygons.get(t).then((function(t){t.SetOptions(e)}))},t.prototype.UpdatePolygon=function(t){var e=this._polygons.get(t);return null!=e&&null!=t.Paths&&Array.isArray(t.Paths)&&0!==t.Paths.length?e.then((function(e){Array.isArray(t.Paths[0])?e.SetPaths(t.Paths):e.SetPath(t.Paths)})):Promise.resolve()},t}();Bt.decorators=[{type:e.Injectable}],Bt.ctorParameters=function(){return[{type:X},{type:$},{type:e.NgZone}]};var Ht=function(){function t(t,e,n){this._mapService=t,this._layerService=e,this._zone=n,this._polylines=new Map}return t.prototype.AddPolyline=function(t){var e,n={id:t.Id,clickable:t.Clickable,draggable:t.Draggable,editable:t.Editable,geodesic:t.Geodesic,path:t.Path,showTooltip:t.ShowTooltip,strokeColor:t.StrokeColor,strokeOpacity:t.StrokeOpacity,strokeWeight:t.StrokeWeight,title:t.Title,visible:t.Visible,zIndex:t.zIndex};e=t.InCustomLayer?this._layerService.CreatePolyline(t.LayerId,n):this._mapService.CreatePolyline(n),this._polylines.set(t,e)},t.prototype.CreateEventObservable=function(t,e){var n=this,i=new r.Subject;return"mousemove"===t||"rightclick"===t?i.asObservable():r.Observable.create((function(i){n._polylines.get(e).then((function(e){(Array.isArray(e)?e:[e]).forEach((function(e){return e.AddListener(t,(function(t){return n._zone.run((function(){return i.next(t)}))}))}))}))}))},t.prototype.DeletePolyline=function(t){var e=this,n=this._polylines.get(t);return null==n?Promise.resolve():n.then((function(n){return e._zone.run((function(){(Array.isArray(n)?n:[n]).forEach((function(t){return t.Delete()})),e._polylines.delete(t)}))}))},t.prototype.GetCoordinatesFromClick=function(t){return t&&t.location?{latitude:t.location.latitude,longitude:t.location.longitude}:null},t.prototype.GetNativePolyline=function(t){return this._polylines.get(t)},t.prototype.SetOptions=function(t,e){return this._polylines.get(t).then((function(t){(Array.isArray(t)?t:[t]).forEach((function(t){return t.SetOptions(e)}))}))},t.prototype.UpdatePolyline=function(t){var e=this,n=this._polylines.get(t);return null==n?Promise.resolve():n.then((function(n){return e._zone.run((function(){var e=Array.isArray(n)?n:[n],i=t.Path.length>0&&Array.isArray(t.Path[0])?t.Path:[t.Path];e.forEach((function(t,e){i.length>e&&t.SetPath(i[e])})),Array.isArray(n)&&n.length>i.length&&n.splice(i.length-1).forEach((function(t){return t.Delete()}))}))}))},t}();Ht.decorators=[{type:e.Injectable}],Ht.ctorParameters=function(){return[{type:X},{type:$},{type:e.NgZone}]};var Ft=function(){function t(t,e){this._loader=t,this._zone=e}return t.prototype.Create=function(){return new Rt(this._loader,this._zone)},t.prototype.CreateClusterService=function(t){return new Vt(t,this._zone)},t.prototype.CreateInfoBoxService=function(t){return new Gt(t,this._zone)},t.prototype.CreateLayerService=function(t){return new Zt(t,this._zone)},t.prototype.CreateMarkerService=function(t,e,n){return new Nt(t,e,n,this._zone)},t.prototype.CreatePolygonService=function(t,e){return new Bt(t,e,this._zone)},t.prototype.CreatePolylineService=function(t,e){return new Ht(t,e,this._zone)},t}();function Wt(t,e){return new Ft(t,e)}function Ut(){return new Dt(new At,new xt,new Et)}Ft.decorators=[{type:e.Injectable}],Ft.ctorParameters=function(){return[{type:It},{type:e.NgZone}]};var qt=function(){function t(t,e){this._mapService=t,this._zone=e}return t.prototype.DeleteLayer=function(t){var e=this,n=this._layers.get(t.Id);return null==n?Promise.resolve():n.then((function(n){return e._zone.run((function(){n.Delete(),e._layers.delete(t.Id)}))}))},t.prototype.GetNativeLayer=function(t){return"number"==typeof t?this._layers.get(t):this._layers.get(t.Id)},t.prototype.CreateMarker=function(t,e){var n=this._mapService.MapPromise,i=this._layers.get(t);return Promise.all([n,i]).then((function(t){var n=y(t,2),i=n[0],o=n[1],r=function(t){var n=new google.maps.Marker(t);e.metadata&&e.metadata.forEach((function(t,e){return n.Metadata.set(e,t)})),n.setMap(i);var r=new H(n);return r.IsFirst=e.isFirst,r.IsLast=e.isLast,e.metadata&&e.metadata.forEach((function(t,e){return r.Metadata.set(e,t)})),o.AddEntity(r),r},a=V.TranslateMarkerOptions(e);if(e.iconInfo&&e.iconInfo.markerType){var s=l.CreateMarker(e.iconInfo);return"string"==typeof s?(a.icon=s,r(a)):s.then((function(t){return a.icon=t.icon,r(a)}))}return r(a)}))},t.prototype.CreateMarkers=function(t,e){var n=function(e){return t.map((function(t){var n=V.TranslateMarkerOptions(t);e&&""!==e&&(n.icon=e);var i=new google.maps.Marker(n),o=new H(i);return o.IsFirst=t.isFirst,o.IsLast=t.isLast,t.metadata&&t.metadata.forEach((function(t,e){return o.Metadata.set(e,t)})),o}))};return new Promise((function(t,i){if(e&&e.markerType){var o=l.CreateMarker(e);if("string"!=typeof o)return o.then((function(e){t(n(e.icon))}));t(n(o))}else t(n(null))}))},t.prototype.GetLayerById=function(t){var e;return this._layers.forEach((function(n,i){i===t&&(e=n)})),e},t}(),Yt=function(e){function n(t,n){var i=e.call(this,t,n)||this;return i._layers=new Map,i._layerStyles=new Map,i}return f(n,e),n.CreateClusterIcons=function(t){return new Promise((function(e,n){var i=new Array;t.forEach((function(t,e){if(t.iconInfo){var n=l.CreateMarker(t.iconInfo);if("string"==typeof n){if(t.url=n,null==t.width&&(t.width=t.iconInfo.size.width,t.height=t.iconInfo.size.height),t.iconInfo.markerOffsetRatio&&t.iconInfo.size&&null==t.anchor){var o=t.iconInfo;t.anchor=[o.size.width*o.markerOffsetRatio.x,o.size.height*o.markerOffsetRatio.y]}delete t.iconInfo}else n.then((function(e){if(t.url=e.icon,null==t.width&&(t.width=e.iconInfo.size.width,t.height=e.iconInfo.size.height),e.iconInfo.markerOffsetRatio&&e.iconInfo.size&&null==t.anchor){var n=e.iconInfo;t.anchor=[n.size.width*n.markerOffsetRatio.x,n.size.height*n.markerOffsetRatio.y]}delete t.iconInfo})),i.push(n)}})),0===i.length?e(t):Promise.all(i).then((function(){e(t)}))}))},n.prototype.AddLayer=function(e){var i=this,o={id:e.Id,visible:e.Visible,clusteringEnabled:e.ClusteringEnabled,zoomOnClick:e.ClusterClickAction===t.ClusterClickAction.ZoomIntoCluster};e.GridSize&&(o.gridSize=e.GridSize),e.MinimumClusterSize&&(o.minimumClusterSize=e.MinimumClusterSize),e.Styles&&(o.styles=e.Styles),e.UseDynamicSizeMarkers?o.styles=null:o.styles=[{height:30,width:35,textColor:"white",textSize:11,backgroundPosition:"center",iconInfo:{markerType:t.MarkerTypeId.FontMarker,fontName:"FontAwesome",fontSize:30,color:"green",text:""}}];var r=function(t){if(i._layerStyles.has(e.Id))i._layerStyles.get(e.Id).splice(0);else{var n=new Array;n.push({}),i._layerStyles.set(e.Id,n),t.setStyles(n)}},a=this._mapService.CreateClusterLayer(o);this._layers.set(e.Id,a),a.then((function(a){var s=a.NativePrimitve;o.styles?n.CreateClusterIcons(o.styles).then((function(t){s.setStyles(t)})):(r(s),i._mapService.MapPromise.then((function(t){t.addListener("zoom_changed",(function(){r(s)}))})),s.setCalculator((function(n,o){return r=n,a=i._layerStyles.get(e.Id),s={markerType:t.MarkerTypeId.None},l=e.CustomMarkerCallback(r,s),a[0]={url:'"data:image/svg+xml;utf8,'+l+'"',height:s.size.height,width:s.size.width,textColor:"white",textSize:11,backgroundPosition:"center"},{text:r.length.toString(),index:1};var r,a,s,l})))}))},n.prototype.CreateMarker=function(t,e){var n=this,i=this.GetLayerById(t);if(null==i)throw new Error("Layer with id "+t+" not found in Layer Map");return i.then((function(t){return n._mapService.CreateMarker(e).then((function(n){return n.IsFirst=e.isFirst,n.IsLast=e.isLast,t.AddEntity(n),n}))}))},n.prototype.StartClustering=function(t){return Promise.resolve()},n.prototype.StopClustering=function(t){return Promise.resolve()},n.prototype.CreatePolygon=function(t,e){throw new Error("Polygons are not supported in clustering layers. You can only use markers.")},n.prototype.CreatePolygons=function(t,e){throw new Error("Polygons are not supported in clustering layers. You can only use markers.")},n.prototype.CreatePolyline=function(t,e){throw new Error("Polylines are not supported in clustering layers. You can only use markers.")},n.prototype.CreatePolylines=function(t,e){throw new Error("Polylines are not supported in clustering layers. You can only use markers.")},n}(qt);Yt.decorators=[{type:e.Injectable}],Yt.ctorParameters=function(){return[{type:X},{type:e.NgZone}]};var Kt=function(t){function e(e,n,i){var o=t.call(this)||this;return o._mapService=e,o._markerService=n,o._zone=i,o._boxes=new Map,o}return f(e,t),e.prototype.AddInfoWindow=function(t){var e={};""!==t.HtmlContent?e.htmlContent=t.HtmlContent:(e.title=t.Title,e.description=t.Description),(t.xOffset||t.yOffset)&&(null==e.pixelOffset&&(e.pixelOffset={x:0,y:0}),t.xOffset&&(e.pixelOffset.x=t.xOffset),t.yOffset&&(e.pixelOffset.y=t.yOffset)),e.disableAutoPan=t.DisableAutoPan,e.visible=t.Visible,"number"==typeof t.Latitude&&"number"==typeof t.Longitude&&(e.position={latitude:t.Latitude,longitude:t.Longitude});var n=this._mapService.CreateInfoWindow(e);this._boxes.set(t,n)},e.prototype.Close=function(t){return this._boxes.get(t).then((function(t){t.Close()}))},e.prototype.CreateEventObservable=function(t,e){var n=this,i=q[t];return r.Observable.create((function(t){n._boxes.get(e).then((function(e){e.AddListener(i,(function(e){return n._zone.run((function(){return t.next(e)}))}))}))}))},e.prototype.DeleteInfoWindow=function(t){return Promise.resolve()},e.prototype.Open=function(t,e){var n=this;return(t.CloseInfoBoxesOnOpen||t.Modal)&&this._boxes.forEach((function(e,n){t.Id!==n.Id&&e.then((function(t){t.IsOpen&&(t.Close(),n.Close())}))})),this._boxes.get(t).then((function(i){var o={};return""!==t.HtmlContent?o.htmlContent=t.HtmlContent:(o.title=t.Title,o.description=t.Description),i.SetOptions(o),null!=t.HostMarker?n._markerService.GetNativeMarker(t.HostMarker).then((function(t){return n._mapService.MapPromise.then((function(e){return i.Open(t.NativePrimitve)}))})):n._mapService.MapPromise.then((function(t){e&&i.SetPosition(e),i.Open()}))}))},e.prototype.SetOptions=function(t,e){return this._boxes.get(t).then((function(t){t.SetOptions(e)}))},e.prototype.SetPosition=function(t,e){return this._boxes.get(t).then((function(t){t.SetPosition(e)})),Promise.resolve()},e}(Q);Kt.decorators=[{type:e.Injectable}],Kt.ctorParameters=function(){return[{type:X},{type:J},{type:e.NgZone}]};var Xt,Jt=function(){function t(t,e,n){this._layer=t,this._maps=e,this._id=n,this._entities=new Array,this._visible=!0}return Object.defineProperty(t.prototype,"NativePrimitve",{get:function(){return this._layer},enumerable:!1,configurable:!0}),t.prototype.AddListener=function(t,e){throw new Error("Events are not supported on Google Layers. You can still add events to individual markers.")},t.prototype.AddEntity=function(t){t.NativePrimitve&&(this._entities.push(t),t.NativePrimitve.setVisible(this._visible),t.NativePrimitve.setMap(this.NativePrimitve))},t.prototype.AddEntities=function(t){var e,n=this;null!=t&&Array.isArray(t)&&0!==t.length&&((e=this._entities).push.apply(e,m(t)),o.eachSeries(m(t),(function(t,e){t.NativePrimitve.setVisible(n._visible),t.NativePrimitve.setMap(n.NativePrimitve),o.nextTick((function(){return e()}))})))},t.prototype.Delete=function(){o.eachSeries(this._entities.splice(0),(function(t,e){t.NativePrimitve.setMap(null),o.nextTick((function(){return e()}))}))},t.prototype.GetOptions=function(){return{id:this._id}},t.prototype.GetVisible=function(){return this._visible},t.prototype.RemoveEntity=function(t){if(t.NativePrimitve){var e=this._entities.indexOf(t);e>-1&&this._entities.splice(e,1),t.NativePrimitve.setMap(null)}},t.prototype.SetEntities=function(t){this.Delete(),this.AddEntities(t)},t.prototype.SetOptions=function(t){this._id=t.id},t.prototype.SetVisible=function(t){o.eachSeries(m(this._entities),(function(e,n){e.NativePrimitve.setVisible(t),o.nextTick((function(){return n()}))})),this._visible=t},t}(),Qt=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i._layers=new Map,i}return f(e,t),e.prototype.AddLayer=function(t){var e=this,n=new Promise((function(n,i){e._mapService.MapPromise.then((function(i){var o=new Jt(i,e._mapService,t.Id);o.SetVisible(t.Visible),n(o)}))}));this._layers.set(t.Id,n)},e.prototype.CreatePolygon=function(t,e){var n=this._mapService.CreatePolygon(e),i=this._layers.get(t);return Promise.all([n,i]).then((function(t){return t[1].AddEntity(t[0])})),n},e.prototype.CreatePolygons=function(t,e){var n=this.GetLayerById(t);if(null==n)throw new Error("Layer with id "+t+" not found in Layer Map");return n.then((function(t){return new Promise((function(t,n){t(e.map((function(t){var e=V.TranslatePolygonOptions(t),n=new google.maps.Polygon(e),i=new W(n);return t.title&&""!==t.title&&(i.Title=t.title),t.metadata&&t.metadata.forEach((function(t,e){return i.Metadata.set(e,t)})),i})))}))}))},e.prototype.CreatePolyline=function(t,e){var n=this._mapService.CreatePolyline(e),i=this._layers.get(t);return Promise.all([n,i]).then((function(t){var e,n,i=Array.isArray(t[0])?t[0]:[t[0]];try{for(var o=d(i),r=o.next();!r.done;r=o.next()){var a=r.value;t[1].AddEntity(a)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}})),n},e.prototype.CreatePolylines=function(t,e){var n=this.GetLayerById(t);if(null==n)throw new Error("Layer with id "+t+" not found in Layer Map");return n.then((function(t){return new Promise((function(t,n){t(e.map((function(t){var e=V.TranslatePolylineOptions(t);if(t.path&&t.path.length>0&&!Array.isArray(t.path[0])){e.path=V.TranslatePaths(t.path)[0];var n=new google.maps.Polyline(e),i=new U(n);return t.title&&""!==t.title&&(i.Title=t.title),t.metadata&&t.metadata.forEach((function(t,e){return i.Metadata.set(e,t)})),i}var o=V.TranslatePaths(t.path),r=new Array;return o.forEach((function(n){e.path=n;var i=new google.maps.Polyline(e),o=new U(i);t.metadata&&t.metadata.forEach((function(t,e){return o.Metadata.set(e,t)})),t.title&&""!==t.title&&(o.Title=t.title),r.push(o)})),r})))}))}))},e}(qt);Qt.decorators=[{type:e.Injectable}],Qt.ctorParameters=function(){return[{type:X},{type:e.NgZone}]},function(t){t[t.HTTP=0]="HTTP",t[t.HTTPS=1]="HTTPS",t[t.AUTO=2]="AUTO"}(Xt||(Xt={}));var $t=function(){};$t.decorators=[{type:e.Injectable}];var te=new $t,ee=function(t){function e(e,n,i){var o=t.call(this)||this;return o._config=e,o._windowRef=n,o._documentRef=i,null!==o._config&&void 0!==o._config||(o._config=te),o}return f(e,t),Object.defineProperty(e.prototype,"Config",{get:function(){return this._config},enumerable:!1,configurable:!0}),e.prototype.Load=function(){var t=this;if(this._scriptLoadingPromise)return this._scriptLoadingPromise;var e=this._documentRef.GetNativeDocument().createElement("script");e.type="text/javascript",e.async=!0,e.defer=!0;var n="Create";return e.src=this.GetMapsScriptSrc(n),this._scriptLoadingPromise=new Promise((function(n,i){t._windowRef.GetNativeWindow().Create=function(){if(t._config.enableClustering){var e=t._documentRef.GetNativeDocument().createElement("script");e.type="text/javascript",e.src=t.GetClusterScriptSrc(),e.onload=e.onreadystatechange=function(){n()},t._documentRef.GetNativeDocument().head.appendChild(e)}else n()},e.onerror=function(t){i(t)}})),this._documentRef.GetNativeDocument().head.appendChild(e),this._scriptLoadingPromise},e.prototype.GetMapsScriptSrc=function(t){var e=this._config.hostAndPath||"maps.googleapis.com/maps/api/js",n={v:this._config.apiVersion,callback:t,key:this._config.apiKey,client:this._config.clientId,channel:this._config.channel,libraries:this._config.libraries,region:this._config.region,language:this._config.language};return this.GetScriptSrc(e,n)},e.prototype.GetClusterScriptSrc=function(){var t=this._config.clusterHostAndPath||"developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js";return this.GetScriptSrc(t,{})},e.prototype.GetScriptSrc=function(t,e){var n;switch(this._config&&this._config.protocol||Xt.HTTPS){case Xt.AUTO:n="";break;case Xt.HTTP:n="http:";break;case Xt.HTTPS:n="https:"}return n+"//"+t+"?"+Object.keys(e).filter((function(t){return null!=e[t]})).filter((function(t){return!Array.isArray(e[t])||Array.isArray(e[t])&&e[t].length>0})).map((function(t){var n=e[t];return Array.isArray(n)?{key:t,value:n.join(",")}:{key:t,value:e[t]}})).map((function(t){return t.key+"="+t.value})).join("&")},e}(It);ee.decorators=[{type:e.Injectable}],ee.ctorParameters=function(){return[{type:$t,decorators:[{type:e.Optional}]},{type:xt},{type:Et}]};var ne=function(){function t(t,e,n,i){this._mapService=t,this._layerService=e,this._clusterService=n,this._zone=i,this._markers=new Map}return t.prototype.AddMarker=function(t){var e={anchor:t.Anchor,position:{latitude:t.Latitude,longitude:t.Longitude},title:t.Title,label:t.Label,draggable:t.Draggable,icon:t.IconUrl,iconInfo:t.IconInfo,width:t.Width,height:t.Height,isFirst:t.IsFirstInSet,isLast:t.IsLastInSet},n=null;n=t.InClusterLayer?this._clusterService.CreateMarker(t.LayerId,e):t.InCustomLayer?this._layerService.CreateMarker(t.LayerId,e):this._mapService.CreateMarker(e),this._markers.set(t,n),t.IconInfo&&n.then((function(n){t.DynamicMarkerCreated.emit(e.iconInfo);var i={x:e.iconInfo.size&&e.iconInfo.markerOffsetRatio?e.iconInfo.size.width*e.iconInfo.markerOffsetRatio.x:0,y:e.iconInfo.size&&e.iconInfo.markerOffsetRatio?e.iconInfo.size.height*e.iconInfo.markerOffsetRatio.y:0};n.SetAnchor(i)}))},t.prototype.CreateEventObservable=function(t,e){var n=this;return r.Observable.create((function(i){n._markers.get(e).then((function(e){e.AddListener(t,(function(t){return n._zone.run((function(){return i.next(t)}))}))}))}))},t.prototype.DeleteMarker=function(t){var e=this,n=this._markers.get(t);return null==n?Promise.resolve():n.then((function(n){return t.InClusterLayer&&e._clusterService.GetNativeLayer(t.LayerId).then((function(t){t.RemoveEntity(n)})),t.InCustomLayer&&e._layerService.GetNativeLayer(t.LayerId).then((function(t){t.RemoveEntity(n)})),e._zone.run((function(){n.DeleteMarker(),e._markers.delete(t)}))}))},t.prototype.GetCoordinatesFromClick=function(t){return t&&t.latLng&&t.latLng.lat&&t.latLng.lng?{latitude:t.latLng.lat(),longitude:t.latLng.lng()}:null},t.prototype.GetNativeMarker=function(t){return this._markers.get(t)},t.prototype.GetPixelsFromClick=function(t){if(!(t&&t.latLng&&t.latLng.lat&&t.latLng.lng))return null;if(null==this._mapService.MapInstance)return null;var e=!1,n=this._mapService.MapInstance,i=n.getProjection(),o=Math.pow(2,n.getZoom()),r=n.getBounds();(r.getCenter().lng()<r.getSouthWest().lng()||r.getCenter().lng()>r.getNorthEast().lng())&&(e=!0);var a=i.fromLatLngToPoint(r.getNorthEast()).y,s=i.fromLatLngToPoint(r.getSouthWest()).x,l=i.fromLatLngToPoint(t.latLng);return{x:Math.floor((l.x-s+(e&&l.x<s?256:0))*o),y:Math.floor((l.y-a)*o)}},t.prototype.LocationToPoint=function(t){var e=this;return null==t?Promise.resolve(null):t instanceof st?this._markers.get(t).then((function(t){var n=t.Location;return e._mapService.LocationToPoint(n)})):this._mapService.LocationToPoint(t)},t.prototype.UpdateAnchor=function(t){return this._markers.get(t).then((function(e){e.SetAnchor(t.Anchor)}))},t.prototype.UpdateDraggable=function(t){return this._markers.get(t).then((function(e){return e.SetDraggable(t.Draggable)}))},t.prototype.UpdateIcon=function(t){return this._markers.get(t).then((function(e){if(t.IconInfo){var n={position:{latitude:t.Latitude,longitude:t.Longitude},iconInfo:t.IconInfo},i=V.TranslateMarkerOptions(n);e.SetIcon(i.icon),t.DynamicMarkerCreated.emit(n.iconInfo)}else e.SetIcon(t.IconUrl)}))},t.prototype.UpdateLabel=function(t){return this._markers.get(t).then((function(e){e.SetLabel(t.Label)}))},t.prototype.UpdateMarkerPosition=function(t){return this._markers.get(t).then((function(e){return e.SetPosition({latitude:t.Latitude,longitude:t.Longitude})}))},t.prototype.UpdateTitle=function(t){return this._markers.get(t).then((function(e){return e.SetTitle(t.Title)}))},t.prototype.UpdateVisible=function(t){return this._markers.get(t).then((function(e){return e.SetVisible(t.Visible)}))},t}();ne.decorators=[{type:e.Injectable}],ne.ctorParameters=function(){return[{type:X},{type:$},{type:nt},{type:e.NgZone}]};var ie=function(){function e(t){this._layer=t,this._isClustering=!0,this._markerLookup=new Map,this._markers=new Array,this._pendingMarkers=new Array,this._mapclicks=0,this._currentZoom=0,this._visible=!0}return Object.defineProperty(e.prototype,"NativePrimitve",{get:function(){return this._layer},enumerable:!1,configurable:!0}),e.prototype.AddListener=function(t,e){throw new Error("Events are not supported on Google Cluster Layers. You can still add events to individual markers.")},e.prototype.AddEntity=function(t){var e=t instanceof l;(e=t instanceof H||e)&&(t.NativePrimitve.setMap(null),t.IsFirst&&this.StopClustering()),t.NativePrimitve&&t.Location&&(this._isClustering&&this._visible?(this._layer.addMarker(t.NativePrimitve),this._markers.push(t)):this._pendingMarkers.push(t),this._markerLookup.set(t.NativePrimitve,t)),e&&t.IsLast&&this.StartClustering()},e.prototype.AddEntities=function(t){var e,n,i=this;if(null!=t&&Array.isArray(t)&&0!==t.length){var o=t.map((function(t){return i._markerLookup.set(t.NativePrimitve,t),t.NativePrimitve.setMap(null),t.NativePrimitve}));this._isClustering&&this._visible?(this._layer.addMarkers(o),(e=this._markers).push.apply(e,m(t))):(n=this._pendingMarkers).push.apply(n,m(t))}},e.prototype.Delete=function(){this._layer.getMarkers().forEach((function(t){t.setMap(null)})),this._layer.clearMarkers(),this._markers.splice(0),this._pendingMarkers.splice(0)},e.prototype.GetMarkerFromGoogleMarker=function(t){return this._markerLookup.get(t)},e.prototype.GetOptions=function(){return{id:0,gridSize:this._layer.getGridSize(),clusteringEnabled:0===this._layer.getGridSize(),maxZoom:this._layer.getMaxZoom(),minimumClusterSize:this._layer.getMinClusterSize(),placementMode:this._layer.isAverageCenter()?t.ClusterPlacementMode.MeanValue:t.ClusterPlacementMode.FirstPin,visible:this._visible,zoomOnClick:this._layer.isZoomOnClick(),styles:this._layer.getStyles()}},e.prototype.GetVisible=function(){return this._visible},e.prototype.RemoveEntity=function(t){if(t.NativePrimitve&&t.Location){var e=this._markers.indexOf(t),n=this._pendingMarkers.indexOf(t);e>-1&&this._markers.splice(e,1),n>-1&&this._pendingMarkers.splice(n,1),this._isClustering&&this._layer.removeMarker(t.NativePrimitve),this._markerLookup.delete(t.NativePrimitve)}},e.prototype.SetEntities=function(t){var e=this;this._layer.getMarkers().forEach((function(t){t.setMap(null)})),this._layer.clearMarkers(),this._markers.splice(0),this._pendingMarkers.splice(0),this._markerLookup.clear();var n=new Array;t.forEach((function(t){t.NativePrimitve&&t.Location&&(t.NativePrimitve.setMap(null),e._markerLookup.set(t.NativePrimitve,t),e._visible?(e._markers.push(t),n.push(t.NativePrimitve)):e._pendingMarkers.push(t))})),this._layer.addMarkers(n)},e.prototype.SetOptions=function(t){if(null!=t.placementMode)throw new Error("GoogleMarkerClusterer: PlacementMode option cannot be set after initial creation.");if(null!=t.zoomOnClick)throw new Error("GoogleMarkerClusterer: ZoomOnClick option cannot be set after initial creation.");t.callback,null!=t.clusteringEnabled&&(this._layer.setMinClusterSize(t.clusteringEnabled?1:1e7),this._layer.resetViewport(),this._layer.redraw()),null==t.gridSize||null!=t.clusteringEnabled&&!t.clusteringEnabled||(this._layer.setGridSize(t.gridSize),this._layer.resetViewport(),this._layer.redraw()),null!=t.maxZoom&&this._layer.setMaxZoom(t.maxZoom),null!=t.minimumClusterSize&&this._layer.setMinClusterSize(t.minimumClusterSize),null!=t.styles&&this._layer.setStyles(t.styles),null!=t.visible&&this.SetVisible(t.visible)},e.prototype.SetVisible=function(t){t&&this._layer.getMap();if(t){var e=new Array;this._pendingMarkers.length>0?(this._pendingMarkers.forEach((function(t){t.NativePrimitve&&t.Location&&e.push(t.NativePrimitve)})),this._layer.addMarkers(e),this._markers=this._markers.concat(this._pendingMarkers.splice(0))):this._layer.redraw()}else this._layer.resetViewport(!0);this._visible=t},e.prototype.StartClustering=function(){var t=this;if(!this._isClustering){if(this._visible){var e=new Array;this._markers.forEach((function(t){t.NativePrimitve&&t.Location&&e.push(t.NativePrimitve)})),this._pendingMarkers.forEach((function(t){t.NativePrimitve&&t.Location&&e.push(t.NativePrimitve)})),this._layer.addMarkers(e),this._markers=this._markers.concat(this._pendingMarkers.splice(0))}this._visible||r.timer(0).subscribe((function(){t._layer.resetViewport(!0)})),this._isClustering=!0}},e.prototype.StopClustering=function(){this._isClustering&&(this._isClustering=!1)},e}(),oe=function(){function e(t,e){var n=this;this._loader=t,this._zone=e,this._map=new Promise((function(t){n._mapResolver=t})),this._config=this._loader.Config}return Object.defineProperty(e.prototype,"MapInstance",{get:function(){return this._mapInstance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"MapPromise",{get:function(){return this._map},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"MapSize",{get:function(){if(this.MapInstance){var t=this.MapInstance.getDiv();return{width:t.offsetWidth,height:t.offsetHeight}}return null},enumerable:!1,configurable:!0}),e.prototype.CreateCanvasOverlay=function(t){return this._map.then((function(e){var n=new Y(t);return n.SetMap(e),n}))},e.prototype.CreateClusterLayer=function(t){return this._map.then((function(e){var n=!1,i=new MarkerClusterer(e,[],t),o=new ie(i),r={id:t.id};return t.visible||(r.visible=!1,n=!0),t.clusteringEnabled||(r.clusteringEnabled=!1,n=!0),n&&o.SetOptions(r),o}))},e.prototype.CreateInfoWindow=function(t){var e=this;return this._map.then((function(n){var i=V.TranslateInfoWindowOptions(t),o=new google.maps.InfoWindow(i);return new B(o,e)}))},e.prototype.CreateLayer=function(t){var e=this;return this._map.then((function(n){return new Jt(n,e,t.id)}))},e.prototype.CreateMap=function(e,n){var i=this;return this._loader.Load().then((function(){new I(F).Extend(new google.maps.OverlayView).Map("changed","Changed").Map("onAdd","OnAdd").Map("draw","Draw").Map("onRemove","OnRemove"),new I(Y).Extend(new google.maps.OverlayView).Map("onAdd","OnAdd").Map("draw","OnDraw").Map("onRemove","OnRemove"),null==!n.mapTypeId&&(n.mapTypeId=t.MapTypeId.hybrid),null!=i._mapInstance&&i.DisposeMap();var o=V.TranslateOptions(n),r=new google.maps.Map(e,o);n.bounds&&r.fitBounds(V.TranslateBounds(n.bounds)),i._mapInstance=r,i._mapResolver(r)}))},e.prototype.CreateMarker=function(t){void 0===t&&(t={});var e=function(e,n){var i=new google.maps.Marker(e),o=new H(i);return o.IsFirst=t.isFirst,o.IsLast=t.isLast,t.metadata&&t.metadata.forEach((function(t,e){return o.Metadata.set(e,t)})),i.setMap(n),o};return this._map.then((function(n){var i=V.TranslateMarkerOptions(t);if(t.iconInfo&&t.iconInfo.markerType){var o=l.CreateMarker(t.iconInfo);return"string"==typeof o?(i.icon=o,e(i,n)):o.then((function(t){return i.icon=t.icon,e(i,n)}))}return e(i,n)}))},e.prototype.CreatePolygon=function(t){return this._map.then((function(e){var n=V.TranslatePolygonOptions(t),i=new google.maps.Polygon(n);i.setMap(e);var o=new W(i);return t.metadata&&t.metadata.forEach((function(t,e){return o.Metadata.set(e,t)})),t.title&&""!==t.title&&(o.Title=t.title),null!=t.showLabel&&(o.ShowLabel=t.showLabel),null!=t.showTooltip&&(o.ShowTooltip=t.showTooltip),null!=t.labelMaxZoom&&(o.LabelMaxZoom=t.labelMaxZoom),null!=t.labelMinZoom&&(o.LabelMinZoom=t.labelMinZoom),o}))},e.prototype.CreatePolyline=function(t){var e;return this._map.then((function(n){var i=V.TranslatePolylineOptions(t);if(t.path&&t.path.length>0&&!Array.isArray(t.path[0])){i.path=V.TranslatePaths(t.path)[0],(e=new google.maps.Polyline(i)).setMap(n);var o=new U(e);return t.metadata&&t.metadata.forEach((function(t,e){return o.Metadata.set(e,t)})),t.title&&""!==t.title&&(o.Title=t.title),null!=t.showTooltip&&(o.ShowTooltip=t.showTooltip),o}var r=V.TranslatePaths(t.path),a=new Array;return r.forEach((function(o){i.path=o,(e=new google.maps.Polyline(i)).setMap(n);var r=new U(e);t.metadata&&t.metadata.forEach((function(t,e){return r.Metadata.set(e,t)})),t.title&&""!==t.title&&(r.Title=t.title),null!=t.showTooltip&&(r.ShowTooltip=t.showTooltip),a.push(r)})),a}))},e.prototype.DeleteLayer=function(t){return Promise.resolve()},e.prototype.DisposeMap=function(){var t=this;null==this._map&&null==this._mapInstance||null!=this._mapInstance&&(this._mapInstance=null,this._map=new Promise((function(e){t._mapResolver=e})))},e.prototype.GetCenter=function(){return this._map.then((function(t){var e=t.getCenter();return{latitude:e.lat(),longitude:e.lng()}}))},e.prototype.GetBounds=function(){return this._map.then((function(t){var e=t.getBounds();return{maxLatitude:e.getNorthEast().lat(),maxLongitude:Math.max(e.getNorthEast().lng(),e.getSouthWest().lng()),minLatitude:e.getSouthWest().lat(),minLongitude:Math.min(e.getNorthEast().lng(),e.getSouthWest().lng()),center:{latitude:e.getCenter().lat(),longitude:e.getCenter().lng()},padding:0}}))},e.prototype.GetZoom=function(){return this._map.then((function(t){return t.getZoom()}))},e.prototype.LocationToPoint=function(t){return this._map.then((function(e){var n=!1,i=V.TranslateLocationObject(t),o=e.getProjection(),r=Math.pow(2,e.getZoom()),a=e.getBounds();(a.getCenter().lng()<a.getSouthWest().lng()||a.getCenter().lng()>a.getNorthEast().lng())&&(n=!0);var s=o.fromLatLngToPoint(a.getNorthEast()).y,l=o.fromLatLngToPoint(a.getSouthWest()).x,u=o.fromLatLngToPoint(i);return{x:Math.floor((u.x-l+(n&&u.x<l?256:0))*r),y:Math.floor((u.y-s)*r)}}))},e.prototype.LocationsToPoints=function(t){return this._map.then((function(e){var n=!1,i=e.getProjection(),o=Math.pow(2,e.getZoom()),r=e.getBounds();(r.getCenter().lng()<r.getSouthWest().lng()||r.getCenter().lng()>r.getNorthEast().lng())&&(n=!0);var a=i.fromLatLngToPoint(r.getSouthWest()).x,s=i.fromLatLngToPoint(r.getNorthEast()).y;return t.map((function(t){var e=V.TranslateLocationObject(t),r=i.fromLatLngToPoint(e);return{x:Math.floor((r.x-a+(n&&r.x<a?256:0))*o),y:Math.floor((r.y-s)*o)}}))}))},e.prototype.SetCenter=function(t){return this._map.then((function(e){var n=V.TranslateLocationObject(t);e.setCenter(n)}))},e.prototype.SetMapOptions=function(t){this._map.then((function(e){var n=V.TranslateOptions(t);e.setOptions(n)}))},e.prototype.SetViewOptions=function(t){this._map.then((function(e){t.bounds&&e.fitBounds(V.TranslateBounds(t.bounds));var n=V.TranslateOptions(t);e.setOptions(n)}))},e.prototype.SetZoom=function(t){return this._map.then((function(e){return e.setZoom(t)}))},e.prototype.SubscribeToMapEvent=function(t){var e=this,n=q[t];return r.Observable.create((function(t){e._map.then((function(i){i.addListener(n,(function(n){e._zone.run((function(){return t.next(n)}))}))}))}))},e.prototype.TriggerMapEvent=function(t){return this._map.then((function(e){return google.maps.event.trigger(e,t,null)}))},e}();oe.decorators=[{type:e.Injectable}],oe.ctorParameters=function(){return[{type:It},{type:e.NgZone}]};var re=function(){function t(t,e,n){this._mapService=t,this._layerService=e,this._zone=n,this._polygons=new Map}return t.prototype.AddPolygon=function(t){var e={id:t.Id,clickable:t.Clickable,draggable:t.Draggable,editable:t.Editable,fillColor:t.FillColor,fillOpacity:t.FillOpacity,geodesic:t.Geodesic,labelMaxZoom:t.LabelMaxZoom,labelMinZoom:t.LabelMinZoom,paths:t.Paths,showLabel:t.ShowLabel,showTooltip:t.ShowTooltip,strokeColor:t.StrokeColor,strokeOpacity:t.StrokeOpacity,strokeWeight:t.StrokeWeight,title:t.Title,visible:t.Visible,zIndex:t.zIndex},n=this._mapService.CreatePolygon(e);this._polygons.set(t,n)},t.prototype.CreateEventObservable=function(t,e){var n=this;return r.Observable.create((function(i){n._polygons.get(e).then((function(e){e.AddListener(t,(function(t){return n._zone.run((function(){return i.next(t)}))}))}))}))},t.prototype.DeletePolygon=function(t){var e=this,n=this._polygons.get(t);return null==n?Promise.resolve():n.then((function(n){return e._zone.run((function(){n.Delete(),e._polygons.delete(t)}))}))},t.prototype.GetCoordinatesFromClick=function(t){return{latitude:t.latLng.lat(),longitude:t.latLng.lng()}},t.prototype.GetNativePolygon=function(t){return this._polygons.get(t)},t.prototype.SetOptions=function(t,e){return this._polygons.get(t).then((function(t){t.SetOptions(e)}))},t.prototype.UpdatePolygon=function(t){var e=this._polygons.get(t);return null!=e&&null!=t.Paths&&Array.isArray(t.Paths)&&0!==t.Paths.length?e.then((function(e){Array.isArray(t.Paths[0])?e.SetPaths(t.Paths):e.SetPath(t.Paths)})):Promise.resolve()},t}();re.decorators=[{type:e.Injectable}],re.ctorParameters=function(){return[{type:X},{type:$},{type:e.NgZone}]};var ae=function(){function t(t,e,n){this._mapService=t,this._layerService=e,this._zone=n,this._polylines=new Map}return t.prototype.AddPolyline=function(t){var e={id:t.Id,clickable:t.Clickable,draggable:t.Draggable,editable:t.Editable,geodesic:t.Geodesic,path:t.Path,showTooltip:t.ShowTooltip,strokeColor:t.StrokeColor,strokeOpacity:t.StrokeOpacity,strokeWeight:t.StrokeWeight,title:t.Title,visible:t.Visible,zIndex:t.zIndex},n=this._mapService.CreatePolyline(e);this._polylines.set(t,n)},t.prototype.CreateEventObservable=function(t,e){var n=this;return r.Observable.create((function(i){n._polylines.get(e).then((function(e){(Array.isArray(e)?e:[e]).forEach((function(e){return e.AddListener(t,(function(t){return n._zone.run((function(){return i.next(t)}))}))}))}))}))},t.prototype.DeletePolyline=function(t){var e=this,n=this._polylines.get(t);return null==n?Promise.resolve():n.then((function(n){return e._zone.run((function(){(Array.isArray(n)?n:[n]).forEach((function(t){return t.Delete()})),e._polylines.delete(t)}))}))},t.prototype.GetCoordinatesFromClick=function(t){return t&&t.latLng&&t.latLng.lat&&t.latLng.lng?{latitude:t.latLng.lat(),longitude:t.latLng.lng()}:null},t.prototype.GetNativePolyline=function(t){return this._polylines.get(t)},t.prototype.SetOptions=function(t,e){return this._polylines.get(t).then((function(t){(Array.isArray(t)?t:[t]).forEach((function(t){return t.SetOptions(e)}))}))},t.prototype.UpdatePolyline=function(t){var e=this,n=this._polylines.get(t);return null==n?Promise.resolve():n.then((function(n){return e._zone.run((function(){var e=Array.isArray(n)?n:[n],i=t.Path.length>0&&Array.isArray(t.Path[0])?t.Path:[t.Path];e.forEach((function(t,e){i.length>e&&t.SetPath(i[e])})),Array.isArray(n)&&n.length>i.length&&n.splice(i.length-1).forEach((function(t){return t.Delete()}))}))}))},t}();ae.decorators=[{type:e.Injectable}],ae.ctorParameters=function(){return[{type:X},{type:$},{type:e.NgZone}]};var se=function(){function t(t,e){var n=this;this._loader=t,this._zone=e,this._map=new Promise((function(t){n._mapResolver=t}))}return t.prototype.Create=function(){return new oe(this._loader,this._zone)},t.prototype.CreateClusterService=function(t){return new Yt(t,this._zone)},t.prototype.CreateInfoBoxService=function(t,e){return new Kt(t,e,this._zone)},t.prototype.CreateLayerService=function(t){return new Qt(t,this._zone)},t.prototype.CreateMarkerService=function(t,e,n){return new ne(t,e,n,this._zone)},t.prototype.CreatePolygonService=function(t,e){return new re(t,e,this._zone)},t.prototype.CreatePolylineService=function(t,e){return new ae(t,e,this._zone)},t}();function le(t,e){return new se(t,e)}function ue(){return new ee(new $t,new xt,new Et)}se.decorators=[{type:e.Injectable}],se.ctorParameters=function(){return[{type:It},{type:e.NgZone}]};var ce=function(){function t(){}return t.forRoot=function(n,i){return{ngModule:t,providers:[n?{provide:K,useValue:n}:{provide:K,deps:[It,e.NgZone],useFactory:Wt},i?{provide:It,useValue:i}:{provide:It,useFactory:Ut},Et,xt]}},t.forRootBing=function(){return{ngModule:t,providers:[{provide:K,deps:[It,e.NgZone],useFactory:Wt},{provide:It,useFactory:Ut},Et,xt]}},t.forRootGoogle=function(){return{ngModule:t,providers:[{provide:K,deps:[It,e.NgZone],useFactory:le},{provide:It,useFactory:ue},Et,xt]}},t}();ce.decorators=[{type:e.NgModule,args:[{declarations:[gt,lt,st,rt,it,bt,Ct,vt,St,Pt,Lt],imports:[n.CommonModule],exports:[n.CommonModule,lt,st,bt,Ct,rt,it,gt,vt,St,Pt,Lt]}]}],t.BingCanvasOverlay=Z,t.BingClusterLayer=P,t.BingClusterService=Vt,t.BingInfoBoxService=Gt,t.BingInfoWindow=w,t.BingLayer=C,t.BingLayerService=Zt,t.BingMapAPILoader=Dt,t.BingMapAPILoaderConfig=At,t.BingMapEventsLookup=j,t.BingMapService=Rt,t.BingMapServiceFactory=Ft,t.BingMarker=S,t.BingMarkerService=Nt,t.BingPolygon=N,t.BingPolygonService=Bt,t.BingPolyline=R,t.BingPolylineService=Ht,t.BingSpiderClusterMarker=O,t.CanvasOverlay=M,t.ClusterLayerDirective=vt,t.ClusterService=nt,t.DocumentRef=Et,t.GoogleCanvasOverlay=Y,t.GoogleClusterService=Yt,t.GoogleInfoBoxService=Kt,t.GoogleInfoWindow=B,t.GoogleLayerService=Qt,t.GoogleMapAPILoader=ee,t.GoogleMapAPILoaderConfig=$t,t.GoogleMapEventsLookup=q,t.GoogleMapService=oe,t.GoogleMapServiceFactory=se,t.GoogleMarker=H,t.GoogleMarkerService=ne,t.GooglePolygon=W,t.GooglePolygonService=re,t.GooglePolyline=U,t.GooglePolylineService=ae,t.InfoBoxActionDirective=it,t.InfoBoxComponent=rt,t.InfoBoxService=Q,t.InfoWindow=s,t.Layer=u,t.LayerService=$,t.MapAPILoader=It,t.MapComponent=lt,t.MapLayerDirective=gt,t.MapMarkerDirective=st,t.MapMarkerLayerDirective=St,t.MapModule=ce,t.MapPolygonDirective=bt,t.MapPolygonLayerDirective=Pt,t.MapPolylineDirective=Ct,t.MapPolylineLayerDirective=Lt,t.MapService=X,t.MapServiceFactory=K,t.Marker=l,t.MarkerService=J,t.Polygon=c,t.PolygonService=tt,t.Polyline=p,t.PolylineService=et,t.SpiderClusterMarker=_,t.WindowRef=xt,t.ɵa=ut,t.ɵb=ct,t.ɵc=pt,t.ɵd=ht,t.ɵe=ft,t.ɵf=dt,t.ɵg=yt,t.ɵh=Wt,t.ɵi=Ut,t.ɵj=le,t.ɵk=ue,t.ɵl=jt,t.ɵm=qt,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-maps-v9.umd.min.js.map